{"name":"Storycatcher II","description":"A JavaScript project, designed for managing, capturing, or present stories. ","projectType":"github","additionalDetails":{"contextSummaryUpdatedAt":"2025-07-09T06:21:46.175Z","githubUrl":"https://github.com/finnern/storycatcher-II","contextSummary":"Here's the summarized project context, preserving all design-related information as requested:\n\n## Pages Specification\n## Page Navigation Flow\n\nThe Storycatcher II application guides users through a clear set of pages, facilitating secure access, interactive story capture, and efficient management of personal narratives. The navigation flow emphasizes a user-centric design, allowing seamless transitions between core functionalities while maintaining privacy and data integrity.\n\n```mermaid\ngraph TD\n    subgraph \"Public / Unauthenticated Access\"\n        LP[\"Landing Page\"] --> LGP(\"Login Page\");\n        LP --> RP(\"Registration Page\");\n        LP --> PAP(\"Public Archive Page\");\n    end\n\n    subgraph \"Authenticated User Flow\"\n        LGP --> MSP(\"My Stories Page\");\n        RP --> MSP;\n        MSP --> SCP(\"Story Capture Page\");\n        MSP --> SDSP(\"Story Detail / Edit Page\");\n        MSP --> LGP;\n        SCP --> MSP;\n        SDSP --> MSP;\n        SDSP --> ESOP(\"Export / Share Options\");\n        ESOP --> SDSP;\n        ESOP --> MSP;\n    end\n\n    subgraph \"Public Story Viewing\"\n        PAP --> PSVP(\"Public Story View Page\");\n        PSVP --> PAP;\n    end\n\n    style LP fill:#f0f8ff,stroke:#3178c6,stroke-width:2px\n    style LGP fill:#e0f7fa,stroke:#00796b,stroke-width:2px\n    style RP fill:#e0f7fa,stroke:#00796b,stroke-width:2px\n    style MSP fill:#c8e6c9,stroke:#388e3c,stroke-width:2px\n    style SCP fill:#fff3e0,stroke:#e65100,stroke-width:2px\n    style SDSP fill:#fffde7,stroke:#fbc02d,stroke-width:2px\n    style ESOP fill:#ffe0b2,stroke:#fb8c00,stroke-width:2px\n    style PAP fill:#e3f2fd,stroke:#1e88e5,stroke-width:2px\n    style PSVP fill:#e3f2fd,stroke:#1e88e5,stroke-width:2px\n```\n\n**Overview of Page Hierarchy and User Flow:**\nThe application's navigation is structured around two primary states: unauthenticated and authenticated. The `Landing Page` is the initial entry, directing users to `Login`, `Registration`, or the `Public Archive`. Authenticated users access the `My Stories Page` dashboard, from which they can initiate `Story Capture`, manage stories via `Story Detail / Edit Page`, or `Logout`. The `Story Capture Page` is for interactive audio recording. The `Story Detail / Edit Page` allows metadata management and initiates `Export / Share Options`, including GDPR consent. Publicly shared stories are accessible via the `Public Archive Page` and individual `Public Story View Pages` for all users.\n\n## Page Specifications\n\n### Landing Page\n*   **Purpose**: Initial entry point, overview, directs to registration, login, or public archive.\n*   **Key Content**: Branding, brief description, calls to action for registration, login, public stories.\n*   **Navigation**: To `Registration Page`, `Login Page`, `Public Archive Page`.\n\n### Registration Page\n*   **Purpose**: Allows new users to create an account (Requirement 2285).\n*   **Key Content**: Form fields (username, email, password, confirmation), privacy policy link, terms of service checkbox.\n*   **Navigation**: From `Landing Page`; To `My Stories Page` (on success), `Login Page`. Displays error feedback (Requirement 2298).\n\n### Login Page\n*   **Purpose**: Enables existing users to securely log in (Requirement 2285).\n*   **Key Content**: Form fields (username/email, password), \"Forgot Password\" link (future).\n*   **Navigation**: From `Landing Page`, `Registration Page`; To `My Stories Page` (on success), `Registration Page`. Displays error feedback (Requirement 2298).\n\n### My Stories Page\n*   **Purpose**: User's dashboard for viewing, editing, managing stories (Requirement 2292, 2289).\n*   **Key Content**: List of archived stories (titles, summaries, dates), sort/filter options. Displays confirmation for archived stories (part of 2288).\n*   **Navigation**: From `Login Page`, `Registration Page`, `Story Capture Page`, `Story Detail / Edit Page`; To `Story Capture Page`, `Story Detail / Edit Page`, `Login Page` (on logout). Supports offline-first display (Requirement 2289).\n\n### Story Capture Page\n*   **Purpose**: Interactive interface for recording audio, displaying AI-guided questions, transcription/analysis (Requirement 2288).\n*   **Key Content**: Microphone access prompt/status (Requirement 2300), recording controls (start, stop, pause), real-time/near real-time transcript (Requirement 2287), AI-generated guiding questions (Requirement 2286), segment summary. UI states for idle, recording, processing, showing analysis (Requirement 2288).\n*   **Navigation**: From `My Stories Page`; To `My Stories Page` (on finalizing story). Displays robust error handling and UI feedback (Requirement 2298).\n\n### Story Detail / Edit Page\n*   **Purpose**: View full transcript/summary, edit metadata, initiate export/sharing (Requirement 2292, 2291, 2293).\n*   **Key Content**: Full transcript, detailed summary, editable metadata fields (geo-tagging, temporal, dialect, general tags - Requirement 2291), story playback controls.\n*   **Navigation**: From `My Stories Page`; To `My Stories Page`, `Export / Share Options`.\n\n### Export / Share Options\n*   **Purpose**: Presents export formats (PDF, Podcast, Timeline) and manages explicit consent for public sharing (Requirement 2293, 2290).\n*   **Key Content**: Checkboxes/radio buttons for export formats. Clear GDPR consent form for public sharing, including opt-in confirmation (Requirement 2290).\n*   **Navigation**: From `Story Detail / Edit Page`; To `Story Detail / Edit Page`, `My Stories Page` (after confirmation).\n\n### Public Archive Page\n*   **Purpose**: Allows public users to browse stories consented for public sharing (Requirement 2295).\n*   **Key Content**: Browseable list of public stories (titles, authors, summaries, tags). Search and filter options.\n*   **Navigation**: From `Landing Page`; To `Public Story View Page`, `Login Page` / `Registration Page`.\n\n### Public Story View Page\n*   **Purpose**: Displays full content of a single publicly consented story (Requirement 2295).\n*   **Key Content**: Full transcript, summary, public metadata, author (if shared). No editing or export options.\n*   **Navigation**: From `Public Archive Page`; To `Public Archive Page`.\n\n## Design Specification (PRIMARY DESIGN SOURCE)\n## Design System Overview\n\nStorycatcher II's design philosophy centers on privacy, intuition, and accessibility. The interface will be clean, guided, and trustworthy, reflecting the application's commitment to local-first data handling and GDPR compliance (Requirements 2289, 2290). The design aims for a user-friendly and efficient experience, empowering users to easily capture and manage personal narratives (Artifact 1, 2).\n\nThe design language will be clear and unobtrusive, prioritizing content and user interaction. It will project reliability and security, essential for a platform handling sensitive personal stories. A modular, component-based architecture (leveraging React.js, Artifact 9) will ensure consistency, reusability, and maintainability across the application. Components will be organized to support efficient development and consistent user experience.\n\n## Visual Design Elements\n\nA color palette will be defined to convey trust and clarity, using a limited set of primary and accent colors. Neutral tones will dominate for readability, with strategic use of accent colors to highlight interactive elements and feedback (e.g., success, error states, Requirement 2298).\n\nA clear and readable typography system will be established, with distinct hierarchies for titles, headings, body text, and UI labels. This ensures content legibility and guides user attention. A consistent spacing system and a responsive grid will be used to ensure visual balance, readability, and adaptability across various screen sizes, supporting intuitive layout of information and components.\n\nA set of clear, intuitive icons will be designed or selected to represent actions (e.g., record, stop, save, share) and content types, enhancing usability and reducing cognitive load (e.g., for story management, Requirement 2292; export/sharing, Requirement 2293).\n\n## Component Library\n\n### UI component specifications and variations\n*   **Authentication Forms**: Input fields, buttons, and validation messages for user registration and login (Requirement 2285).\n*   **Audio Recording Controls**: Buttons for start, stop, pause, and indicators for recording status and duration (Requirements 2288, 2300).\n*   **Text Displays**: Areas for displaying real-time voice-to-text transcripts, AI-generated summaries, and guiding questions (Requirement 2288).\n*   **Story List/Grid Views**: Components for displaying archived stories with metadata (title, tags) (Requirement 2292).\n*   **Story Detail/Edit Forms**: Input fields for editing story title, description, and applying metadata tags (geo-tagging, temporal, dialect, general tags) (Requirements 2291, 2292).\n*   **Export/Share Options**: Checkboxes, dropdowns, and buttons for selecting export formats (PDF, Podcast, Timeline) and managing sharing consent (Requirements 2293, 2290).\n*   **Language Selector**: A component for switching UI languages (German/English) (Requirement 2294).\n*   **Consent Dialogs**: Explicit opt-in prompts for data handling and public sharing (Requirement 2290).\n\n### Interactive states and behaviors\nComponents will include defined states for idle, hover, active, disabled, loading, and error (Requirements 2288, 2298). Form inputs will include validation feedback.\n\n### Component usage guidelines and best practices\nGuidelines will ensure consistent application of components across the UI, promoting reusability and a unified user experience.\n\n### Accessibility and responsive design considerations\nAll components will be designed to be accessible, supporting keyboard navigation, screen readers, and multilingual content (Requirement 2294). Responsive design principles will ensure optimal display and functionality across diverse devices.\n\n## Design Patterns and Guidelines\n\n### Interaction design patterns and user flows\nUser interactions will follow established flows to provide a predictable and efficient experience. Key flows, such as the `Interactive Story Capture Flow`, will guide the user through recording, processing, and AI interaction (Requirement 2288).\n\n```mermaid\ngraph TD\n    A[\"User - Dashboard\"] --> B[\"Start New Story / Record\"];\n    B --> C{\"Microphone Access Granted?\"};\n    C -- \"No\" --> D[\"Request Microphone Permission\"];\n    D -- \"Granted\" --> E(\"Frontend - Activate MediaRecorder\");\n    D -- \"Denied\" --> F[\"Display Mic Access Error\"];\n    C -- \"Yes\" --> E;\n    E --> G[\"Frontend - Display Recording UI\"];\n\n    subgraph \"Interactive Recording Loop\"\n        G --> H[\"User - Speak into Microphone\"];\n        H --> I[\"Frontend - Capture Audio Segment\"];\n        I --> J[\"User - Stop Recording Segment\"];\n        J --> K(\"Frontend - Send Audio to Backend\");\n        K --> L(\"Backend - Local-First STT Engine\");\n        L --> M(\"Backend - AI Interview Logic\");\n        M --> N[\"Backend - Send Transcript / Analysis / Question\"];\n        N --> O[\"Frontend - Store Data Locally IndexedDB\"];\n        O --> P[\"Frontend - Display Analysis / New Question\"];\n        P --> Q{\"Continue Recording?\"};\n        Q -- \"Yes\" --> G;\n    end\n\n    Q -- \"No / Finalize\" --> R[\"Frontend - Finalize Story\"];\n    R --> S(\"Backend - Story Finalization\");\n    S --> T[\"Frontend - Story Archived Confirmation\"];\n    F --> X[\"User - End Session\"];\n    T --> X;\n```\n\n### Navigation and information architecture principles\nNavigation will be intuitive, allowing users to easily move between primary sections. A clear hierarchy will be maintained.\n\n### Form design and data input patterns\nForms for registration (Requirement 2285) and metadata tagging (Requirement 2291) will feature clear labels, input validation, and assistive text to guide users.\n\n### Error handling and feedback mechanisms\nComprehensive error handling (Requirement 2298) will provide clear, immediate feedback for issues such as microphone access denial, API call failures, or processing errors. UI states will gracefully transition, and user-friendly messages will guide recovery or suggest support.\n\n## User Flows\n## User Flows Overview\n\nThis document outlines the key user journeys within Storycatcher II, a privacy-centric application for capturing and managing personal stories. The purpose of these flows is to visualize the step-by-step interactions between the user and the system, highlighting critical paths, decision points, and system responses. Flows are categorized to provide a clear understanding of core functionalities, user onboarding, and data management processes, all strictly adhering to the requirements outlined in the project artifacts.\n\n## Primary User Journey Flows\n\n### User Registration and Login Flow (Requirement 2285)\nThis flow details the initial entry point for users, allowing new users to register securely and existing users to log in.\n\n```mermaid\ngraph TD\n    A[\"User - Landing Page\"] --> B{\"Has Account?\"};\n    B -- \"No\" --> C[\"Registration Page\"];\n    C --> D{\"Enter Details / Register\"};\n    D --> E(\"Backend - Register User\");\n    E -- \"Success\" --> F[\"Login Page\"];\n    B -- \"Yes\" --> F;\n    F --> G{\"Enter Credentials / Login\"};\n    G --> H(\"Backend - Authenticate User\");\n    H -- \"Success\" --> I[\"Dashboard / My Stories Page\"];\n    H -- \"Failure\" --> F;\n    E -- \"Failure\" --> C;\n```\n\n### Interactive Story Capture Flow (Requirements 2288, 2300, 2287, 2286)\nThis core flow describes how users record audio, receive AI-guided questions, and process story segments, integrating microphone access, local-first STT, and AI assistance.\n\n```mermaid\ngraph TD\n    A[\"User - Dashboard\"] --> B[\"Start New Story / Record\"];\n    B --> C{\"Microphone Access Granted?\"};\n    C -- \"No\" --> D[\"Request Microphone Permission\"];\n    D -- \"Granted\" --> E(\"Frontend - Activate MediaRecorder\");\n    D -- \"Denied\" --> F[\"Display Mic Access Error\"];\n    C -- \"Yes\" --> E;\n    E --> G[\"Frontend - Display Recording UI\"];\n\n    subgraph \"Interactive Recording Loop\"\n        G --> H[\"User - Speak into Microphone\"];\n        H --> I[\"Frontend - Capture Audio Segment\"];\n        I --> J[\"User - Stop Recording Segment\"];\n        J --> K(\"Frontend - Send Audio to Backend\");\n        K --> L(\"Backend - Local-First STT Engine\");\n        L --> M(\"Backend - AI Interview Logic\");\n        M --> N[\"Backend - Send Transcript / Analysis / Question\"];\n        N --> O[\"Frontend - Store Data Locally IndexedDB\"];\n        O --> P[\"Frontend - Display Analysis / New Question\"];\n        P --> Q{\"Continue Recording?\"};\n        Q -- \"Yes\" --> G;\n    end\n\n    Q -- \"No / Finalize\" --> R[\"Frontend - Finalize Story\"];\n    R --> S(\"Backend - Story Finalization\");\n    S --> T[\"Frontend - Story Archived Confirmation\"];\n    F --> X[\"User - End Session\"];\n    T --> X;\n```\n\n## Supporting and Alternative Flows\n\n### Story Management and Export Flow (Requirements 2292, 2291, 2293, 2290)\nThis flow covers users reviewing, editing, adding metadata to, and exporting their archived stories, including the explicit consent step for sharing.\n\n```mermaid\ngraph TD\n    A[\"User - My Stories Page\"] --> B[\"Select Story\"];\n    B --> C[\"Story Detail / Edit Page\"];\n    C --> D{\"Action?\"};\n    D -- \"Edit Metadata\" --> E[\"Edit Metadata Form\"];\n    E --> F(\"Backend - Update Story Metadata\");\n    D -- \"Export / Share\" --> G[\"Export / Share Options\"];\n    G --> H{\"Public Sharing Selected?\"};\n    H -- \"Yes\" --> I[\"Display GDPR Consent Form\"];\n    I --> J{\"User Grants Consent?\"};\n    J -- \"No\" --> K[\"Cancel Export / Back\"];\n    J -- \"Yes\" --> L(\"Backend - Process Export / Share\");\n    H -- \"No\" --> L;\n    L --> M[\"Frontend - Export / Share Confirmation\"];\n    F --> C;\n    K --> G;\n    M --> A;\n```\n\n### Public Story Viewing Flow (Requirement 2295)\nThis flow describes how users can browse and view stories that have been explicitly consented for public sharing.\n\n```mermaid\ngraph LR\n    A[\"User - Public Archive Page\"] --> B[\"Browse Stories\"];\n    B --> C[\"Select Public Story\"];\n    C --> D[\"Public Story View Page\"];\n    D --> E[\"User - End Session\"];\n```\n\n### Error Handling and Feedback Flow (Requirement 2298)\nThis general flow illustrates how the system provides feedback to the user when errors occur, ensuring a robust user experience.\n\n```mermaid\ngraph TD\n    A[\"User Action\"] --> B(\"System Operation\");\n    B -- \"Success\" --> C[\"UI - Display Success\"];\n    B -- \"Failure\" --> D{\"Error Type?\"};\n    D -- \"API Call Failed\" --> E[\"UI - Network Error Message\"];\n    D -- \"Permission Denied\" --> F[\"UI - Permission Required Message\"];\n    D -- \"Processing Error\" --> G[\"UI - Operation Failed Message\"];\n    E --> H[\"UI - Suggest Retry / Contact Support\"];\n    F --> H;\n    G --> H;\n    H --> I[\"User - Acknowledge / Retry\"];\n```\n\n## Flow Analysis and Optimization\n\nThe defined user flows prioritize a secure, private, and intuitive experience. The \"Interactive Story Capture Flow\" is central, leveraging local-first processing (2287) and AI guidance (2286) to minimize latency (2301) and keep sensitive data on the user's device, reinforcing GDPR compliance (2290). Error handling (2298) is integrated across flows to provide clear UI feedback, enhancing usability. Optimization opportunities include refining AI-guided interview question generation. \"Offline-First Story Archiving\" (2289) ensures continuity, with seamless synchronization upon reconnection. The \"Story Export and Sharing Flow\" explicitly incorporates GDPR consent (2290). Accessibility (2294 - Multilingual UI) is considered from the outset. Each flow directly corresponds to critical and high-priority requirements.\n\n## User Stories\n## User Stories Overview\n\nThis document outlines the user stories for Storycatcher II, adopting an Agile methodology to incrementally deliver value. User stories, structured as \"As a [user type], I want [functionality] so that [benefit],\" facilitate understanding requirements from a user perspective, guiding development, testing, and prioritization.\n\n### Epic-Level User Stories\n\nMajor features are grouped into the following epics:\n*   **User Identity & Security:** Secure user access, authentication, data privacy.\n*   **Core Story Capture:** Interactive recording, transcription, AI-guided questions.\n*   **Story Management & Archiving:** Local data persistence, organization, review.\n*   **Story Dissemination:** Exporting and sharing stories, public access.\n*   **Platform Foundation:** Technical requirements for development, performance, scalability.\n\n### Story Mapping\n\nThe following diagram illustrates the primary user journey for story capture and management, linking key stages to their supporting requirements.\n\n```mermaid\ngraph TD\n    subgraph \"User Journey: Story Capture & Management\"\n        A[\"User Access\"] --> B[\"Start Story\"];\n        B --> C[\"Record/AI Guide\"];\n        C --> D[\"Review/Refine\"];\n        D --> E[\"Archive/Share\"];\n    end\n\n    A --\"Includes\"--> \"2285 - User Auth\";\n    B --\"Includes\"--> \"2300 - Mic Access\";\n    C --\"Includes\"--> \"2288 - Interactive Capture\";\n    C --\"Includes\"--> \"2287 - Voice-to-Text\";\n    C --\"Includes\"--> \"2286 - AI-Guided Interview\";\n    D --\"Includes\"--> \"2292 - My Stories\";\n    D --\"Includes\"--> \"2291 - Metadata Tagging\";\n    E --\"Includes\"--> \"2289 - Offline Archiving\";\n    E --\"Includes\"--> \"2293 - Export/Sharing\";\n    E --\"Includes\"--> \"2295 - Public Archive\";\n\n    subgraph \"Cross-Cutting Concerns\"\n        F[\"2290 - GDPR Compliance\"]\n        G[\"2294 - Multilingual UI\"]\n        H[\"2298 - Error Handling\"]\n        I[\"2301 - Performance\"]\n    end\n\n    F --> A; F --> C; F --> E;\n    G --> A; G --> B; G --> C; G --> D; G --> E;\n    H --> C; H --> D;\n    I --> C;\n```\n\n## Detailed User Stories\n\nStories are grouped by priority, reflecting the project's MVP focus. Story Points (SP) are relative estimates (1: trivial, 2: simple, 3: moderate, 5: complex).\n\n### Critical Priority Stories\n\n*   **ID: 2285 - User Registration and Authentication**\n    *   As a new user, I want to register securely so that I can access personalized story archiving.\n    *   As an existing user, I want to log in securely so that I can continue managing my stories.\n    *   **Acceptance Criteria:** User can create/log in to account securely; Authentication protects user data.\n*   **ID: 2286 - AI-Guided Interview Assistant**\n    *   As a storyteller, I want AI-guided questions based on the 5W method so that my story capture is structured and comprehensive.\n    *   **Acceptance Criteria:** AI prompts relevant questions after audio processing; Questions align with 5W method.\n*   **ID: 2287 - Voice-to-Text Transcription (Local-First)**\n    *   As a storyteller, I want my recorded audio transcribed to text using local-first STT so that my data remains on-device and private.\n    *   **Acceptance Criteria:** Audio segments are accurately transcribed locally; Transcription adheres to GDPR.\n*   **ID: 2288 - Interactive Story Capture Loop**\n    *   As a storyteller, I want an interactive UI to record, process, display analysis, and receive new questions so that I can smoothly capture my narrative.\n    *   **Acceptance Criteria:** UI clearly shows recording, processing, and analysis states; Displays transcript/summary; Presents next question.\n*   **ID: 2289 - Offline-First Story Archiving**\n    *   As a storyteller, I want to capture and archive stories offline so that I can work without constant internet access.\n    *   **Acceptance Criteria:** Stories persist locally via IndexedDB/localStorage; Data syncs upon reconnection.\n*   **ID: 2290 - GDPR-Compliant Data Handling and Consent**\n    *   As a user, I want my data handled GDPR-compliantly with local storage and explicit consent so that my privacy is protected.\n    *   **Acceptance Criteria:** Story data stored locally by default; Explicit opt-in for any export/publication.\n*   **ID: 2300 - Microphone Access and Audio Recording**\n    *   As a storyteller, I want the system to securely access my microphone so that I can record audio segments for my stories.\n    *   **Acceptance Criteria:** Browser prompts for mic permission; Audio recorded via MediaRecorder API.\n\n### High Priority Stories\n\n*   **ID: 2291 - Story Metadata Tagging and Structuring**\n    *   As a storyteller, I want to add rich metadata (geo-tagging, temporal, dialect, general tags) to my stories so that they are discoverable and historically valuable.\n    *   **Acceptance Criteria:** User can apply various metadata types; Metadata is stored with the story.\n*   **ID: 2292 - Personal Story Management ('My Stories')**\n    *   As a storyteller, I want to view, edit, and manage my personal collection of archived stories so that I can review and refine my narratives.\n    *   **Acceptance Criteria:** Dedicated 'My Stories' page exists; User can view/edit transcripts, summaries, and metadata.\n*   **ID: 2293 - Story Export and Sharing Capabilities**\n    *   As a storyteller, I want to export and share my stories in various formats (PDF, Podcast, Timeline) so that I can disseminate them privately or publicly.\n    *   **Acceptance Criteria:** Options for PDF, Podcast, Timeline export are available; Sharing requires explicit consent.\n*   **ID: 2294 - Multilingual User Interface (i18n)**\n    *   As a user, I want to switch UI languages (German/English) and persist my preference so that I can use the application comfortably.\n    *   **Acceptance Criteria:** UI supports German and English; Language preference is saved locally.\n*   **ID: 2296 - Containerized Development Environment**\n    *   As a developer, I want a containerized (Docker) development environment so that setup is consistent and reproducible.\n    *   **Acceptance Criteria:** Docker Compose sets up frontend/backend services; Environment is consistent across machines.\n*   **ID: 2297 - Secure API Key Management**\n    *   As a developer, I want API keys managed securely via environment variables so that sensitive information is protected from version control.\n    *   **Acceptance Criteria:** API keys loaded from .env files; No hardcoded keys in source.\n\n### Medium Priority Stories\n\n*   **ID: 2295 - Public Story Archive and Viewing**\n    *   As a public user, I want to explore and view publicly shared stories so that I can engage with cultural content.\n    *   **Acceptance Criteria:** Public archive page exists; Public stories are viewable without login.\n*   **ID: 2298 - Robust Error Handling and UI Feedback**\n    *   As a user, I want clear feedback and graceful error handling during operations so that I understand system status and issues.\n    *   **Acceptance Criteria:** API call errors are handled; Microphone access errors are managed; UI state updates clearly.\n*   **ID: 2299 - Cross-Origin Resource Sharing (CORS) Configuration**\n    *   As a developer, I want the backend API configured with correct CORS headers so that frontend/backend communication works seamlessly.\n    *   **Acceptance Criteria:** CORS allows frontend access; Prevents cross-origin issues during development/production.\n*   **ID: 2301 - Performance of AI and STT Processing**\n    *   As a storyteller, I want fast AI and STT processing so that my interview experience is smooth and low-latency.\n    *   **Acceptance Criteria:** STT and AI processing latency is minimal; User experience feels responsive.\n\n### Low Priority Stories (Future Considerations)\n\n*   **ID: 2302 - Scalability for Future Cloud Deployment**\n    *   As a system architect, I want the system designed for future cloud scalability so that it can grow with user base and data.\n    *   **Acceptance Criteria:** Architecture supports cloud deployment patterns; Services are modular.\n*   **ID: 2303 - Admin and Partner Portal Functionality**\n    *   As an administrator, I want access to restricted pages for content and user management so that I can moderate the platform.\n    *   **Acceptance Criteria:** Admin portal exists; Provides user/content management.\n*   **ID: 2304 - Pricing and Subscription Management**\n    *   As a business, I want pricing and subscription management functionality so that I can monetize private archiving and corporate packages.\n    *   **Acceptance Criteria:** Pricing page exists; Subscription logic implemented.\n\n## Story Organization\n\nStories are organized by Epics and prioritized as Critical, High, Medium, and Low. Critical stories form the core MVP. High priority stories enhance the core experience. Medium and Low priority stories are planned for subsequent phases.\n\n*   **User Persona Mapping:**\n    *   **Storyteller:** Primary user, interacting with all core capture and management features.\n    *   **Public User:** Views publicly shared stories.\n    *   **Developer:** Focuses on infrastructure and technical enablers.\n    *   **Administrator/Partner:** Future roles for content and user management.\n    *   **Business:** Future role for monetization.\n\n*   **Workflow and Process Integration:** Critical stories drive the main user workflow from registration to story capture and initial management. Dependencies ensure a logical build order. Cross-cutting concerns like GDPR (2290), multilingual support (2294), and error handling (2298) are integrated throughout.\n\n## Access Control and Security Stories\n\nSecurity and access control are paramount, especially given the GDPR compliance requirement.\n\n*   **User Stories Requiring Explicit Permissions:**\n    *   **2285 - User Registration and Authentication:** Requires authentication to access personalized features.\n    *   **2290 - GDPR-Compliant Data Handling and Consent:** Explicit opt-in consent is required for any story export or publication (2293, 2295).\n    *   **2300 - Microphone Access and Audio Recording:** Requires explicit user permission via browser prompts.\n    *   **2292 - Personal Story Management ('My Stories'):** Access is restricted to the logged-in user for their own stories.\n    *   **2303 - Admin and Partner Portal Functionality:** (Future) Access will be restricted to authorized admin/partner users.\n\n*   **Actions Protected by Segregation of Duty Requirements:**\n    *   For the MVP, explicit segregation of duties is not a primary concern beyond basic user/admin roles. Future Admin/Partner portals (2303) will introduce distinct roles.\n\n*   **Actions Requiring Audit Log or Audit Trail:**\n    *   Future enhancements for Admin/Partner portals (2303) and critical data operations (e.g., story deletion, consent changes related to 2290) would benefit from audit logging.\n\n*   **Role-Based Access Control Requirements:**\n    *   **User Role:** Can register, log in, capture stories, manage their own stories, and optionally consent to public sharing.\n    *   **Public Role:** Can view publicly consented stories (2295) without authentication.\n    *   **Admin/Partner Roles (Future):** Will have elevated privileges.\n\n## Key Requirements\n### User Registration and Authentication\n**Priority:** critical\n**Description:** The system shall allow new users to register and existing users to log in securely, forming the initial entry point to the application as per the 'Landing Page', 'Login Page', and 'Registration Page' specifications. This is critical for personalized story archiving.\n\n### AI-Guided Interview Assistant\n**Priority:** critical\n**Description:** The system shall provide an AI-guided interview process based on the 5W questioning method, facilitating the capture of personal stories. This includes prompting users with relevant questions after audio segments are processed.\n\n### Voice-to-Text Transcription (Local-First)\n**Priority:** critical\n**Description:** The system shall perform voice-to-text transcription of recorded audio segments using local-first STT engines (Whisper or Vosk). This is crucial for processing interviews and maintaining GDPR compliance by keeping data on the device.\n\n### Interactive Story Capture Loop\n**Priority:** critical\n**Description:** The frontend shall implement an interactive loop allowing users to record audio segments, send them for processing, display the analysis (transcript, summary), and receive new guiding questions to continue the interview or finalize the story. UI states (idle, recording, processing, showing_analysis) must be managed.\n\n### Offline-First Story Archiving\n**Priority:** critical\n**Description:** The application shall support offline-first functionality for story archiving, utilizing IndexedDB or localStorage for local data persistence. This ensures stories can be captured and managed without constant internet connectivity.\n\n### GDPR-Compliant Data Handling and Consent\n**Priority:** critical\n**Description:** The system shall be fully GDPR-compliant, ensuring local storage of data for MVP and implementing explicit opt-in consent flows for any story export or publication. Data privacy is paramount for user trust.\n\n### Microphone Access and Audio Recording\n**Priority:** critical\n**Description:** The frontend shall securely request and manage microphone permissions from the user's browser, enabling the capture of audio for story recording using the MediaRecorder API.\n\n### Story Metadata Tagging and Structuring\n**Priority:** high\n**Description:** The system shall enable the application of rich metadata to stories, including geo-tagging, temporal structuring, dialect capture, and general tags. This enhances the discoverability and historical value of the archived stories.","version":2,"githubRepo":"finnern/storycatcher-II"},"evePackageId":667,"generatedAppLink":"/content/everest.storycatcher.ii.p1413/Dashboard","isEveProject":true,"aiSpecRequirements":[{"title":"User Registration and Authentication","description":"The system shall allow new users to register and existing users to log in securely, forming the initial entry point to the application as per the 'Landing Page', 'Login Page', and 'Registration Page' specifications. This is critical for personalized story archiving.","priority":"critical","type":"backend","researchTool":""},{"title":"AI-Guided Interview Assistant","description":"The system shall provide an AI-guided interview process based on the 5W questioning method, facilitating the capture of personal stories. This includes prompting users with relevant questions after audio segments are processed.","priority":"critical","type":"backend","researchTool":""},{"title":"Voice-to-Text Transcription (Local-First)","description":"The system shall perform voice-to-text transcription of recorded audio segments using local-first STT engines (Whisper or Vosk). This is crucial for processing interviews and maintaining GDPR compliance by keeping data on the device.","priority":"critical","type":"backend","researchTool":""},{"title":"Interactive Story Capture Loop","description":"The frontend shall implement an interactive loop allowing users to record audio segments, send them for processing, display the analysis (transcript, summary), and receive new guiding questions to continue the interview or finalize the story. UI states (idle, recording, processing, showing_analysis) must be managed.","priority":"critical","type":"frontend","researchTool":""},{"title":"Offline-First Story Archiving","description":"The application shall support offline-first functionality for story archiving, utilizing IndexedDB or localStorage for local data persistence. This ensures stories can be captured and managed without constant internet connectivity.","priority":"critical","type":"frontend","researchTool":""},{"title":"GDPR-Compliant Data Handling and Consent","description":"The system shall be fully GDPR-compliant, ensuring local storage of data for MVP and implementing explicit opt-in consent flows for any story export or publication. Data privacy is paramount for user trust.","priority":"critical","type":"security","researchTool":""},{"title":"Story Metadata Tagging and Structuring","description":"The system shall enable the application of rich metadata to stories, including geo-tagging, temporal structuring, dialect capture, and general tags. This enhances the discoverability and historical value of the archived stories.","priority":"high","type":"backend","researchTool":""},{"title":"Personal Story Management ('My Stories')","description":"Users shall be able to view, edit, and manage their personal collection of archived stories through a dedicated 'My Stories Page' and 'Story Detail / Edit Page'. This includes reviewing transcripts, summaries, and associated metadata.","priority":"high","type":"frontend","researchTool":""},{"title":"Story Export and Sharing Capabilities","description":"The system shall provide functionality to export and share stories in various formats, including PDF, Podcast, and Timeline. This fulfills the public and private purposes of the digital archive.","priority":"high","type":"backend","researchTool":""},{"title":"Multilingual User Interface (i18n)","description":"The user interface shall support multiple languages, starting with German and English, with the ability for users to switch languages and persist their preference using local storage. This improves usability for a diverse audience.","priority":"high","type":"frontend","researchTool":""},{"title":"Public Story Archive and Viewing","description":"The system shall provide a 'Public Archive Page' and 'Public Story View Page' allowing public users to explore and view stories that have been explicitly consented for public sharing. This supports cultural and historical engagement.","priority":"medium","type":"frontend","researchTool":""},{"title":"Containerized Development Environment","description":"The project shall utilize Docker and Docker Compose to provide a consistent and easily reproducible development environment for both frontend and backend services. This streamlines setup and deployment.","priority":"high","type":"backend","researchTool":""},{"title":"Secure API Key Management","description":"The application shall manage sensitive API keys (e.g., for LLM providers) securely, utilizing environment variables and `.env` files, ensuring they are not hardcoded or committed to version control.","priority":"high","type":"security","researchTool":""},{"title":"Robust Error Handling and UI Feedback","description":"The system shall implement comprehensive error handling for API calls, microphone access, and other critical operations, providing clear feedback to the user and managing UI state transitions gracefully.","priority":"medium","type":"frontend","researchTool":""},{"title":"Cross-Origin Resource Sharing (CORS) Configuration","description":"The backend API shall be configured with appropriate CORS headers to allow communication with the frontend application, especially when running in separate containers or domains during development.","priority":"medium","type":"backend","researchTool":""},{"title":"Microphone Access and Audio Recording","description":"The frontend shall securely request and manage microphone permissions from the user's browser, enabling the capture of audio for story recording using the MediaRecorder API.","priority":"critical","type":"frontend","researchTool":""},{"title":"Performance of AI and STT Processing","description":"The AI-guided interview and voice-to-text transcription processes shall be optimized for performance to ensure minimal latency and a smooth user experience, particularly for real-time interaction.","priority":"medium","type":"backend","researchTool":""},{"title":"Scalability for Future Cloud Deployment","description":"While the MVP is local-only, the system architecture shall consider future scalability to support cloud hosting (e.g., STACKIT/SICOS BW) and a growing number of users and archived stories.","priority":"low","type":"backend","researchTool":""},{"title":"Admin and Partner Portal Functionality","description":"The system shall eventually include restricted access pages for administrators, content moderators, and institutional partners to manage content, users, and specific collections, ensuring quality control and collaboration.","priority":"low","type":"backend","researchTool":""},{"title":"Pricing and Subscription Management","description":"The application shall incorporate a 'Pricing & Subscription Page' and related backend logic to manage private archive subscriptions and corporate storytelling packages, supporting the defined business model.","priority":"low","type":"backend","researchTool":""}],"aiArtifacts":[{"content":{"type":"Requirement","content":"## Requirements Overview\n\nStorycatcher II is a digital archiving application designed to capture, preserve, and share personal stories. The system prioritizes user privacy through a local-first, GDPR-compliant approach, while leveraging AI for guided interviews and robust voice-to-text transcription. It aims to provide an intuitive experience for users to record, manage, and optionally share their narratives.\n\n### Requirements Categorization and Priority\n\n| ID    | Type      | Priority  | Description Summary                                          |\n| :---- | :-------- | :-------- | :----------------------------------------------------------- |\n| 2285  | backend   | critical  | User Registration and Authentication                         |\n| 2286  | backend   | critical  | AI-Guided Interview Assistant                                |\n| 2287  | backend   | critical  | Voice-to-Text Transcription (Local-First)                    |\n| 2288  | frontend  | critical  | Interactive Story Capture Loop                               |\n| 2289  | frontend  | critical  | Offline-First Story Archiving                                |\n| 2290  | security  | critical  | GDPR-Compliant Data Handling and Consent                     |\n| 2300  | frontend  | critical  | Microphone Access and Audio Recording                        |\n| 2291  | backend   | high      | Story Metadata Tagging and Structuring                       |\n| 2292  | frontend  | high      | Personal Story Management ('My Stories')                     |\n| 2293  | backend   | high      | Story Export and Sharing Capabilities                        |\n| 2294  | frontend  | high      | Multilingual User Interface (i18n)                           |\n| 2296  | backend   | high      | Containerized Development Environment                        |\n| 2297  | security  | high      | Secure API Key Management                                    |\n| 2295  | frontend  | medium    | Public Story Archive and Viewing                             |\n| 2298  | frontend  | medium    | Robust Error Handling and UI Feedback                        |\n| 2299  | backend   | medium    | Cross-Origin Resource Sharing (CORS) Configuration           |\n| 2301  | backend   | medium    | Performance of AI and STT Processing                         |\n| 2302  | backend   | low       | Scalability for Future Cloud Deployment                      |\n| 2303  | backend   | low       | Admin and Partner Portal Functionality                       |\n| 2304  | backend   | low       | Pricing and Subscription Management                          |\n\n## Functional Requirements\n\n### Core Business Functionality\n*   **User Registration and Authentication (2285):** The system shall enable secure user registration and login, serving as the primary access point for personalized story archiving.\n*   **AI-Guided Interview Assistant (2286):** The system shall provide an AI-driven interview process, utilizing the 5W questioning method to prompt users based on processed audio segments, facilitating story capture.\n*   **Voice-to-Text Transcription (2287):** The system shall perform voice-to-text transcription of audio using local-first STT engines (Whisper/Vosk) to process interviews on-device.\n*   **Story Metadata Tagging and Structuring (2291):** The system shall allow applying rich metadata to stories, including geo-tagging, temporal data, dialect, and general tags, to enhance discoverability.\n*   **Story Export and Sharing Capabilities (2293):** The system shall support exporting and sharing stories in PDF, Podcast, and Timeline formats, enabling both private and public dissemination.\n\n### User Interaction and Interface Requirements\n*   **Interactive Story Capture Loop (2288):** The frontend shall manage UI states (idle, recording, processing, showing_analysis) to facilitate an interactive loop for recording, processing, displaying analysis (transcript, summary), and receiving new guiding questions.\n*   **Personal Story Management ('My Stories') (2292):** Users shall be able to view, edit, and manage their archived stories, including reviewing transcripts, summaries, and metadata, via dedicated pages.\n*   **Public Story Archive and Viewing (2295):** The system shall provide public access pages for exploring and viewing stories explicitly consented for public sharing.\n*   **Microphone Access and Audio Recording (2300):** The frontend shall securely request and manage microphone permissions, enabling audio capture via the MediaRecorder API.\n*   **Multilingual User Interface (i18n) (2294):** The UI shall support multiple languages (German, English initially), allowing users to switch and persist their language preference.\n\n### Data Processing and Management Requirements\n*   **Offline-First Story Archiving (2289):** The application shall support offline functionality for story archiving using IndexedDB or localStorage for local data persistence.\n\n### Integration and Workflow Requirements\n*   **Admin and Partner Portal Functionality (2303):** (Future) The system shall include restricted access pages for administrators, content moderators, and institutional partners for content and user management.\n*   **Pricing and Subscription Management (2304):** (Future) The application shall incorporate a 'Pricing & Subscription Page' and backend logic for managing subscriptions.\n\n## Non-Functional Requirements\n\n### Performance and Scalability Requirements\n*   **Performance of AI and STT Processing (2301):** AI-guided interview and voice-to-text processes shall be optimized for minimal latency and a smooth user experience.\n*   **Scalability for Future Cloud Deployment (2302):** The system architecture shall consider future scalability for cloud hosting and a growing user base.\n\n### Security and Compliance Requirements\n*   **GDPR-Compliant Data Handling and Consent (2290):** (Detailed in separate section)\n*   **Secure API Key Management (2297):** (Detailed in separate section)\n\n### Usability and Reliability Requirements\n*   **Robust Error Handling and UI Feedback (2298):** The system shall implement comprehensive error handling for API calls and microphone access, providing clear user feedback.\n*   **Containerized Development Environment (2296):** Docker and Docker Compose shall be used to provide a consistent and reproducible development environment.\n*   **Cross-Origin Resource Sharing (CORS) Configuration (2299):** The backend API shall be configured with appropriate CORS headers to allow frontend communication.\n\n## Requirements Analysis\n\n### Mermaid Diagram Showing Requirement Relationships\n\n```mermaid\ngraph TD\n    A[\"2285 - User Auth\"] --> B[\"2288 - Interactive Capture Loop\"];\n    B --> C[\"2300 - Microphone Access\"];\n    C --> D[\"2287 - Voice-to-Text\"];\n    D --> E[\"2286 - AI-Guided Interview\"];\n    E --> B;\n    D --> F[\"2291 - Story Metadata Tagging\"];\n    F --> G[\"2292 - My Stories\"];\n    E --> G;\n    G --> H[\"2293 - Story Export/Sharing\"];\n    H --> I[\"2295 - Public Archive\"];\n    J[\"2290 - GDPR Compliance\"] --\"Impacts\"--> A;\n    J --\"Impacts\"--> D;\n    J --\"Impacts\"--> G;\n    J --\"Impacts\"--> H;\n    J --\"Impacts\"--> I;\n    K[\"2289 - Offline-First Archiving\"] --\"Supports\"--> G;\n    L[\"2297 - Secure API Key Management\"] --\"Supports\"--> E;\n    M[\"2301 - AI/STT Performance\"] --\"Optimizes\"--> D;\n    M --\"Optimizes\"--> E;\n    N[\"2298 - Error Handling\"] --\"Improves\"--> B;\n    N --\"Improves\"--> G;\n    O[\"2294 - Multilingual UI\"] --\"Enhances\"--> B;\n    O --\"Enhances\"--> G;\n    O --\"Enhances\"--> I;\n    P[\"2296 - Containerized Dev\"] --\"Facilitates\"--> A;\n    P --\"Facilitates\"--> D;\n    P --\"Facilitates\"--> L;\n    Q[\"2299 - CORS Config\"] --\"Enables\"--> A;\n    Q --\"Enables\"--> D;\n    R[\"2302 - Scalability\"] --\"Future\"--> A;\n    R --\"Future\"--> G;\n    S[\"2303 - Admin Portal\"] --\"Future\"--> G;\n    T[\"2304 - Pricing/Subscription\"] --\"Future\"--> A;\n```\n\n### Priority Matrix and Acceptance Criteria\n\n**Priority Matrix:** Requirements are categorized into Critical, High, Medium, and Low priorities. Critical requirements are essential for the MVP and core functionality. High priority items are vital for a complete and robust user experience. Medium priority items enhance usability and prepare for future growth, while Low priority items are future considerations for later phases.\n\n**Acceptance Criteria:** For each requirement, acceptance will be based on:\n*   **Functional Completeness:** All specified features are implemented and operate as described.\n*   **Performance:** The system meets defined performance benchmarks, particularly for AI/STT processing.\n*   **Security:** Adherence to all security protocols, including secure data handling and API key management.\n*   **Compliance:** Full compliance with GDPR regulations regarding data privacy and consent.\n*   **Usability:** The UI is intuitive, responsive, and provides clear feedback, supporting multilingual preferences.\n*   **Reliability:** The system handles errors gracefully and maintains data integrity, especially in offline scenarios.\n\n## Security & Compliance Requirements\n\n### Security Requirements\n*   **Secure User Registration and Authentication (2285):** Implement robust authentication mechanisms (e.g., password hashing, secure token management) to protect user accounts from unauthorized access.\n*   **Secure API Key Management (2297):** All sensitive API keys for external services (e.g., LLM providers) must be stored and accessed securely using environment variables or a secrets management system, preventing hardcoding or inclusion in version control.\n*   **Secure Microphone Access (2300):** Microphone access must be requested explicitly from the user and managed securely by the browser, adhering to standard web security practices.\n*   **Data Integrity and Confidentiality:** Ensure data stored locally (IndexedDB/localStorage) is protected from unauthorized access or tampering, though explicit encryption is not specified for MVP.\n\n### Compliance Frameworks and Regulations\n*   **GDPR (General Data Protection Regulation) (2290):** The system must be fully compliant with GDPR, specifically:\n    *   **Data Minimization:** Only collect data necessary for core functionality.\n    *   **Local Data Storage:** For MVP, user story data must be stored locally on the user's device.\n    *   **Explicit Consent:** For any story export or publication to a public archive, explicit, opt-in consent from the user is mandatory.\n    *   **Right to Erasure/Access:** Users must have clear mechanisms to access, correct, or delete their personal data.\n\n### Best Practice Implementation Guidelines\n*   **Principle of Least Privilege:** Components and services should only have the minimum necessary permissions.\n*   **Secure Coding Practices:** Adhere to OWASP Top 10 guidelines for web application security.\n*   **Regular Security Audits:** Conduct periodic security reviews and vulnerability assessments.\n*   **Data Encryption in Transit:** Use HTTPS/TLS for all communication between frontend and backend to protect data during transmission.\n*   **CORS Configuration (2299):** Implement strict CORS policies on the backend to prevent unauthorized cross-origin requests.","format":"markdown","reasoning":"This Requirement artifact was AI-generated based on the requirements for Storycatcher II."},"majorVersionNumber":1,"minorVersionNumber":1,"patchNumber":1,"projectId":1413,"type":"Requirement"},{"content":{"content":"# Project Overview: Storycatcher II\n\n## Executive Summary\n\n**Project Name:** Storycatcher II\n\nStorycatcher II is a JavaScript-based application designed to facilitate the secure and private capture, management, and presentation of personal stories. As a second iteration, it emphasizes enhanced user experience, robust data privacy, and intelligent assistance.\n\n**Purpose and Key Objectives:** The primary purpose is to provide a platform for individuals to digitally archive their personal narratives. Key objectives include establishing secure user authentication, implementing an AI-guided interview process based on the 5W method, performing local-first voice-to-text transcription, enabling interactive story capture, ensuring offline-first data archiving, and strictly adhering to GDPR compliance by prioritizing local data handling.\n\n**Target Audience and Expected Outcomes:** The primary target audience comprises individuals seeking a secure and structured way to document their life stories. Future expansion may include cultural institutions or businesses interested in corporate storytelling. Expected outcomes are a user-friendly, private, and efficient tool that empowers users to preserve their heritage and memories digitally.\n\n**Business Value and Success Criteria:** Storycatcher II offers significant business value by addressing the growing demand for digital legacy tools with strong privacy assurances. It facilitates cultural preservation and creates a foundation for potential subscription models for private archiving or corporate packages. Success will be measured by high user engagement in story capture, successful implementation of GDPR-compliant local data storage, accuracy and performance of AI and STT processes, and seamless offline functionality.\n\n## Project Description\n\n**Problem Statement:** Many existing digital storytelling tools either lack structured guidance for narrative capture or compromise user data privacy by relying heavily on cloud-based processing and storage. There is a need for a solution that combines intelligent assistance with a strong commitment to data sovereignty and user control.\n\n**Proposed Solution:** Storycatcher II addresses these challenges by offering an AI-guided interview assistant to structure story capture, utilizing local-first voice-to-text transcription for enhanced privacy, and implementing an offline-first architecture for data persistence on the user's device. This approach ensures a private, guided, and accessible storytelling experience.\n\n**Project Scope:**\n*   **Included:**\n    *   Secure User Registration and Authentication (2285)\n    *   AI-Guided Interview Assistant (2286)\n    *   Voice-to-Text Transcription (Local-First STT) (2287)\n    *   Interactive Story Capture Loop (2288)\n    *   Offline-First Story Archiving (2289)\n    *   GDPR-Compliant Data Handling and Consent (2290)\n    *   Story Metadata Tagging and Structuring (2291)\n    *   Personal Story Management ('My Stories') (2292)\n    *   Story Export and Sharing Capabilities (2293)\n    *   Multilingual User Interface (i18n) (2294)\n    *   Public Story Archive and Viewing (2295) - *Medium Priority*\n    *   Containerized Development Environment (2296)\n    *   Secure API Key Management (2297)\n    *   Robust Error Handling and UI Feedback (2298)\n    *   Cross-Origin Resource Sharing (CORS) Configuration (2299)\n    *   Microphone Access and Audio Recording (2300)\n    *   Performance Optimization for AI and STT Processing (2301)\n*   **Excluded (for MVP, but future considerations):**\n    *   Scalability for Future Cloud Deployment (2302)\n    *   Admin and Partner Portal Functionality (2303)\n    *   Pricing and Subscription Management (2304)\n\n**Key Deliverables:** A fully functional web application providing secure user authentication, an interactive AI-guided story capture process with local-first transcription, offline story archiving, and mechanisms for reviewing, managing, and exporting personal stories, all compliant with GDPR.\n\n**Constraints:** The project is a JavaScript-based web application. A critical constraint is the \"local-first\" approach for sensitive data processing (STT) and storage (archiving), ensuring GDPR compliance by minimizing external data exposure.\n\n## Stakeholders & Context\n\n**Primary Stakeholders and Their Roles:**\n*   **Users:** Individuals who will capture, manage, and share their personal stories. Their needs drive core features like privacy, ease of use, and guided storytelling.\n*   **Project Team:** Developers, designers, and project managers responsible for the design, implementation, and deployment of Storycatcher II.\n*   **Product Owner:** Defines the vision, prioritizes features, and ensures the product aligns with user needs and business objectives.\n*   **Legal/Compliance Team:** Ensures adherence to GDPR and other relevant data privacy regulations.\n\n**Business Context and Market Drivers:** The project operates within a growing market for digital personal archiving and cultural heritage preservation. Key drivers include increasing awareness of data privacy, demand for accessible storytelling tools, and the desire to preserve family histories and personal narratives digitally. The emphasis on \"local-first\" and GDPR compliance addresses significant market concerns regarding data sovereignty.\n\n**High-Level Timeline and Phases:** The project will be developed iteratively, focusing on delivering a Minimum Viable Product (MVP) first, encompassing all critical and high-priority requirements. Subsequent phases will address medium and low-priority features, including scalability for cloud deployment and specialized portals.\n\n## Requirements Overview\n\n**Summary of Functional Requirements:**\n*   **Critical:** User authentication, AI-guided interviews via 5W method, local-first voice-to-text transcription, interactive frontend for story capture, offline-first story archiving, comprehensive GDPR compliance, and secure microphone access. These form the core privacy-centric storytelling experience.\n*   **High:** Rich metadata tagging for stories, dedicated personal story management (view/edit), diverse story export and sharing options, multilingual UI support (German/English), containerized development environment for consistency, and secure API key management. These enhance usability, manageability, and development efficiency.\n*   **Medium:** Public archive for consented stories, robust error handling with clear UI feedback, and proper CORS configuration for API communication, performance optimization for AI/STT. These ensure broader accessibility, stability, and responsiveness.\n*   **Low:** Future considerations include scalability for cloud deployment, administrator/partner portals, and pricing/subscription management, which address long-term growth and business models.\n\n**Non-Functional Requirements:**\n*   **Security & Privacy:** GDPR compliance (2290), secure API key management (2297), secure user authentication (2285), local-first data processing/storage (2287, 2289).\n*   **Performance:** Optimized AI and STT processing for minimal latency (2301).\n*   **Usability:** Multilingual user interface (2294), clear UI feedback and error handling (2298).\n*   **Maintainability & Operability:** Containerized development environment (2296), consideration for future scalability (2302).\n*   **Data Integrity:** Robust data persistence for offline archiving (2289).\n\n**Key Assumptions:**\n*   Users will have modern web browsers capable of supporting necessary APIs (e.g., MediaRecorder, IndexedDB).\n*   Local-first STT engines (Whisper/Vosk) can be integrated efficiently into the backend environment to meet performance and GDPR requirements.\n*   Backend infrastructure (even if private/on-premise) will be available for STT and AI processing.\n\n**Dependencies:**\n*   Frontend depends on secure backend API for authentication, AI guidance, and STT processing.\n*   Backend depends on selected local-first STT engines (Whisper/Vosk) and potentially LLM providers for AI guidance.\n\n## System Architecture\n\n```mermaid\ngraph LR\n    subgraph \"User Device\"\n        A[\"Client - React/JavaScript UI\"] --> B(\"Microphone Access / MediaRecorder API\");\n        A --> C(\"Local Storage - IndexedDB / localStorage\");\n    end\n\n    subgraph \"Backend Services - Node.js\"\n        D(\"API Gateway / Authentication\") --> E(\"User Management Service\");\n        D --> F(\"Story Processing Service\");\n        F --> G(\"AI-Guided Interview Logic\");\n        F --> H(\"Local-First STT Engine - Whisper / Vosk\");\n        F --> I(\"Story Data Management\");\n    end\n\n    subgraph \"External Integration\"\n        J(\"LLM Provider API - for AI Guidance\");\n    end\n\n    A -- \"API Calls\" --> D;\n    B -- \"Audio Stream\" --> F;\n    F -- \"Text & Analysis\" --> A;\n    G -- \"Question Generation\" --> J;\n    J -- \"AI Responses\" --> G;\n    I -- \"Store Story Metadata\" --> K(\"Backend Database - PostgreSQL / MongoDB\");\n\n    style A fill:#e0f7fa,stroke:#00796b,stroke-width:2px\n    style B fill:#e0f7fa,stroke:#00796b,stroke-width:2px\n    style C fill:#e0f7fa,stroke:#00796b,stroke-width:2px\n    style D fill:#c8e6c9,stroke:#388e3c,stroke-width:2px\n    style E fill:#c8e6c9,stroke:#388e3c,stroke-width:2px\n    style F fill:#c8e6c9,stroke:#388e3c,stroke-width:2px\n    style G fill:#c8e6c9,stroke:#388e3c,stroke-width:2px\n    style H fill:#c8e6c9,stroke:#388e3c,stroke-width:2px\n    style I fill:#c8e6c9,stroke:#388e3c,stroke-width:2px\n    style J fill:#fff8e1,stroke:#fbc02d,stroke-width:2px\n    style K fill:#bbdefb,stroke:#1976d2,stroke-width:2px\n```\n\n## Interactive Story Capture Loop\n\n```mermaid\nsequenceDiagram\n    actor User;\n    participant Frontend;\n    participant Backend;\n    participant STT_Engine as \"Local-First STT Engine\";\n    participant AI_Interviewer as \"AI Interviewer\";\n\n    User->>Frontend: \"Start Recording Story\";\n    Frontend->>Frontend: \"Activate Microphone / MediaRecorder\";\n    Frontend->>User: \"Display Recording UI\";\n\n    loop \"Record Audio Segments\"\n        User->>Frontend: \"Speak into Microphone\";\n        Frontend->>Frontend: \"Capture Audio Segment\";\n        User->>Frontend: \"Stop Recording Segment\";\n        Frontend->>Backend: \"Send Audio Segment for Processing\";\n        Backend->>STT_Engine: \"Request Transcription of Audio\";\n        STT_Engine-->>Backend: \"Return Transcript Text\";\n        Backend->>AI_Interviewer: \"Analyze Transcript / Generate Questions (5W)\";\n        AI_Interviewer-->>Backend: \"Return Analysis and Next Question\";\n        Backend-->>Frontend: \"Send Transcript, Summary, New Question\";\n        Frontend->>Frontend: \"Store Transcript / Summary Locally (IndexedDB)\";\n        Frontend->>User: \"Display Analysis and New Question\";\n\n        alt \"User wants to continue\"\n            User->>Frontend: \"Continue Recording\";\n        else \"User wants to finalize\"\n            User->>Frontend: \"Finalize Story\";\n            Frontend->>Backend: \"Request Story Finalization\";\n            Backend-->>Frontend: \"Confirm Story Archived\";\n            Frontend->>User: \"Display 'Story Archived' Confirmation\";\n            break;\n        end\n    end\n```\n\n## Success Metrics & Risks\n\n**How Success Will Be Measured:**\n*   **User Adoption:** Number of registered users and active storytellers.\n*   **Story Capture Rate:** Average number of audio segments and complete stories captured per active user.\n*   **Data Privacy Compliance:** Successful internal and external audits confirming adherence to GDPR, especially regarding local data handling and consent flows.\n*   **System Stability & Performance:** Uptime of backend services, latency of STT and AI processing, and responsiveness of the frontend.\n*   **Offline Functionality:** Successful story capture and management when the device is offline, with seamless synchronization upon reconnection.\n\n**Key Performance Indicators (KPIs):**\n*   Percentage of users completing at least one full story.\n*   Average latency for audio transcription and AI question generation.\n*   STT accuracy rate (word error rate - WER).\n*   Number of support tickets related to data privacy or technical issues.\n*   User retention rate for story archiving.\n\n**Major Risks and Mitigation Strategies:**\n*   **Risk: GDPR Compliance Complexity:** Ensuring full compliance with \"local-first\" data handling and explicit consent can be intricate.\n    *   **Mitigation:** Engage legal counsel early, implement privacy-by-design principles throughout development, develop clear and auditable consent flows for all data processing and sharing.\n*   **Risk: Voice-to-Text Accuracy and Performance:** Local-first STT engines might not match cloud-based accuracy or speed, impacting user experience.\n    *   **Mitigation:** Benchmark multiple local STT engines (Whisper, Vosk) to select the most performant and accurate. Optimize model deployment. Provide clear UI feedback during processing delays.\n*   **Risk: Microphone Access and Browser Compatibility:** Issues with browser permissions or API differences could hinder audio recording.\n    *   **Mitigation:** Implement robust permission handling with clear user prompts. Conduct extensive cross-browser and cross-device testing. Provide fallback mechanisms or clear error messages.\n*   **Risk: User Adoption due to Privacy Concerns:** Despite \"local-first,\" users may still be hesitant to trust a new platform with sensitive personal stories.\n    *   **Mitigation:** Be transparent about data handling practices. Clearly communicate the \"local-first\" and GDPR compliance benefits. Build a strong privacy policy and user trust through consistent reliable performance.\n*   **Risk: Scalability Challenges for Future Cloud Deployment:** While MVP is local-first, future cloud deployment might face architectural hurdles.\n    *   **Mitigation:** Design the backend services with modularity and microservices principles from the outset. Use containerization (Docker) to ensure portability. Plan for future infrastructure scaling (e.g., message queues, load balancing).","format":"markdown","type":"ProjectOverview","reasoning":"This ProjectOverview artifact was AI-generated based on the requirements for Storycatcher II."},"majorVersionNumber":1,"minorVersionNumber":1,"patchNumber":1,"projectId":1413,"type":"ProjectOverview"},{"content":{"content":"## User Flows Overview\n\nThis document outlines the key user journeys within Storycatcher II, a privacy-centric application for capturing and managing personal stories. The purpose of these flows is to visualize the step-by-step interactions between the user and the system, highlighting critical paths, decision points, and system responses. Flows are categorized to provide a clear understanding of core functionalities, user onboarding, and data management processes, all strictly adhering to the requirements outlined in the project artifacts.\n\n## Primary User Journey Flows\n\n### User Registration and Login Flow (Requirement 2285)\nThis flow details the initial entry point for users, allowing new users to register securely and existing users to log in.\n\n```mermaid\ngraph TD\n    A[\"User - Landing Page\"] --> B{\"Has Account?\"};\n    B -- \"No\" --> C[\"Registration Page\"];\n    C --> D{\"Enter Details / Register\"};\n    D --> E(\"Backend - Register User\");\n    E -- \"Success\" --> F[\"Login Page\"];\n    B -- \"Yes\" --> F;\n    F --> G{\"Enter Credentials / Login\"};\n    G --> H(\"Backend - Authenticate User\");\n    H -- \"Success\" --> I[\"Dashboard / My Stories Page\"];\n    H -- \"Failure\" --> F;\n    E -- \"Failure\" --> C;\n```\n\n### Interactive Story Capture Flow (Requirements 2288, 2300, 2287, 2286)\nThis core flow describes how users record audio, receive AI-guided questions, and process story segments, integrating microphone access, local-first STT, and AI assistance.\n\n```mermaid\ngraph TD\n    A[\"User - Dashboard\"] --> B[\"Start New Story / Record\"];\n    B --> C{\"Microphone Access Granted?\"};\n    C -- \"No\" --> D[\"Request Microphone Permission\"];\n    D -- \"Granted\" --> E(\"Frontend - Activate MediaRecorder\");\n    D -- \"Denied\" --> F[\"Display Mic Access Error\"];\n    C -- \"Yes\" --> E;\n    E --> G[\"Frontend - Display Recording UI\"];\n\n    subgraph \"Interactive Recording Loop\"\n        G --> H[\"User - Speak into Microphone\"];\n        H --> I[\"Frontend - Capture Audio Segment\"];\n        I --> J[\"User - Stop Recording Segment\"];\n        J --> K(\"Frontend - Send Audio to Backend\");\n        K --> L(\"Backend - Local-First STT Engine\");\n        L --> M(\"Backend - AI Interview Logic\");\n        M --> N[\"Backend - Send Transcript / Analysis / Question\"];\n        N --> O[\"Frontend - Store Data Locally IndexedDB\"];\n        O --> P[\"Frontend - Display Analysis / New Question\"];\n        P --> Q{\"Continue Recording?\"};\n        Q -- \"Yes\" --> G;\n    end\n\n    Q -- \"No / Finalize\" --> R[\"Frontend - Finalize Story\"];\n    R --> S(\"Backend - Story Finalization\");\n    S --> T[\"Frontend - Story Archived Confirmation\"];\n    F --> X[\"User - End Session\"];\n    T --> X;\n```\n\n## Supporting and Alternative Flows\n\n### Story Management and Export Flow (Requirements 2292, 2291, 2293, 2290)\nThis flow covers users reviewing, editing, adding metadata to, and exporting their archived stories, including the explicit consent step for sharing.\n\n```mermaid\ngraph TD\n    A[\"User - My Stories Page\"] --> B[\"Select Story\"];\n    B --> C[\"Story Detail / Edit Page\"];\n    C --> D{\"Action?\"};\n    D -- \"Edit Metadata\" --> E[\"Edit Metadata Form\"];\n    E --> F(\"Backend - Update Story Metadata\");\n    D -- \"Export / Share\" --> G[\"Export / Share Options\"];\n    G --> H{\"Public Sharing Selected?\"};\n    H -- \"Yes\" --> I[\"Display GDPR Consent Form\"];\n    I --> J{\"User Grants Consent?\"};\n    J -- \"No\" --> K[\"Cancel Export / Back\"];\n    J -- \"Yes\" --> L(\"Backend - Process Export / Share\");\n    H -- \"No\" --> L;\n    L --> M[\"Frontend - Export / Share Confirmation\"];\n    F --> C;\n    K --> G;\n    M --> A;\n```\n\n### Public Story Viewing Flow (Requirement 2295)\nThis flow describes how users can browse and view stories that have been explicitly consented for public sharing.\n\n```mermaid\ngraph LR\n    A[\"User - Public Archive Page\"] --> B[\"Browse Stories\"];\n    B --> C[\"Select Public Story\"];\n    C --> D[\"Public Story View Page\"];\n    D --> E[\"User - End Session\"];\n```\n\n### Error Handling and Feedback Flow (Requirement 2298)\nThis general flow illustrates how the system provides feedback to the user when errors occur, ensuring a robust user experience.\n\n```mermaid\ngraph TD\n    A[\"User Action\"] --> B(\"System Operation\");\n    B -- \"Success\" --> C[\"UI - Display Success\"];\n    B -- \"Failure\" --> D{\"Error Type?\"};\n    D -- \"API Call Failed\" --> E[\"UI - Network Error Message\"];\n    D -- \"Permission Denied\" --> F[\"UI - Permission Required Message\"];\n    D -- \"Processing Error\" --> G[\"UI - Operation Failed Message\"];\n    E --> H[\"UI - Suggest Retry / Contact Support\"];\n    F --> H;\n    G --> H;\n    H --> I[\"User - Acknowledge / Retry\"];\n```\n\n## Flow Analysis and Optimization\n\nThe defined user flows prioritize a secure, private, and intuitive experience. The \"Interactive Story Capture Flow\" is central, leveraging local-first processing (2287) and AI guidance (2286) to minimize latency (2301) and keep sensitive data on the user's device, reinforcing GDPR compliance (2290). Error handling (2298) is integrated across flows to provide clear UI feedback, enhancing usability.\n\nOptimization opportunities include refining the AI-guided interview's question generation for maximum relevance and engagement. The \"Offline-First Story Archiving\" (2289) ensures continuity, but the synchronization process when reconnected should be seamless and non-blocking. The \"Story Export and Sharing Flow\" explicitly incorporates GDPR consent (2290), which is critical for user trust and legal compliance. Accessibility (2294 - Multilingual UI) is considered from the outset, broadening the user base. Each flow directly corresponds to critical and high-priority requirements, ensuring that the MVP delivers core value while maintaining privacy and security.","type":"UserFlows","format":"markdown","reasoning":"This UserFlows artifact was AI-generated based on the requirements for Storycatcher II."},"majorVersionNumber":1,"minorVersionNumber":1,"patchNumber":1,"projectId":1413,"type":"UserFlows"},{"content":{"reasoning":"This UserStories artifact was AI-generated based on the requirements for Storycatcher II.","format":"markdown","content":"## User Stories Overview\n\nThis document outlines the user stories for Storycatcher II, adopting an Agile methodology to incrementally deliver value. User stories, structured as \"As a [user type], I want [functionality] so that [benefit],\" facilitate understanding requirements from a user perspective, guiding development, testing, and prioritization.\n\n### Epic-Level User Stories\n\nMajor features are grouped into the following epics:\n\n*   **User Identity & Security:** Encompasses secure user access, authentication, and fundamental data privacy.\n*   **Core Story Capture:** Focuses on the interactive process of recording, transcribing, and receiving AI-guided questions.\n*   **Story Management & Archiving:** Covers local data persistence, organization, and review of personal narratives.\n*   **Story Dissemination:** Deals with options for exporting and sharing stories, including public access.\n*   **Platform Foundation:** Includes underlying technical requirements for development, performance, and future scalability.\n\n### Story Mapping\n\nThe following diagram illustrates the primary user journey for story capture and management, linking key stages to their supporting requirements.\n\n```mermaid\ngraph TD\n    subgraph \"User Journey: Story Capture & Management\"\n        A[\"User Access\"] --> B[\"Start Story\"];\n        B --> C[\"Record/AI Guide\"];\n        C --> D[\"Review/Refine\"];\n        D --> E[\"Archive/Share\"];\n    end\n\n    A --\"Includes\"--> \"2285 - User Auth\";\n    B --\"Includes\"--> \"2300 - Mic Access\";\n    C --\"Includes\"--> \"2288 - Interactive Capture\";\n    C --\"Includes\"--> \"2287 - Voice-to-Text\";\n    C --\"Includes\"--> \"2286 - AI-Guided Interview\";\n    D --\"Includes\"--> \"2292 - My Stories\";\n    D --\"Includes\"--> \"2291 - Metadata Tagging\";\n    E --\"Includes\"--> \"2289 - Offline Archiving\";\n    E --\"Includes\"--> \"2293 - Export/Sharing\";\n    E --\"Includes\"--> \"2295 - Public Archive\";\n\n    subgraph \"Cross-Cutting Concerns\"\n        F[\"2290 - GDPR Compliance\"]\n        G[\"2294 - Multilingual UI\"]\n        H[\"2298 - Error Handling\"]\n        I[\"2301 - Performance\"]\n    end\n\n    F --> A; F --> C; F --> E;\n    G --> A; G --> B; G --> C; G --> D; G --> E;\n    H --> C; H --> D;\n    I --> C;\n```\n\n## Detailed User Stories\n\nStories are grouped by priority, reflecting the project's MVP focus. Story Points (SP) are relative estimates (1: trivial, 2: simple, 3: moderate, 5: complex).\n\n### Critical Priority Stories\n\n*   **ID: 2285 - User Registration and Authentication**\n    *   As a new user, I want to register securely so that I can access personalized story archiving.\n    *   As an existing user, I want to log in securely so that I can continue managing my stories.\n    *   **Acceptance Criteria:** User can create/log in to account securely; Authentication protects user data.\n    *   **SP:** 3. **Dependencies:** 2297.\n*   **ID: 2286 - AI-Guided Interview Assistant**\n    *   As a storyteller, I want AI-guided questions based on the 5W method so that my story capture is structured and comprehensive.\n    *   **Acceptance Criteria:** AI prompts relevant questions after audio processing; Questions align with 5W method.\n    *   **SP:** 5. **Dependencies:** 2287, 2301, 2297.\n*   **ID: 2287 - Voice-to-Text Transcription (Local-First)**\n    *   As a storyteller, I want my recorded audio transcribed to text using local-first STT so that my data remains on-device and private.\n    *   **Acceptance Criteria:** Audio segments are accurately transcribed locally; Transcription adheres to GDPR.\n    *   **SP:** 5. **Dependencies:** 2300, 2301, 2290.\n*   **ID: 2288 - Interactive Story Capture Loop**\n    *   As a storyteller, I want an interactive UI to record, process, display analysis, and receive new questions so that I can smoothly capture my narrative.\n    *   **Acceptance Criteria:** UI clearly shows recording, processing, and analysis states; Displays transcript/summary; Presents next question.\n    *   **SP:** 5. **Dependencies:** 2300, 2287, 2286, 2298.\n*   **ID: 2289 - Offline-First Story Archiving**\n    *   As a storyteller, I want to capture and archive stories offline so that I can work without constant internet access.\n    *   **Acceptance Criteria:** Stories persist locally via IndexedDB/localStorage; Data syncs upon reconnection.\n    *   **SP:** 3. **Dependencies:** 2290.\n*   **ID: 2290 - GDPR-Compliant Data Handling and Consent**\n    *   As a user, I want my data handled GDPR-compliantly with local storage and explicit consent so that my privacy is protected.\n    *   **Acceptance Criteria:** Story data stored locally by default; Explicit opt-in for any export/publication.\n    *   **SP:** 5. **Dependencies:** 2287, 2289, 2293, 2295.\n*   **ID: 2300 - Microphone Access and Audio Recording**\n    *   As a storyteller, I want the system to securely access my microphone so that I can record audio segments for my stories.\n    *   **Acceptance Criteria:** Browser prompts for mic permission; Audio recorded via MediaRecorder API.\n    *   **SP:** 2. **Dependencies:** 2288.\n\n### High Priority Stories\n\n*   **ID: 2291 - Story Metadata Tagging and Structuring**\n    *   As a storyteller, I want to add rich metadata (geo-tagging, temporal, dialect, general tags) to my stories so that they are discoverable and historically valuable.\n    *   **Acceptance Criteria:** User can apply various metadata types; Metadata is stored with the story.\n    *   **SP:** 3. **Dependencies:** 2292.\n*   **ID: 2292 - Personal Story Management ('My Stories')**\n    *   As a storyteller, I want to view, edit, and manage my personal collection of archived stories so that I can review and refine my narratives.\n    *   **Acceptance Criteria:** Dedicated 'My Stories' page exists; User can view/edit transcripts, summaries, and metadata.\n    *   **SP:** 3. **Dependencies:** 2289, 2291.\n*   **ID: 2293 - Story Export and Sharing Capabilities**\n    *   As a storyteller, I want to export and share my stories in various formats (PDF, Podcast, Timeline) so that I can disseminate them privately or publicly.\n    *   **Acceptance Criteria:** Options for PDF, Podcast, Timeline export are available; Sharing requires explicit consent.\n    *   **SP:** 5. **Dependencies:** 2290, 2292.\n*   **ID: 2294 - Multilingual User Interface (i18n)**\n    *   As a user, I want to switch UI languages (German/English) and persist my preference so that I can use the application comfortably.\n    *   **Acceptance Criteria:** UI supports German and English; Language preference is saved locally.\n    *   **SP:** 2.\n*   **ID: 2296 - Containerized Development Environment**\n    *   As a developer, I want a containerized (Docker) development environment so that setup is consistent and reproducible.\n    *   **Acceptance Criteria:** Docker Compose sets up frontend/backend services; Environment is consistent across machines.\n    *   **SP:** 3.\n*   **ID: 2297 - Secure API Key Management**\n    *   As a developer, I want API keys managed securely via environment variables so that sensitive information is protected from version control.\n    *   **Acceptance Criteria:** API keys loaded from .env files; No hardcoded keys in source.\n    *   **SP:** 2. **Dependencies:** 2286.\n\n### Medium Priority Stories\n\n*   **ID: 2295 - Public Story Archive and Viewing**\n    *   As a public user, I want to explore and view publicly shared stories so that I can engage with cultural content.\n    *   **Acceptance Criteria:** Public archive page exists; Public stories are viewable without login.\n    *   **SP:** 3. **Dependencies:** 2293, 2290.\n*   **ID: 2298 - Robust Error Handling and UI Feedback**\n    *   As a user, I want clear feedback and graceful error handling during operations so that I understand system status and issues.\n    *   **Acceptance Criteria:** API call errors are handled; Microphone access errors are managed; UI state updates clearly.\n    *   **SP:** 2.\n*   **ID: 2299 - Cross-Origin Resource Sharing (CORS) Configuration**\n    *   As a developer, I want the backend API configured with correct CORS headers so that frontend/backend communication works seamlessly.\n    *   **Acceptance Criteria:** CORS allows frontend access; Prevents cross-origin issues during development/production.\n    *   **SP:** 1.\n*   **ID: 2301 - Performance of AI and STT Processing**\n    *   As a storyteller, I want fast AI and STT processing so that my interview experience is smooth and low-latency.\n    *   **Acceptance Criteria:** STT and AI processing latency is minimal; User experience feels responsive.\n    *   **SP:** 3. **Dependencies:** 2286, 2287.\n\n### Low Priority Stories (Future Considerations)\n\n*   **ID: 2302 - Scalability for Future Cloud Deployment**\n    *   As a system architect, I want the system designed for future cloud scalability so that it can grow with user base and data.\n    *   **Acceptance Criteria:** Architecture supports cloud deployment patterns; Services are modular.\n    *   **SP:** 1.\n*   **ID: 2303 - Admin and Partner Portal Functionality**\n    *   As an administrator, I want access to restricted pages for content and user management so that I can moderate the platform.\n    *   **Acceptance Criteria:** Admin portal exists; Provides user/content management.\n    *   **SP:** 1. **Dependencies:** 2285.\n*   **ID: 2304 - Pricing and Subscription Management**\n    *   As a business, I want pricing and subscription management functionality so that I can monetize private archiving and corporate packages.\n    *   **Acceptance Criteria:** Pricing page exists; Subscription logic implemented.\n    *   **SP:** 1. **Dependencies:** 2285.\n\n## Story Organization\n\nStories are organized by the Epics defined above and further prioritized as Critical, High, Medium, and Low. Critical stories form the core MVP. High priority stories enhance the core experience. Medium and Low priority stories are planned for subsequent phases.\n\n*   **User Persona Mapping:**\n    *   **Storyteller:** Primary user, interacting with all core capture and management features (2285, 2286, 2287, 2288, 2289, 2291, 2292, 2293, 2300, 2301).\n    *   **Public User:** Views publicly shared stories (2295).\n    *   **Developer:** Focuses on infrastructure and technical enablers (2296, 2297, 2299).\n    *   **Administrator/Partner:** Future roles for content and user management (2303).\n    *   **Business:** Future role for monetization (2304).\n\n*   **Workflow and Process Integration:** Critical stories drive the main user workflow from registration to story capture and initial management. Dependencies ensure a logical build order, with foundational elements (e.g., authentication, microphone access) preceding interactive components. Cross-cutting concerns like GDPR (2290), multilingual support (2294), and error handling (2298) are integrated throughout the development process.\n\n## Access Control and Security Stories\n\nSecurity and access control are paramount, especially given the GDPR compliance requirement.\n\n*   **User Stories Requiring Explicit Permissions:**\n    *   **2285 - User Registration and Authentication:** Requires authentication to access any personalized features.\n    *   **2290 - GDPR-Compliant Data Handling and Consent:** Explicit opt-in consent is required for any story export or publication (2293, 2295).\n    *   **2300 - Microphone Access and Audio Recording:** Requires explicit user permission via browser prompts.\n    *   **2292 - Personal Story Management ('My Stories'):** Access is restricted to the logged-in user for their own stories.\n    *   **2303 - Admin and Partner Portal Functionality:** (Future) Access will be restricted to authorized admin/partner users.\n\n*   **Actions Protected by Segregation of Duty Requirements:**\n    *   For the MVP, explicit segregation of duties is not a primary concern beyond basic user/admin roles. Future Admin/Partner portals (2303) will introduce distinct roles for content moderation versus user management.\n\n*   **Actions Requiring Audit Log or Audit Trail:**\n    *   While not explicitly detailed for MVP, future enhancements for Admin/Partner portals (2303) and critical data operations (e.g., story deletion, consent changes related to 2290) would benefit from audit logging to track user and system actions for compliance and accountability.\n\n*   **Role-Based Access Control Requirements:**\n    *   **User Role:** Can register, log in, capture stories, manage their own stories, and optionally consent to public sharing.\n    *   **Public Role:** Can view publicly consented stories (2295) without authentication.\n    *   **Admin/Partner Roles (Future):** Will have elevated privileges for content moderation, user management, and potentially collection management (2303).","type":"UserStories"},"majorVersionNumber":1,"minorVersionNumber":1,"patchNumber":1,"projectId":1413,"type":"UserStories"},{"content":{"reasoning":"This TechStack artifact was AI-generated based on the requirements for Storycatcher II.","content":"Storycatcher II leverages a modern, privacy-centric technology stack designed to deliver a robust, local-first, and AI-guided storytelling experience. The architecture emphasizes data sovereignty, performance, and a streamlined development workflow.\n\n## Technology Stack Overview\n\nStorycatcher II employs a client-server architecture with a strong emphasis on local data processing and storage for privacy.\n\n```mermaid\ngraph LR\n    subgraph \"User Device\"\n        A[\"Client - React/JavaScript UI\"] --> B(\"Microphone Access / MediaRecorder API\");\n        A --> C(\"Local Storage - IndexedDB / localStorage\");\n    end\n\n    subgraph \"Backend Services - Node.js\"\n        D(\"API Gateway / Authentication\") --> E(\"User Management Service\");\n        D --> F(\"Story Processing Service\");\n        F --> G(\"AI-Guided Interview Logic\");\n        F --> H(\"Local-First STT Engine - Whisper / Vosk\");\n        F --> I(\"Story Data Management\");\n    end\n\n    subgraph \"External Integration\"\n        J(\"LLM Provider API - for AI Guidance\");\n    end\n\n    A -- \"API Calls (HTTPS/TLS)\" --> D;\n    B -- \"Audio Stream\" --> F;\n    F -- \"Text & Analysis\" --> A;\n    G -- \"Question Generation\" --> J;\n    J -- \"AI Responses\" --> G;\n    I -- \"Store Story Metadata\" --> K(\"Backend Database - PostgreSQL / MongoDB\");\n\n    style A fill:#e0f7fa,stroke:#00796b,stroke-width:2px\n    style B fill:#e0f7fa,stroke:#00796b,stroke-width:2px\n    style C fill:#e0f7fa,stroke:#00796b,stroke-width:2px\n    style D fill:#c8e6c9,stroke:#388e3c,stroke-width:2px\n    style E fill:#c8e6c9,stroke:#388e3c,stroke-width:2px\n    style F fill:#c8e6c9,stroke:#388e3c,stroke-width:2px\n    style G fill:#c8e6c9,stroke:#388e3c,stroke-width:2px\n    style H fill:#c8e6c9,stroke:#388e3c,stroke-width:2px\n    style I fill:#c8e6c9,stroke:#388e3c,stroke-width:2px\n    style J fill:#fff8e1,stroke:#fbc02d,stroke-width:2px\n    style K fill:#bbdefb,stroke:#1976d2,stroke-width:2px\n```\n\n**Technology Selection Principles and Criteria:**\n*   **GDPR Compliance (2290):** Prioritizing local-first data processing and storage.\n*   **Performance (2301):** Optimizing AI and STT processes for minimal latency.\n*   **JavaScript Ecosystem:** Leveraging a unified language for both frontend and backend for consistency and developer efficiency.\n*   **Containerization (2296):** Ensuring consistent and reproducible development environments.\n*   **Security (2297):** Implementing secure API key management and data handling.\n*   **Open Standards:** Utilizing browser-native APIs where possible (e.g., MediaRecorder, IndexedDB).\n\n**Integration and Compatibility Considerations:**\nFrontend and backend communicate via RESTful API calls over HTTPS/TLS. The backend integrates local-first STT engines and external LLM providers. CORS configuration (2299) is essential for seamless communication, especially during development.\n\n## Frontend Technologies\n\n*   **Frontend Framework:** React.js / JavaScript UI (Artifact 1 - System Architecture)\n    *   Chosen for building interactive user interfaces (2288) and single-page applications.\n*   **Local Data Persistence:** IndexedDB / localStorage (Artifact 1 - System Architecture, 2289)\n    *   Critical for offline-first story archiving (2289) and GDPR-compliant local data handling (2290).\n*   **Audio Recording:** MediaRecorder API (2300)\n    *   Standard browser API for secure microphone access and audio capture.\n*   **Internationalization:** i18n libraries (2294)\n    *   For supporting multilingual user interfaces (German and English initially).\n*   **Build Tools:** Standard JavaScript bundlers (e.g., Webpack/Vite implied by React ecosystem)\n    *   To compile, bundle, and optimize frontend assets.\n\n## Backend Technologies\n\n*   **Runtime Environment:** Node.js (Artifact 1 - System Architecture)\n    *   Enables a unified JavaScript stack across frontend and backend.\n*   **Web Framework:** Express.js (Implied by Node.js for API services)\n    *   For building RESTful APIs for user authentication, story processing, and data management.\n*   **Authentication and Authorization:** JWT-based authentication (Implied by 2285 - User Registration and Authentication)\n    *   For secure user login and API access control.\n*   **Voice-to-Text (STT) Engine:** Whisper / Vosk (Artifact 1 - System Architecture, 2287)\n    *   Selected for local-first transcription to ensure GDPR compliance and data privacy (2290).\n*   **AI-Guided Interview Logic:** Custom Node.js modules integrating with LLM Provider API (2286)\n    *   Implements the 5W questioning method and text analysis.\n*   **LLM Integration:** External LLM Provider API (Artifact 1 - System Architecture, 2286)\n    *   For AI guidance and question generation, with secure API key management (2297).\n*   **CORS Configuration:** Express.js CORS middleware (2299)\n    *   To manage cross-origin resource sharing between frontend and backend.\n\n## Data and Storage Solutions\n\n*   **Backend Database:** PostgreSQL / MongoDB (Artifact 1 - System Architecture)\n    *   PostgreSQL (relational) or MongoDB (NoSQL) for storing user data, story metadata (2291), and transcripts/summaries that are not strictly local-only.\n*   **Frontend Local Storage:** IndexedDB / localStorage (2289, 2290)\n    *   Primary storage for user story data, transcripts, and summaries on the user's device.\n\n## Infrastructure and DevOps\n\n*   **Containerization:** Docker and Docker Compose (2296)\n    *   For creating consistent, isolated, and reproducible development and deployment environments for both frontend and backend services.\n*   **Deployment and Hosting:** Docker containers (MVP)\n    *   For the MVP, deployment is container-based. Future plans include cloud hosting (e.g., STACKIT/SICOS BW, 2302).\n*   **Secure API Key Management:** Environment variables and `.env` files (2297)\n    *   To securely store and load sensitive API keys for LLM providers and other services.\n*   **Communication Security:** HTTPS/TLS (Artifact 2 - Security Best Practices)\n    *   Ensuring encrypted communication between the frontend and backend.\n\n## Technology Justification\n\n*   **React.js (Frontend Framework):** Chosen for its component-based architecture, enabling the interactive story capture loop (2288) and complex UI states, including multilingual support (2294) and robust error feedback (2298).\n*   **Node.js / Express.js (Backend Runtime/Framework):** Provides a unified JavaScript development experience (Artifact 1), facilitating faster development and easier context switching. It's well-suited for building the API gateway (2285), processing audio streams, and managing AI/STT logic (2286, 2287).\n*   **IndexedDB / localStorage (Frontend Storage):** Directly supports the critical requirement for offline-first story archiving (2289) and GDPR-compliant local data handling (2290), ensuring user data remains on the device by default.\n*   **Whisper / Vosk (Local-First STT Engine):** Essential for fulfilling the critical requirement of local-first voice-to-text transcription (2287), directly addressing GDPR compliance (2290) by minimizing data transfer off-device.\n*   **PostgreSQL / MongoDB (Backend Database):** Provides robust data persistence for user accounts (2285) and story metadata (2291), which may be shared or managed across sessions. The choice allows flexibility between relational integrity and schema flexibility.\n*   **Docker and Docker Compose (Containerization):** Critical for establishing a consistent and easily reproducible development environment (2296), streamlining setup for developers and ensuring parity between development and deployment stages.\n*   **MediaRecorder API (Frontend Audio):** A standard browser API that securely requests and manages microphone permissions (2300), enabling audio capture directly within the browser, crucial for the interactive capture loop (2288).\n*   **LLM Provider API (AI Guidance):** Powers the AI-guided interview assistant (2286) using the 5W questioning method. Its integration is managed securely (2297) to protect sensitive API keys.\n*   **HTTPS/TLS (Communication Security):** Fundamental for securing data in transit between the frontend and backend, protecting user credentials and story data, a key aspect of overall security (2285, 2290).","type":"TechStack","format":"markdown"},"majorVersionNumber":1,"minorVersionNumber":1,"patchNumber":1,"projectId":1413,"type":"TechStack"},{"content":{"reasoning":"This Architecture artifact was AI-generated based on the requirements for Storycatcher II.","format":"markdown","content":"## Architecture Overview\n\nStorycatcher II is a privacy-centric, JavaScript-based web application designed for secure personal story capture. Its core architectural principle is \"local-first\" data handling for sensitive information, ensuring GDPR compliance. The system uses a modular approach, separating frontend client, backend services, and external integrations.\n\n**Architectural Principles and Design Patterns:**\n*   **Local-First:** Prioritizes on-device data processing (STT) and storage (story archiving) to maximize user privacy and GDPR compliance (2287, 2289, 2290).\n*   **Privacy-by-Design:** Integrates GDPR compliance (2290) and secure API key management (2297) from the outset.\n*   **Modular Design:** Backend services are logically separated (User Management, Story Processing) to facilitate maintainability and future scalability (2302).\n*   **Interactive Loop:** The frontend supports a dynamic recording, processing, and feedback cycle for guided interviews (2288).\n\n**Technology Stack Integration and Rationale:**\nThe architecture leverages a JavaScript ecosystem for both frontend (React) and backend (Node.js) for consistency and developer efficiency. Local-first Voice-to-Text (STT) engines like Whisper or Vosk are integrated directly into the backend to keep transcription on-premises, addressing privacy requirements (2287). IndexedDB/localStorage ensures offline story archiving (2289).\n\n**Scalability and Performance Strategy:**\nPerformance optimization is critical for AI and STT processes to ensure a smooth user experience (2301). The modular backend design considers future cloud deployment and scaling (2302), allowing individual services to scale independently.\n\n## Component Architecture\n\nThe system comprises a frontend client, a Node.js backend with distinct services, and an external LLM integration.\n\n```mermaid\ngraph LR\n    subgraph \"User Device\"\n        A[\"Client - React/JavaScript UI\"] --> B(\"Microphone Access / MediaRecorder API\");\n        A --> C(\"Local Storage - IndexedDB / localStorage\");\n    end\n\n    subgraph \"Backend Services - Node.js\"\n        D(\"API Gateway / Authentication\") --> E(\"User Management Service\");\n        D --> F(\"Story Processing Service\");\n        F --> G(\"AI-Guided Interview Logic\");\n        F --> H(\"Local-First STT Engine - Whisper / Vosk\");\n        F --> I(\"Story Data Management\");\n    end\n\n    subgraph \"External Integration\"\n        J(\"LLM Provider API - for AI Guidance\");\n    end\n\n    A -- \"API Calls\" --> D;\n    B -- \"Audio Stream\" --> F;\n    F -- \"Text & Analysis\" --> A;\n    G -- \"Question Generation\" --> J;\n    J -- \"AI Responses\" --> G;\n    I -- \"Store Story Metadata\" --> K(\"Backend Database - PostgreSQL / MongoDB\");\n\n    style A fill:#e0f7fa,stroke:#00796b,stroke-width:2px\n    style B fill:#e0f7fa,stroke:#00796b,stroke-width:2px\n    style C fill:#e0f7fa,stroke:#00796b,stroke-width:2px\n    style D fill:#c8e6c9,stroke:#388e3c,stroke-width:2px\n    style E fill:#c8e6c9,stroke:#388e3c,stroke-width:2px\n    style F fill:#c8e6c9,stroke:#388e3c,stroke-width:2px\n    style G fill:#c8e6c9,stroke:#388e3c,stroke-width:2px\n    style H fill:#c8e6c9,stroke:#388e3c,stroke-width:2px\n    style I fill:#c8e6c9,stroke:#388e3c,stroke-width:2px\n    style J fill:#fff8e1,stroke:#fbc02d,stroke-width:2px\n    style K fill:#bbdefb,stroke:#1976d2,stroke-width:2px\n```\n\n**Component Responsibilities and Interfaces:**\n*   **Client - React/JavaScript UI (2288, 2292, 2294, 2295, 2298, 2300):** Manages user interaction, audio recording via MediaRecorder API (2300), displays content, and handles local data persistence.\n*   **Local Storage - IndexedDB/localStorage (2289, 2290):** Stores story data locally for offline functionality and GDPR compliance.\n*   **API Gateway / Authentication (2285, 2299):** Entry point for all frontend requests, handles user authentication, and enforces CORS policies (2299).\n*   **User Management Service (2285):** Manages user registration, login, and profile data.\n*   **Story Processing Service (2286, 2287, 2291, 2293, 2301):** Orchestrates the core story capture loop. Receives audio, sends to STT, integrates AI for questions, handles metadata tagging (2291), and manages export/sharing (2293).\n*   **AI-Guided Interview Logic (2286):** Implements the 5W questioning method, interacting with an external LLM.\n*   **Local-First STT Engine (2287, 2301):** Performs voice-to-text transcription of audio segments on the backend server, ensuring data remains local.\n*   **Story Data Management (2291, 2292):** Manages CRUD operations for story content and metadata with the backend database.\n*   **Backend Database (PostgreSQL / MongoDB):** Persists user accounts and story metadata (not raw audio/transcripts for MVP).\n*   **LLM Provider API (2286, 2297):** External service for AI question generation. API keys are securely managed (2297).\n\n**Data Flow and Communication Patterns:**\n*   **User to Frontend:** Direct interaction, microphone input (2300).\n*   **Frontend to Backend:** RESTful API calls for authentication, story segment processing, and story management. Audio streams are sent to the backend (2288).\n*   **Backend Internal:** Service-to-service communication for orchestration (e.g., Story Processing calling STT and AI logic).\n*   **Backend to External LLM:** Secure API calls for AI guidance.\n*   **Backend to Database:** Standard database queries.\n*   **Backend to Frontend:** Transcripts, analysis, new questions, and confirmations are sent back (2288).\n\n## Technology Stack and Infrastructure\n\n*   **Frontend:** React (JavaScript) for interactive UI (2288, 2294). Leverages MediaRecorder API for audio capture (2300) and IndexedDB/localStorage for offline data persistence (2289).\n*   **Backend:** Node.js (JavaScript) for API services. Integrates local-first STT engines (Whisper/Vosk) for on-premise transcription (2287). Database choice is flexible (PostgreSQL/MongoDB) for user and metadata storage.\n*   **Infrastructure:** Docker and Docker Compose are used for a consistent and reproducible development environment (2296).\n*   **Integration Patterns:** RESTful APIs for client-server communication. HTTPS/TLS is used for all data in transit for security.\n*   **Communication Protocols:** HTTP/S for API calls, WebSockets potentially for real-time audio streaming (implicitly supported by MediaRecorder API and backend processing).\n*   **Performance:** AI and STT processing are optimized for minimal latency (2301) using efficient algorithms and local execution.\n\n## Security Architecture\n\n**Security Principles and Threat Model Integration:**\nSecurity is paramount, built on principles of privacy-by-design and least privilege. Key threats include unauthorized access to user accounts/data, data interception, and non-compliance with GDPR.\n\n**Authentication and Authorization Architecture:**\n*   **User Authentication (2285):** Secure login mechanisms (e.g., password hashing, token-based authentication) protect user accounts.\n*   **Authorization:** Access to personal stories and management features is restricted to authenticated users (2292). Public archive viewing (2295) is open to all.\n\n**Data Protection and Encryption Strategies:**\n*   **Local-First Storage (2289, 2290):** The primary data protection strategy is keeping sensitive story content (audio, raw transcripts) on the user's device, minimizing server-side data exposure.\n*   **Data in Transit:** All communication between frontend and backend uses HTTPS/TLS to encrypt data during transmission.\n*   **Secure API Key Management (2297):** Sensitive API keys for external services are managed via environment variables, preventing hardcoding.\n*   **Microphone Access (2300):** Browser-managed permissions ensure secure and explicit user consent for audio recording.\n\n**Compliance and Regulatory Considerations:**\n*   **GDPR Compliance (2290):** The system ensures local storage of MVP data, explicit opt-in consent for any story export or public sharing (2293, 2295), and mechanisms for users to manage their data.\n\n## Architecture Security & Compliance\n\n**Threat Model of the Architecture:**\n*   **Unauthorized Access to User Accounts:** A user's account could be compromised, leading to unauthorized access to their story metadata and ability to trigger exports.\n    *   **Mitigation:** Robust authentication (2285), password hashing, secure token management.\n*   **Data Interception in Transit:** Data (e.g., audio segments, metadata) could be intercepted during transmission between frontend and backend.\n    *   **Mitigation:** Mandatory HTTPS/TLS for all communication.\n*   **Unauthorized Data Export/Sharing:** User stories could be shared publicly or exported without explicit consent.\n    *   **Mitigation:** Strict GDPR-compliant consent flows (2290) for all export and public sharing features (2293, 2295).\n*   **Compromise of API Keys:** Sensitive LLM API keys could be exposed, leading to unauthorized service usage or data breaches.\n    *   **Mitigation:** Secure API key management using environment variables (2297).\n*   **Malicious Microphone Access:** Unauthorized access to a user's microphone.\n    *   **Mitigation:** Reliance on browser's secure permission model for MediaRecorder API (2300).\n\n**Required Security Controls and Mitigations:**\n*   **Authentication & Authorization:** Implement JWT or similar token-based authentication for user sessions (2285). Implement role-based access control for future admin/partner functionalities (2303).\n*   **Data Storage:** Local-first storage (IndexedDB/localStorage) for critical story data (2289). Backend database stores only necessary user and story metadata (2291).\n*   **Data in Transit:** Enforce HTTPS/TLS across all client-server and inter-service communication.\n*   **Consent Management:** Implement clear, explicit, opt-in consent UI for sharing and export actions (2290, 2293, 2295).\n*   **Secure Coding:** Adhere to OWASP Top 10 guidelines for web application security.\n*   **CORS Configuration:** Properly configure CORS headers on the backend to restrict access to authorized origins (2299).\n*   **Environment Variables:** Utilize environment variables for all sensitive configurations and API keys (2297).\n\n**Shared Responsibility Model Definition:**\n*   **User:** Responsible for device security, granting microphone permissions, and explicit consent decisions.\n*   **Storycatcher II Application:** Responsible for secure application development, authentication, API key management, GDPR compliance (local-first, consent), data integrity, and secure communication.\n*   **LLM Provider:** Responsible for the security and compliance of their AI service and API.","type":"Architecture"},"majorVersionNumber":1,"minorVersionNumber":1,"patchNumber":1,"projectId":1413,"type":"Architecture"},{"content":{"format":"markdown","type":"DataModel","content":"## Data Model Overview\n\nThe Storycatcher II data model is designed with a \"local-first\" approach for sensitive personal story content, complemented by a backend database for user management, story metadata, and publicly shared narratives. This hybrid architecture prioritizes GDPR compliance by minimizing cloud data exposure for private content while enabling features like user authentication, story organization, and public archiving.\n\nKey entities include `User` (for authentication and preferences), `StoryMetadata` (for managing story details and public sharing status), `StoryTag` (for discoverability and categorization), and `InterviewQuestionLog` (for tracking the AI-guided interview process). Raw audio recordings and their full transcriptions are primarily stored locally on the user's device (e.g., in IndexedDB), with the backend processing these only transiently for AI analysis or for export/public sharing with explicit user consent.\n\nData flows from the frontend, where audio is captured and processed locally. Metadata about the story is then synchronized with the backend database. When a story is consented for public sharing or export, the backend facilitates the necessary transformations and storage of the derived content. The lifecycle of a story involves creation (local and metadata sync), ongoing management (local content, backend metadata), and optional sharing/export, all governed by explicit consent mechanisms.\n\n## Entity-Relationship Diagram\n\n```mermaid\nerDiagram\n    USER ||--o{ STORY_METADATA : \"creates\"\n    STORY_METADATA ||--o{ STORY_TAG : \"has\"\n    STORY_METADATA ||--o{ INTERVIEW_QUESTION_LOG : \"generates\"\n\n    USER {\n        string user_id PK\n        string username\n        string email\n        string password_hash\n        string preferred_language\n        datetime created_at\n        datetime updated_at\n    }\n\n    STORY_METADATA {\n        string story_id PK\n        string user_id FK\n        string title\n        string description\n        boolean is_public\n        string local_story_identifier\n        datetime created_at\n        datetime updated_at\n    }\n\n    STORY_TAG {\n        string tag_id PK\n        string story_id FK\n        string tag_type\n        string tag_value\n    }\n\n    INTERVIEW_QUESTION_LOG {\n        string log_id PK\n        string story_id FK\n        string question_text\n        datetime prompt_timestamp\n        string ai_model_used\n    }\n```\n\n## Entity Specifications\n\n### USER\nRepresents a registered user of the Storycatcher II application.\n*   **user_id**: String, Primary Key. Unique identifier for the user.\n*   **username**: String, Unique, Not Null. User's chosen username for login.\n*   **email**: String, Unique, Not Null. User's email address, used for login and communication.\n*   **password_hash**: String, Not Null. Hashed and salted password for secure authentication.\n*   **preferred_language**: String, Default 'en'. User's selected UI language (e.g., 'en', 'de').\n*   **created_at**: Datetime, Not Null. Timestamp of user registration.\n*   **updated_at**: Datetime, Not Null. Last timestamp of user profile update.\n*   **Business Rules**: Each user must have a unique username and email. Passwords must be securely hashed.\n\n### STORY_METADATA\nStores descriptive information about a story, managed on the backend. The actual audio and transcript content of the story resides primarily on the user's local device.\n*   **story_id**: String, Primary Key. Unique identifier for the story metadata.\n*   **user_id**: String, Foreign Key to USER. Links the story to its creator.\n*   **title**: String, Not Null. User-defined title for the story.\n*   **description**: Text, Optional. A brief summary or description of the story.\n*   **is_public**: Boolean, Default False. Indicates if the user has explicitly consented to make this story public.\n*   **local_story_identifier**: String, Not Null. A unique identifier generated on the client-side to link this backend metadata record to the full story content stored in the user's local IndexedDB.\n*   **created_at**: Datetime, Not Null. Timestamp when the story metadata was first created.\n*   **updated_at**: Datetime, Not Null. Last timestamp of story metadata update.\n*   **Business Rules**: A story must belong to a user. `is_public` requires explicit user consent.\n\n### STORY_TAG\nRepresents a tag associated with a story, enhancing discoverability and organization.\n*   **tag_id**: String, Primary Key. Unique identifier for the tag entry.\n*   **story_id**: String, Foreign Key to STORY_METADATA. Links the tag to a specific story.\n*   **tag_type**: String, Not Null. Category of the tag (e.g., 'geo', 'temporal', 'dialect', 'general').\n*   **tag_value**: String, Not Null. The actual content of the tag (e.g., 'Berlin', '1990s', 'Bavarian', 'Childhood').\n*   **Business Rules**: Multiple tags can be associated with a single story.\n\n### INTERVIEW_QUESTION_LOG\nLogs the AI-generated questions presented to the user during the interactive story capture process.\n*   **log_id**: String, Primary Key. Unique identifier for the log entry.\n*   **story_id**: String, Foreign Key to STORY_METADATA. Links the question to the story being recorded.\n*   **question_text**: Text, Not Null. The question prompted by the AI assistant.\n*   **prompt_timestamp**: Datetime, Not Null. Timestamp when the question was presented.\n*   **ai_model_used**: String, Optional. Identifier for the AI model that generated the question.\n*   **Business Rules**: Records the sequence of AI interactions for a given story.\n\n## Data Security and Privacy Considerations\n\nThe data model is built with GDPR compliance as a critical priority, emphasizing a local-first approach for sensitive content.\n\n### Data Identification and Classification\n*   **Confidential Data**: Raw audio recordings, full voice-to-text transcriptions, user passwords (hashed), personal story content (before explicit public consent). This data is primarily stored locally on the user's device.\n*   **Internal Data**: User account information (username, email, preferred_language), story metadata (title, description, tags) when `is_public` is false. This data is stored on the backend.\n*   **Public Data**: Story metadata and processed story content (e.g., exported PDF, podcast) that users have explicitly consented to make public (`is_public` is true).\n\n### Analysis of Data Types Stored and Processed\n*   **Personally Identifiable Information (PII)**: User registration details (email, username), and potentially geo-tags or other identifying information within story metadata.\n*   **Sensitive Personal Data**: Voice recordings and their transcriptions contain personal narratives, opinions, and potentially sensitive biographical details. While processed by the backend's local-first STT engine, the raw audio and full transcripts are primarily retained on the user's device.\n\n### Suitable Security Measures\n*   **Authentication**: Robust mechanisms (e.g., password hashing, secure token management) for user accounts.\n*   **Secure API Key Management**: Environment variables for sensitive API keys (e.g., LLM providers).\n*   **Data in Transit**: All communication between frontend and backend uses HTTPS/TLS.\n*   **CORS Configuration**: Strict CORS policies on the backend to prevent unauthorized cross-origin requests.\n*   **Principle of Least Privilege**: Services and components have minimal necessary permissions.\n*   **Secure Coding Practices**: Adherence to OWASP Top 10 guidelines.\n*   **Local Data Protection**: Reliance on browser's IndexedDB security model, which isolates data per origin.\n\n### Special Protection Requirements\n*   **PII Data**:\n    *   **Purpose**: Collected for user identification, personalized experience, and account management (Req 2285).\n    *   **Consent**: User registration implies consent for basic account data processing. Explicit, opt-in consent is mandatory for any story export or publication (Req 2290, 2293, 2295).\n    *   **Retention**: PII is retained as long as the user account exists. Users are provided mechanisms to access, correct, or delete their data (GDPR Right to Erasure/Access).\n*   **Health Care Data**: Not applicable; the system is not designed to collect or process health-related information.\n*   **Payment Data**: Not applicable for the MVP; pricing and subscription management (Req 2304) are future considerations.","reasoning":"This DataModel artifact was AI-generated based on the requirements for Storycatcher II."},"majorVersionNumber":1,"minorVersionNumber":1,"patchNumber":1,"projectId":1413,"type":"DataModel"},{"content":{"reasoning":"This Pages artifact was AI-generated based on the requirements for Storycatcher II.","format":"markdown","type":"Pages","pageList":{"pageNames":["Landing Page","Login Page","Registration Page","My Stories Page","Story Capture Page","Story Detail / Edit Page","Export / Share Options","Public Archive Page","Public Story View Page"]},"content":"## Page Navigation Flow\n\nThe Storycatcher II application guides users through a clear set of pages, facilitating secure access, interactive story capture, and efficient management of personal narratives. The navigation flow emphasizes a user-centric design, allowing seamless transitions between core functionalities while maintaining privacy and data integrity.\n\n```mermaid\ngraph TD\n    subgraph \"Public / Unauthenticated Access\"\n        LP[\"Landing Page\"] --> LGP(\"Login Page\");\n        LP --> RP(\"Registration Page\");\n        LP --> PAP(\"Public Archive Page\");\n    end\n\n    subgraph \"Authenticated User Flow\"\n        LGP --> MSP(\"My Stories Page\");\n        RP --> MSP;\n        MSP --> SCP(\"Story Capture Page\");\n        MSP --> SDSP(\"Story Detail / Edit Page\");\n        MSP --> LGP;\n        SCP --> MSP;\n        SDSP --> MSP;\n        SDSP --> ESOP(\"Export / Share Options\");\n        ESOP --> SDSP;\n        ESOP --> MSP;\n    end\n\n    subgraph \"Public Story Viewing\"\n        PAP --> PSVP(\"Public Story View Page\");\n        PSVP --> PAP;\n    end\n\n    style LP fill:#f0f8ff,stroke:#3178c6,stroke-width:2px\n    style LGP fill:#e0f7fa,stroke:#00796b,stroke-width:2px\n    style RP fill:#e0f7fa,stroke:#00796b,stroke-width:2px\n    style MSP fill:#c8e6c9,stroke:#388e3c,stroke-width:2px\n    style SCP fill:#fff3e0,stroke:#e65100,stroke-width:2px\n    style SDSP fill:#fffde7,stroke:#fbc02d,stroke-width:2px\n    style ESOP fill:#ffe0b2,stroke:#fb8c00,stroke-width:2px\n    style PAP fill:#e3f2fd,stroke:#1e88e5,stroke-width:2px\n    style PSVP fill:#e3f2fd,stroke:#1e88e5,stroke-width:2px\n```\n\n**Overview of Page Hierarchy and User Flow:**\n\nThe application's navigation is structured around two primary states: unauthenticated and authenticated. The `Landing Page` serves as the initial entry point, directing users to `Login`, `Registration`, or the `Public Archive`. Upon successful login or registration, users are directed to the `My Stories Page`, which acts as their personalized dashboard. From `My Stories`, users can initiate `Story Capture`, manage individual stories via the `Story Detail / Edit Page`, or `Logout`. The `Story Capture Page` is an interactive loop for recording and processing audio. The `Story Detail / Edit Page` allows for metadata management and initiates `Export / Share Options`, which includes crucial GDPR consent steps. Publicly shared stories are accessible via the `Public Archive Page` and individual `Public Story View Pages`, which are available to both authenticated and unauthenticated users.\n\n## Page Specifications\n\n### Landing Page\n*   **Purpose**: The initial entry point for the application, providing an overview and directing users to registration, login, or the public archive.\n*   **Target Users**: New users, returning users, public users.\n*   **Key Content**: Application branding, brief description of Storycatcher II's purpose (privacy-centric story capture), calls to action for registration, login, and exploring public stories.\n*   **Actions Available**: \"Register\", \"Log In\", \"Explore Public Archive\".\n*   **Navigation**:\n    *   To `Registration Page` (via \"Register\").\n    *   To `Login Page` (via \"Log In\").\n    *   To `Public Archive Page` (via \"Explore Public Archive\").\n\n### Registration Page\n*   **Purpose**: Allows new users to create an account to access personalized story archiving features (Requirement 2285).\n*   **Target Users**: New users.\n*   **Key Content**: Form fields for username, email, password, password confirmation. Privacy policy link, terms of service checkbox.\n*   **Actions Available**: \"Register Account\", \"Back to Login\".\n*   **Navigation**:\n    *   From `Landing Page`.\n    *   To `My Stories Page` (on successful registration and automatic login).\n    *   To `Login Page`.\n    *   Displays error feedback (Requirement 2298) on failed registration.\n\n### Login Page\n*   **Purpose**: Enables existing users to securely log in to their accounts (Requirement 2285).\n*   **Target Users**: Existing users.\n*   **Key Content**: Form fields for username/email and password. \"Forgot Password\" link (if implemented in future, not explicit MVP req).\n*   **Actions Available**: \"Log In\", \"Register New Account\".\n*   **Navigation**:\n    *   From `Landing Page`.\n    *   From `Registration Page`.\n    *   To `My Stories Page` (on successful login).\n    *   To `Registration Page`.\n    *   Displays error feedback (Requirement 2298) on failed login.\n\n### My Stories Page\n*   **Purpose**: Serves as the user's dashboard for viewing, editing, and managing their personal collection of archived stories (Requirement 2292, 2289).\n*   **Target Users**: Authenticated storytellers.\n*   **Key Content**: List of archived stories (titles, summaries, creation dates), options to sort/filter stories. Displays confirmation for archived stories (part of 2288).\n*   **Actions Available**: \"Start New Story\", \"Select Story\" (to view/edit), \"Logout\".\n*   **Navigation**:\n    *   From `Login Page` or `Registration Page`.\n    *   From `Story Capture Page` (after finalizing a story).\n    *   From `Story Detail / Edit Page`.\n    *   To `Story Capture Page`.\n    *   To `Story Detail / Edit Page`.\n    *   To `Login Page` (on logout).\n    *   Supports offline-first display of stories (Requirement 2289).\n\n### Story Capture Page\n*   **Purpose**: Provides the interactive interface for recording audio segments, displaying AI-guided questions, and showing transcription/analysis (Requirement 2288).\n*   **Target Users**: Authenticated storytellers.\n*   **Key Content**: Microphone access prompt/status (Requirement 2300), recording controls (start, stop, pause), real-time or near real-time transcript display (Requirement 2287), AI-generated guiding questions (Requirement 2286), summary of current segment. UI states for idle, recording, processing, showing analysis (Requirement 2288).\n*   **Actions Available**: \"Start Recording\", \"Stop Recording Segment\", \"Continue Recording\", \"Finalize Story\".\n*   **Navigation**:\n    *   From `My Stories Page`.\n    *   To `My Stories Page` (on finalizing story).\n    *   Displays robust error handling and UI feedback for microphone access or processing issues (Requirement 2298).\n\n### Story Detail / Edit Page\n*   **Purpose**: Allows users to view the full transcript and summary of a specific story, edit its metadata, and initiate export or sharing (Requirement 2292, 2291, 2293).\n*   **Target Users**: Authenticated storytellers.\n*   **Key Content**: Full story transcript, detailed summary, editable metadata fields (geo-tagging, temporal, dialect, general tags - Requirement 2291), story playback controls.\n*   **Actions Available**: \"Edit Metadata\", \"Save Changes\", \"Cancel Edit\", \"Export Story\", \"Share Story\", \"Delete Story\".\n*   **Navigation**:\n    *   From `My Stories Page`.\n    *   To `My Stories Page`.\n    *   To `Export / Share Options` (on selecting export/share).\n\n### Export / Share Options\n*   **Purpose**: Presents options for exporting a story in various formats (PDF, Podcast, Timeline) and managing explicit consent for public sharing (Requirement 2293, 2290).\n*   **Target Users**: Authenticated storytellers.\n*   **Key Content**: Checkboxes/radio buttons for export formats (PDF, Podcast, Timeline). Clear GDPR consent form for public sharing, including opt-in confirmation (Requirement 2290).\n*   **Actions Available**: \"Select Format\", \"Grant Consent for Public Sharing\", \"Confirm Export/Share\", \"Cancel\".\n*   **Navigation**:\n    *   From `Story Detail / Edit Page`.\n    *   To `Story Detail / Edit Page`.\n    *   To `My Stories Page` (after successful export/share confirmation).\n\n### Public Archive Page\n*   **Purpose**: Allows public users to browse and explore stories that have been explicitly consented for public sharing (Requirement 2295).\n*   **Target Users**: Public users, authenticated users.\n*   **Key Content**: Browseable list of publicly available stories, including titles, authors, summaries, and potentially metadata tags. Search and filter options.\n*   **Actions Available**: \"Select Story\" (to view details).\n*   **Navigation**:\n    *   From `Landing Page`.\n    *   To `Public Story View Page`.\n    *   To `Login Page` / `Registration Page`.\n\n### Public Story View Page\n*   **Purpose**: Displays the full content of a single story that has been explicitly consented for public viewing (Requirement 2295).\n*   **Target Users**: Public users, authenticated users.\n*   **Key Content**: Full story transcript, summary, associated public metadata, author (if shared). No editing or export options.\n*   **Actions Available**: \"Back to Public Archive\".\n*   **Navigation**:\n    *   From `Public Archive Page`.\n    *   To `Public Archive Page`."},"majorVersionNumber":1,"minorVersionNumber":1,"patchNumber":1,"projectId":1413,"type":"Pages"},{"content":{"reasoning":"This Design artifact was AI-generated based on the requirements for Storycatcher II.","format":"markdown","type":"Design","content":"## Design System Overview\n\nStorycatcher II's design philosophy centers on privacy, intuition, and accessibility. The interface will be clean, guided, and trustworthy, reflecting the application's commitment to local-first data handling and GDPR compliance (Requirements 2289, 2290). The design aims for a user-friendly and efficient experience, empowering users to easily capture and manage personal narratives (Artifact 1, 2).\n\nThe design language will be clear and unobtrusive, prioritizing content and user interaction. It will project reliability and security, essential for a platform handling sensitive personal stories. A modular, component-based architecture (leveraging React.js, Artifact 9) will ensure consistency, reusability, and maintainability across the application. Components will be organized to support efficient development and consistent user experience.\n\n## Visual Design Elements\n\nA color palette will be defined to convey trust and clarity, using a limited set of primary and accent colors. Neutral tones will dominate for readability, with strategic use of accent colors to highlight interactive elements and feedback (e.g., success, error states, Requirement 2298).\n\nA clear and readable typography system will be established, with distinct hierarchies for titles, headings, body text, and UI labels. This ensures content legibility and guides user attention. A consistent spacing system and a responsive grid will be used to ensure visual balance, readability, and adaptability across various screen sizes, supporting intuitive layout of information and components.\n\nA set of clear, intuitive icons will be designed or selected to represent actions (e.g., record, stop, save, share) and content types, enhancing usability and reducing cognitive load (e.g., for story management, Requirement 2292; export/sharing, Requirement 2293).\n\n## Component Library\n\n### UI component specifications and variations\n*   **Authentication Forms**: Input fields, buttons, and validation messages for user registration and login (Requirement 2285).\n*   **Audio Recording Controls**: Buttons for start, stop, pause, and indicators for recording status and duration (Requirements 2288, 2300).\n*   **Text Displays**: Areas for displaying real-time voice-to-text transcripts, AI-generated summaries, and guiding questions (Requirement 2288).\n*   **Story List/Grid Views**: Components for displaying archived stories with metadata (title, tags) (Requirement 2292).\n*   **Story Detail/Edit Forms**: Input fields for editing story title, description, and applying metadata tags (geo-tagging, temporal, dialect, general tags) (Requirements 2291, 2292).\n*   **Export/Share Options**: Checkboxes, dropdowns, and buttons for selecting export formats (PDF, Podcast, Timeline) and managing sharing consent (Requirements 2293, 2290).\n*   **Language Selector**: A component for switching UI languages (German/English) (Requirement 2294).\n*   **Consent Dialogs**: Explicit opt-in prompts for data handling and public sharing (Requirement 2290).\n\n### Interactive states and behaviors\nComponents will include defined states for idle, hover, active, disabled, loading, and error (Requirements 2288, 2298). Form inputs will include validation feedback.\n\n### Component usage guidelines and best practices\nGuidelines will ensure consistent application of components across the UI, promoting reusability and a unified user experience.\n\n### Accessibility and responsive design considerations\nAll components will be designed to be accessible, supporting keyboard navigation, screen readers, and multilingual content (Requirement 2294). Responsive design principles will ensure optimal display and functionality across diverse devices.\n\n## Design Patterns and Guidelines\n\n### Interaction design patterns and user flows\nUser interactions will follow established flows to provide a predictable and efficient experience. Key flows, such as the `Interactive Story Capture Flow`, will guide the user through recording, processing, and AI interaction (Requirement 2288).\n\n```mermaid\ngraph TD\n    A[\"User - Dashboard\"] --> B[\"Start New Story / Record\"];\n    B --> C{\"Microphone Access Granted?\"};\n    C -- \"No\" --> D[\"Request Microphone Permission\"];\n    D -- \"Granted\" --> E(\"Frontend - Activate MediaRecorder\");\n    D -- \"Denied\" --> F[\"Display Mic Access Error\"];\n    C -- \"Yes\" --> E;\n    E --> G[\"Frontend - Display Recording UI\"];\n\n    subgraph \"Interactive Recording Loop\"\n        G --> H[\"User - Speak into Microphone\"];\n        H --> I[\"Frontend - Capture Audio Segment\"];\n        I --> J[\"User - Stop Recording Segment\"];\n        J --> K(\"Frontend - Send Audio to Backend\");\n        K --> L(\"Backend - Local-First STT Engine\");\n        L --> M(\"Backend - AI Interview Logic\");\n        M --> N[\"Backend - Send Transcript / Analysis / Question\"];\n        N --> O[\"Frontend - Store Data Locally IndexedDB\"];\n        O --> P[\"Frontend - Display Analysis / New Question\"];\n        P --> Q{\"Continue Recording?\"};\n        Q -- \"Yes\" --> G;\n    end\n\n    Q -- \"No / Finalize\" --> R[\"Frontend - Finalize Story\"];\n    R --> S(\"Backend - Story Finalization\");\n    S --> T[\"Frontend - Story Archived Confirmation\"];\n    F --> X[\"User - End Session\"];\n    T --> X;\n```\n\n### Navigation and information architecture principles\nNavigation will be intuitive, allowing users to easily move between primary sections like 'My Stories', 'Public Archive', and the story capture interface. A clear hierarchy will be maintained (Artifact 3 - Story Mapping).\n\n### Form design and data input patterns\nForms for registration (Requirement 2285) and metadata tagging (Requirement 2291) will feature clear labels, input validation, and assistive text to guide users.\n\n### Error handling and feedback mechanisms\nComprehensive error handling (Requirement 2298) will provide clear, immediate feedback for issues such as microphone access denial, API call failures, or processing errors. UI states will gracefully transition, and user-friendly messages will guide recovery or suggest support."},"majorVersionNumber":1,"minorVersionNumber":1,"patchNumber":1,"projectId":1413,"type":"Design"},{"content":{"content":"# API Specification: Storycatcher II\n\n## API Overview\n\nStorycatcher II's API is designed to support a privacy-centric, local-first storytelling application. It provides secure access, AI-guided story capture, and robust story management, with a strong emphasis on GDPR compliance. The backend, built with Node.js/Express.js, serves as an API Gateway and processes sensitive data (audio transcription) on a local-first basis, minimizing external exposure.\n\n**Architecture and Design Principles:**\nThe API follows a RESTful design, enabling client-server communication. A core principle is \"local-first\" data handling (Req 2287, 2289, 2290), where sensitive story content (raw audio, full transcripts) is processed and stored primarily on the user's device. The backend manages user authentication, story metadata, AI guidance, and facilitates consented export/sharing.\n\n**Authentication and Authorization:**\nUser authentication (Req 2285) is handled via JSON Web Tokens (JWT). Upon successful login, a JWT is issued to the client, which must be included in the `Authorization` header (`Bearer <token>`) for all subsequent protected API calls. Authorization for user-specific resources (e.g., `My Stories`) is based on the authenticated user's ID. Public resources (e.g., `Public Archive`) do not require authentication.\n\n**Base URL, Versioning, and Rate Limiting:**\n*   **Base URL**: `https://api.storycatcher.com/v1` (Placeholder for MVP, actual URL will be configured via Docker Compose - Req 2296, 2299).\n*   **Versioning**: `v1` (Initial version, indicated in the base URL).\n*   **Rate Limiting**: Not implemented for MVP. Future considerations will include rate limiting to prevent abuse and ensure performance (Req 2301).\n\n## Endpoint Documentation\n\n### Authentication\n\n#### 1. User Registration\n*   **Endpoint**: `POST /auth/register`\n*   **Description**: Registers a new user account (Req 2285).\n*   **Request Body**:\n    ```json\n    {\n      \"username\": \"string\",\n      \"email\": \"string\",\n      \"password\": \"string\"\n    }\n    ```\n*   **Response**:\n    *   **201 Created**:\n        ```json\n        {\n          \"message\": \"User registered successfully\",\n          \"userId\": \"string\",\n          \"token\": \"string\"\n        }\n        ```\n    *   **400 Bad Request**: Invalid input (e.g., missing fields, weak password).\n    *   **409 Conflict**: Username or email already exists.\n*   **Example**:\n    ```bash\n    curl -X POST -H \"Content-Type: application/json\" -d '{\"username\": \"testuser\", \"email\": \"test@example.com\", \"password\": \"SecurePassword123!\"}' https://api.storycatcher.com/v1/auth/register\n    ```\n\n#### 2. User Login\n*   **Endpoint**: `POST /auth/login`\n*   **Description**: Authenticates an existing user (Req 2285).\n*   **Request Body**:\n    ```json\n    {\n      \"email\": \"string\",\n      \"password\": \"string\"\n    }\n    ```\n*   **Response**:\n    *   **200 OK**:\n        ```json\n        {\n          \"message\": \"Login successful\",\n          \"userId\": \"string\",\n          \"token\": \"string\"\n        }\n        ```\n    *   **401 Unauthorized**: Invalid credentials.\n*   **Example**:\n    ```bash\n    curl -X POST -H \"Content-Type: application/json\" -d '{\"email\": \"test@example.com\", \"password\": \"SecurePassword123!\"}' https://api.storycatcher.com/v1/auth/login\n    ```\n\n### Story Processing & Management\n\n#### 3. Process Audio Segment\n*   **Endpoint**: `POST /stories/segment`\n*   **Description**: Receives an audio segment for local-first STT transcription and AI-guided question generation (Req 2287, 2286, 2288).\n*   **Request Body**: `multipart/form-data` containing audio file.\n    *   `audioFile`: Binary audio data (e.g., `audio/wav`, `audio/webm`).\n    *   `storyId`: String (Optional, for existing story context).\n*   **Response**:\n    *   **200 OK**:\n        ```json\n        {\n          \"transcript\": \"string\",\n          \"summary\": \"string\",\n          \"nextQuestion\": \"string\",\n          \"storyId\": \"string\"\n        }\n        ```\n    *   **400 Bad Request**: Invalid audio format or missing data.\n    *   **500 Internal Server Error**: STT or AI processing failure (Req 2298).\n*   **Example**:\n    ```bash\n    curl -X POST -H \"Authorization: Bearer <token>\" -F \"audioFile=@/path/to/audio.wav\" -F \"storyId=existing-story-123\" https://api.storycatcher.com/v1/stories/segment\n    ```\n\n#### 4. Finalize Story\n*   **Endpoint**: `POST /stories/finalize`\n*   **Description**: Marks a story as finalized after interactive capture (Req 2288).\n*   **Request Body**:\n    ```json\n    {\n      \"storyId\": \"string\",\n      \"title\": \"string\",\n      \"description\": \"string\",\n      \"localStoryIdentifier\": \"string\"\n    }\n    ```\n*   **Response**:\n    *   **200 OK**:\n        ```json\n        {\n          \"message\": \"Story finalized and metadata saved\",\n          \"storyId\": \"string\"\n        }\n        ```\n    *   **400 Bad Request**: Missing `storyId` or `localStoryIdentifier`.\n    *   **404 Not Found**: Story not found for the user.\n*   **Example**:\n    ```bash\n    curl -X POST -H \"Authorization: Bearer <token>\" -H \"Content-Type: application/json\" -d '{\"storyId\": \"new-story-abc\", \"title\": \"My Life Story\", \"description\": \"A journey through my childhood.\", \"localStoryIdentifier\": \"indexeddb-id-xyz\"}' https://api.storycatcher.com/v1/stories/finalize\n    ```\n\n#### 5. Get User Stories\n*   **Endpoint**: `GET /stories`\n*   **Description**: Retrieves metadata for all stories belonging to the authenticated user (Req 2292).\n*   **Response**:\n    *   **200 OK**:\n        ```json\n        [\n          {\n            \"storyId\": \"string\",\n            \"title\": \"string\",\n            \"description\": \"string\",\n            \"isPublic\": \"boolean\",\n            \"createdAt\": \"datetime\",\n            \"updatedAt\": \"datetime\",\n            \"tags\": [\n              {\"type\": \"string\", \"value\": \"string\"}\n            ]\n          }\n        ]\n        ```\n    *   **401 Unauthorized**: Missing or invalid token.\n*   **Example**:\n    ```bash\n    curl -X GET -H \"Authorization: Bearer <token>\" https://api.storycatcher.com/v1/stories\n    ```\n\n#### 6. Update Story Metadata\n*   **Endpoint**: `PUT /stories/{story_id}/metadata`\n*   **Description**: Updates metadata for a specific story (Req 2291, 2292).\n*   **Path Parameters**: `story_id` (string) - The ID of the story.\n*   **Request Body**:\n    ```json\n    {\n      \"title\": \"string\",\n      \"description\": \"string\",\n      \"tags\": [\n        {\"type\": \"string\", \"value\": \"string\"}\n      ]\n    }\n    ```\n*   **Response**:\n    *   **200 OK**:\n        ```json\n        {\n          \"message\": \"Story metadata updated successfully\",\n          \"storyId\": \"string\"\n        }\n        ```\n    *   **400 Bad Request**: Invalid input.\n    *   **401 Unauthorized**: Missing or invalid token.\n    *   **403 Forbidden**: User does not own the story.\n    *   **404 Not Found**: Story does not exist.\n*   **Example**:\n    ```bash\n    curl -X PUT -H \"Authorization: Bearer <token>\" -H \"Content-Type: application/json\" -d '{\"title\": \"My Childhood Memories\", \"tags\": [{\"type\": \"temporal\", \"value\": \"1990s\"}, {\"type\": \"general\", \"value\": \"family\"}]}' https://api.storycatcher.com/v1/stories/story-123/metadata\n    ```\n\n#### 7. Export/Share Story\n*   **Endpoint**: `POST /stories/{story_id}/export`\n*   **Description**: Exports a story in a specified format or prepares it for public sharing, requiring explicit consent (Req 2293, 2290).\n*   **Path Parameters**: `story_id` (string) - The ID of the story.\n*   **Request Body**:\n    ```json\n    {\n      \"format\": \"string\",  // e.g., \"PDF\", \"Podcast\", \"Timeline\"\n      \"isPublic\": \"boolean\", // True if user explicitly consents to public sharing\n      \"consentGranted\": \"boolean\" // Must be true if isPublic is true\n    }\n    ```\n*   **Response**:\n    *   **200 OK**:\n        ```json\n        {\n          \"message\": \"Story export/share initiated\",\n          \"downloadUrl\": \"string\" // Optional, for direct downloads\n        }\n        ```\n    *   **400 Bad Request**: Invalid format, missing `consentGranted` for public sharing.\n    *   **401 Unauthorized**: Missing or invalid token.\n    *   **403 Forbidden**: User does not own the story.\n    *   **404 Not Found**: Story does not exist.\n*   **Example**:\n    ```bash\n    curl -X POST -H \"Authorization: Bearer <token>\" -H \"Content-Type: application/json\" -d '{\"format\": \"PDF\", \"isPublic\": true, \"consentGranted\": true}' https://api.storycatcher.com/v1/stories/story-123/export\n    ```\n\n### Public Archive\n\n#### 8. Get Public Stories\n*   **Endpoint**: `GET /public/stories`\n*   **Description**: Retrieves metadata for stories explicitly consented for public viewing (Req 2295).\n*   **Response**:\n    *   **200 OK**:\n        ```json\n        [\n          {\n            \"storyId\": \"string\",\n            \"title\": \"string\",\n            \"description\": \"string\",\n            \"authorUsername\": \"string\",\n            \"createdAt\": \"datetime\",\n            \"tags\": [\n              {\"type\": \"string\", \"value\": \"string\"}\n            ]\n          }\n        ]\n        ```\n*   **Example**:\n    ```bash\n    curl -X GET https://api.storycatcher.com/v1/public/stories\n    ```\n\n#### 9. Get Single Public Story\n*   **Endpoint**: `GET /public/stories/{story_id}`\n*   **Description**: Retrieves the full content of a single public story (Req 2295).\n*   **Path Parameters**: `story_id` (string) - The ID of the public story.\n*   **Response**:\n    *   **200 OK**:\n        ```json\n        {\n          \"storyId\": \"string\",\n          \"title\": \"string\",\n          \"description\": \"string\",\n          \"authorUsername\": \"string\",\n          \"fullTranscript\": \"string\",\n          \"summary\": \"string\",\n          \"createdAt\": \"datetime\",\n          \"tags\": [\n            {\"type\": \"string\", \"value\": \"string\"}\n          ]\n        }\n        ```\n    *   **404 Not Found**: Story does not exist or is not public.\n*   **Example**:\n    ```bash\n    curl -X GET https://api.storycatcher.com/v1/public/stories/public-story-456\n    ```\n\n## Data Models & Security\n\n### Request/Response Object Schemas\n\n**User Credentials (for /auth/register, /auth/login)**\n```json\n{\n  \"username\": { \"type\": \"string\", \"description\": \"User's unique username\" },\n  \"email\": { \"type\": \"string\", \"format\": \"email\", \"description\": \"User's email address\" },\n  \"password\": { \"type\": \"string\", \"minLength\": 8, \"description\": \"User's password\" }\n}\n```\n\n**Token Response**\n```json\n{\n  \"userId\": { \"type\": \"string\", \"description\": \"Unique identifier for the user\" },\n  \"token\": { \"type\": \"string\", \"description\": \"JWT for authentication\" }\n}\n```\n\n**Story Metadata (based on STORY_METADATA entity)**\n```json\n{\n  \"storyId\": { \"type\": \"string\", \"description\": \"Unique ID for the story\" },\n  \"title\": { \"type\": \"string\", \"description\": \"Title of the story\" },\n  \"description\": { \"type\": \"string\", \"description\": \"Brief description of the story\" },\n  \"isPublic\": { \"type\": \"boolean\", \"description\": \"True if story is publicly consented\" },\n  \"localStoryIdentifier\": { \"type\": \"string\", \"description\": \"Client-side identifier for local content\" },\n  \"createdAt\": { \"type\": \"string\", \"format\": \"date-time\", \"description\": \"Creation timestamp\" },\n  \"updatedAt\": { \"type\": \"string\", \"format\": \"date-time\", \"description\": \"Last update timestamp\" },\n  \"tags\": { \"type\": \"array\", \"items\": { \"$ref\": \"#/components/schemas/StoryTag\" } }\n}\n```\n\n**Story Tag (based on STORY_TAG entity)**\n```json\n{\n  \"type\": { \"type\": \"string\", \"description\": \"Category of the tag (e.g., geo, temporal)\" },\n  \"value\": { \"type\": \"string\", \"description\": \"Value of the tag\" }\n}\n```\n\n**Interview Log (based on INTERVIEW_QUESTION_LOG entity)**\n```json\n{\n  \"logId\": { \"type\": \"string\", \"description\": \"Unique ID for the log entry\" },\n  \"storyId\": { \"type\": \"string\", \"description\": \"Associated story ID\" },\n  \"questionText\": { \"type\": \"string\", \"description\": \"AI-generated question\" },\n  \"promptTimestamp\": { \"type\": \"string\", \"format\": \"date-time\", \"description\": \"Timestamp when question was prompted\" },\n  \"aiModelUsed\": { \"type\": \"string\", \"description\": \"Identifier of AI model\" }\n}\n```\n\n### Authentication Mechanisms\n\n*   **JWT (JSON Web Tokens)**: Used for stateless authentication. Tokens are signed by the backend and verified on each protected request. Clients must store tokens securely (e.g., HttpOnly cookies or Web Storage with appropriate security measures).\n\n### Security Headers and CORS Policies\n\n*   **HTTPS/TLS**: All API communications are secured with HTTPS/TLS (Req 2299, Artifact 6).\n*   **CORS (Cross-Origin Resource Sharing)**: The backend is configured with appropriate CORS headers to allow communication only from authorized frontend origins (Req 2299, Artifact 9). This prevents unauthorized cross-origin requests.\n    *   Example CORS configuration (conceptual, implementation specific):\n        ```\n        Access-Control-Allow-Origin: <frontend-origin>\n        Access-Control-Allow-Methods: GET, POST, PUT, DELETE, OPTIONS\n        Access-Control-Allow-Headers: Content-Type, Authorization\n        ```\n*   **Secure API Key Management**: Sensitive API keys for LLM providers are stored using environment variables and `.env` files, never hardcoded or committed to version control (Req 2297, Artifact 9).\n\n## Integration Guidelines\n\n### Client Integration Patterns\n\n*   **RESTful API Calls**: The frontend (React/JavaScript UI) will make standard RESTful HTTP requests to the backend.\n*   **Authentication Flow**:\n    1.  User registers/logs in via `/auth/register` or `/auth/login`.\n    2.  Backend returns a JWT.\n    3.  Frontend stores the JWT securely.\n    4.  For subsequent protected requests, the frontend includes the JWT in the `Authorization: Bearer <token>` header.\n*   **Audio Streaming**: Audio segments are sent as `multipart/form-data` to `/stories/segment` (Req 2288).\n*   **Local Data Sync**: Story metadata (`StoryMetadata`, `StoryTag`, `InterviewQuestionLog`) is synchronized with the backend, while the actual story content (audio, full transcript) remains local on the client (IndexedDB/localStorage - Req 2289).\n\n### Error Handling and Retry Strategies\n\n*   **HTTP Status Codes**: API responses use standard HTTP status codes (e.g., 200 OK, 201 Created, 400 Bad Request, 401 Unauthorized, 403 Forbidden, 404 Not Found, 500 Internal Server Error) (Req 2298).\n*   **JSON Error Responses**: In case of errors, the API returns a JSON object with `message` and optionally `details` fields for clear feedback (Req 2298).\n    ```json\n    {\n      \"error\": \"string\",\n      \"message\": \"string\",\n      \"details\": \"string\"\n    }\n    ```\n*   **Retry Strategy**: For transient errors (e.g., 5xx server errors, network issues), clients should implement an exponential backoff retry strategy to avoid overwhelming the server and improve resilience.\n\n### SDK Recommendations\n\n*   No specific SDKs are recommended for the MVP. Standard HTTP client libraries (e.g., `fetch` API in JavaScript) are sufficient for integration.","type":"API","format":"markdown","reasoning":"This API artifact was AI-generated based on the requirements for Storycatcher II."},"majorVersionNumber":1,"minorVersionNumber":1,"patchNumber":1,"projectId":1413,"type":"API"},{"content":{"content":"## Overview\nPersonas provide an abstraction to formalize the notion of a person using a given application. Note that multiple users can be assigned to the same persona. Technically, a persona is characterized by a collection of tasks which this person performs with the application.\n\nA business role will be generated for each persona to support the Everest platform's permission system.\n\n## Executive Summary\nStorycatcher II's MVP identifies three core personas: **Storyteller**, **Public Viewer**, and **Developer**. The **Storyteller** is the primary user who creates and manages personal narratives. The **Public Viewer** explores publicly shared content. The **Developer** focuses on the application's technical infrastructure. Future phases will introduce **Administrator** and **Business Administrator** roles.\n\nAccess control employs a Role-Based Access Control (RBAC) model, ensuring adherence to the principle of least privilege. Permissions are granularly assigned, with strong emphasis on GDPR compliance and explicit consent for sensitive data operations like public sharing.\n\n```mermaid\ngraph TD\n    A[\"Storycatcher II Users\"]\n    A --> B[\"Storyteller\"];\n    A --> C[\"Public Viewer\"];\n    A --> D[\"Developer\"];\n\n    B -- \"Future Role\" --> E[\"Administrator\"];\n    B -- \"Future Role\" --> F[\"Business Administrator\"];\n```\n\n## Persona Definitions\n\n### Storyteller\n*   **Persona Profile**: An authenticated user dedicated to capturing, managing, and optionally sharing their personal stories. Prioritizes privacy and structured storytelling.\n*   **Key Tasks**: Register/login, record audio with AI guidance, manage personal stories (metadata, offline archiving), export/share stories with consent, manage UI language.\n*   **Business Role Mapping**: `Storycatcher-Storyteller`\n\n### Public Viewer\n*   **Persona Profile**: An unauthenticated user interested in exploring public cultural narratives.\n*   **Key Tasks**: Browse and view publicly consented stories, manage UI language.\n*   **Business Role Mapping**: `Storycatcher-PublicViewer`\n\n### Developer\n*   **Persona Profile**: A technical professional responsible for the application's development, deployment, and maintenance.\n*   **Key Tasks**: Manage containerized development environments, secure API keys, configure CORS, monitor system performance and errors.\n*   **Business Role Mapping**: `Storycatcher-Developer`\n\n## Access Control Matrix\n\n| Persona        | Page Area                  | Read | Write | Execute (Specific Actions)                                                                                                                                                                                                                               | Notes                                                                                                                                                           |\n| :------------- | :------------------------- | :--- | :---- | :--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :------------------------------------------------------------------------------------------------------------------------------------------------------ |\n| **Storyteller** | Public/Auth Pages          | Yes  | Yes   | Register Account, Login, Navigate                                                                                                                                                                                                                      | Access to general app info and authentication.                                                                                                          |\n|                | Private Story Management   | Yes  | Yes   | Start New Story, Select Story, Logout, Edit Story Metadata, Export Story, Share Story, Grant Consent (GDPR), Confirm Export/Share, Delete Story                                                                                                          | Full control over *their own* stories (metadata, content links), requires explicit consent for sharing/export.                                          |\n|                | Story Capture              | Yes  | Yes   | Record Audio, Stop Recording, Continue Recording, Finalize Story, Send Audio for Processing, Receive AI Questions                                                                                                                                      | Interactive loop for story creation. Requires microphone access.                                                                                        |\n|                | Public Story Viewing       | Yes  | -     | Browse Public Stories                                                                                                                                                                                                                                  | Can view stories shared by others.                                                                                                                      |\n| **Public Viewer** | Public/Auth Pages          | Yes  | -     | Navigate                                                                                                                                                                                                                                               | Limited to public information.                                                                                                                          |\n|                | Public Story Viewing       | Yes  | -     | Browse Public Stories                                                                                                                                                                                                                                  | Primary access is to publicly shared stories.                                                                                                           |\n| **Developer**  | Development Environment    | Yes  | Yes   | Configure Containers, Deploy Services, Manage API Keys, Monitor Logs, Troubleshoot                                                                                                                                                                     | Technical access to infrastructure and configurations; no direct end-user UI page access beyond testing.                                              |\n\n## Security & Compliance Integration\n\n*   **Need-to-Know & Least Privilege**: Permissions are strictly limited to necessary functions. Storytellers manage only their own stories. Public Viewers have read-only access to publicly consented content. Developers manage technical infrastructure, not sensitive user data directly.\n*   **Segregation of Duty (SoD)**: For MVP, SoD separates end-user roles (Storyteller, Public Viewer) from the technical Developer role. An individual cannot simultaneously hold an end-user role and the Developer role, preventing unauthorized access to system internals or bypassing user controls. Future Admin/Partner roles (2303) will introduce more granular SoD.\n*   **Audit Trail Requirements**: Critical actions are logged for accountability and compliance (2290). These include:\n    *   User authentication events (login, registration attempts) (2285).\n    *   Story finalization, update, and deletion (2288, 2292).\n    *   Changes to story public status and explicit consent grants (2290, 2293).\n    *   API key management operations (2297).\n*   **GDPR Compliance (2290)**: The access model ensures explicit opt-in consent for any story export or public sharing (2293, 2295). Sensitive content is primarily local-first (2287, 2289), minimizing server-side data exposure and reducing backend access requirements.\n\n## Permission Framework\n\nPermissions are task-based and scoped to ensure granular control.\n\n*   **Application-Wide**:\n    *   `app:multilingualUI`: Access to UI language settings.\n*   **Authentication & User Management**:\n    *   `auth:register`: Create new user accounts.\n    *   `auth:login`: Authenticate and access private features.\n*   **Private Story Management (Own Stories)**:\n    *   `story:createOwn`: Initiate new story capture.\n    *   `story:readOwn`: View own story metadata, transcripts, summaries.\n    *   `story:updateOwn`: Modify own story metadata (e.g., title, tags).\n    *   `story:deleteOwn`: Delete own stories.\n    *   `story:processAudio`: Send audio segments for transcription/AI analysis.\n    *   `story:finalizeOwn`: Mark own story as complete.\n    *   `story:exportOwn`: Export own story in various formats.\n    *   `story:shareOwn`: Set own story as public (requires `data:gdprConsent`).\n*   **Public Story Access**:\n    *   `publicStory:read`: View publicly consented stories.\n*   **Data & Compliance**:\n    *   `data:gdprConsent`: Grant/revoke explicit consent for data operations (e.g., public sharing).\n*   **Developer Operations**:\n    *   `dev:containerManagement`: Manage Docker containers.\n    *   `dev:apiKeyManagement`: Access and manage API keys.\n    *   `dev:corsConfiguration`: Configure Cross-Origin Resource Sharing.\n    *   `dev:systemMonitoring`: Access system logs and performance metrics.\n    *   `dev:codeDeployment`: Deploy application code.\n\n*   **Role Hierarchy**: Not applicable for MVP; roles are distinct.\n*   **Multi-Factor Authentication**: Not required for MVP (2285), but a future consideration for enhanced security.\n\n## Business Role Generation\n\n*   **Role Name**: `Storycatcher-Storyteller`\n    *   **Description**: Authenticated user persona focused on creating, managing, and sharing personal narratives, utilizing AI guidance and offline capabilities.\n    *   **Permission Mappings**: `app:multilingualUI`, `auth:register`, `auth:login`, `story:createOwn`, `story:readOwn`, `story:updateOwn`, `story:deleteOwn`, `story:processAudio`, `story:finalizeOwn`, `story:exportOwn`, `story:shareOwn`, `data:gdprConsent`, `publicStory:read`.\n\n*   **Role Name**: `Storycatcher-PublicViewer`\n    *   **Description**: Unauthenticated persona with read-only access to publicly shared stories within the archive.\n    *   **Permission Mappings**: `app:multilingualUI`, `publicStory:read`.\n\n*   **Role Name**: `Storycatcher-Developer`\n    *   **Description**: Technical persona responsible for the setup, deployment, and operational maintenance of the Storycatcher II application's infrastructure.\n    *   **Permission Mappings**: `dev:containerManagement`, `dev:apiKeyManagement`, `dev:corsConfiguration`, `dev:systemMonitoring`, `dev:codeDeployment`.","format":"markdown","type":"Personas","reasoning":"This Personas artifact was AI-generated based on the requirements for Storycatcher II."},"majorVersionNumber":1,"minorVersionNumber":1,"patchNumber":1,"projectId":1413,"type":"Personas"},{"content":{"format":"markdown","content":"## Data Protection Impact Assessment (DPIA) - Storycatcher II\n\n### Preliminary Assessment\n\n**DPIA Requirement Determination:**\nA Data Protection Impact Assessment (DPIA) is required for Storycatcher II under GDPR Article 35. This is due to the processing of personal data on a large scale, particularly voice recordings and their transcriptions, which can reveal sensitive personal information (e.g., health, political opinions, religious beliefs). The use of local-first storage for raw audio and transcripts, while privacy-enhancing, still entails processing under the controller's responsibility if the application is provided by an organization. The system also involves systematic monitoring (e.g., story metadata, user activity) and potential public disclosure of personal data through explicit consent mechanisms.\n\n**High-Risk Processing Activities:**\n1.  **Voice-to-Text Transcription (Local-First):** Processing of raw audio segments into text transcripts. This involves personal data, potentially including special categories of data (e.g., health information, political opinions) if disclosed by the user.\n2.  **Offline-First Story Archiving:** Long-term local storage of personal audio recordings and their full transcripts on the user's device. While local, the data's sensitivity poses a risk if the device is compromised.\n3.  **GDPR-Compliant Data Handling and Consent:** Implementation of explicit opt-in consent for any story export or publication. This signifies the potential for public disclosure of highly personal narratives.\n4.  **Story Metadata Tagging and Structuring:** Application of rich metadata (geo-tagging, temporal structuring) to stories, which can increase the identifiability of individuals and their stories.\n\n**Legal Basis for Processing:**\n*   **Consent (GDPR Article 6(1)(a) and Article 9(2)(a)):** For the processing of voice recordings and their transcription, and for the optional export or public sharing of stories. Explicit consent is obtained for these activities, especially given the potential for special categories of data.\n*   **Contractual Necessity (GDPR Article 6(1)(b)):** For processing personal data necessary to provide the core Storycatcher II service, such as user account management, personal story management (viewing, editing), and metadata synchronization with the backend.\n\n### Project & Data Processing Description\n\n**Application Purpose and Objectives:**\nStorycatcher II is a JavaScript-based application designed to facilitate the secure and private capture, management, and presentation of personal stories. Its primary purpose is to provide a platform for individuals to digitally archive their personal narratives, emphasizing user experience, robust data privacy, and intelligent assistance (AI-guided interviews, local-first STT).\n\n**Data Processing Activities Mapping:**\n*   **Collection:** Audio recordings from user microphones; user input for story metadata, tags, and account registration (e.g., email, password).\n*   **Processing/Usage:**\n    *   Local voice-to-text transcription of audio segments using local STT engines (Whisper/Vosk).\n    *   Application of rich metadata (geo-tagging, temporal structuring, dialect capture, general tags) to stories.\n    *   User authentication and authorization for access to personal stories and management features.\n    *   Display, editing, and management of personal stories and their associated metadata in the 'My Stories' section.\n    *   AI-guided interview process (processing interview questions, not raw story content).\n    *   Optional export or publication of stories with explicit user consent.\n*   **Storage:**\n    *   **Local (User Device):** Raw audio recordings and their full transcriptions are primarily stored locally using IndexedDB or localStorage.\n    *   **Backend Database (Server):** User account data, `StoryMetadata`, `StoryTag`, and `InterviewQuestionLog` are stored. Raw audio and full transcripts are *only* stored on the backend if explicitly consented for export/public sharing.\n*   **Sharing:** Public sharing of stories or story metadata occurs only with explicit opt-in consent from the user.\n*   **Retention:** Local data (raw audio, full transcripts) is retained until the user explicitly deletes it from their device. Backend data (user accounts, metadata) is retained as long as the user account is active or until the associated story metadata is deleted by the user.\n*   **Deletion:** Users can initiate deletion of their stories and associated data, which triggers deletion from both local storage and the backend database (for metadata or consented shared content).\n\n**Data Flows:**\n\n```mermaid\ngraph LR\n    subgraph \"User Device - Frontend\"\n        A[\"User / Microphone\"] --> B(\"Storycatcher App - UI\");\n        B -- \"Records Audio\" --> C(\"Local Storage - IndexedDB\");\n        C -- \"Audio Segments\" --> D(\"Local STT Engine\");\n        D -- \"Raw Transcript\" --> C;\n        B -- \"User Input\" --> E(\"Story Metadata Editor\");\n    end\n\n    subgraph \"Backend System\"\n        F(\"Backend Server - Node.js\");\n        G(\"PostgreSQL Database\");\n    end\n\n    B -- \"Auth / Metadata Sync\" --> F;\n    F -- \"Store User / Metadata\" --> G;\n    B -- \"Explicit Opt-in\" --> F;\n    F -- \"Consented Story / Metadata\" --> G;\n    style A fill:#f9f,stroke:#333,stroke-width:2px\n    style B fill:#ccf,stroke:#333,stroke-width:2px\n    style C fill:#ccf,stroke:#333,stroke-width:2px\n    style D fill:#ccf,stroke:#333,stroke-width:2px\n    style E fill:#ccf,stroke:#333,stroke-width:2px\n    style F fill:#cff,stroke:#333,stroke-width:2px\n    style G fill:#cff,stroke:#333,stroke-width:2px\n```\n\n**Parties Involved:**\n*   **Controller:** The organization operating Storycatcher II.\n*   **Processors:**\n    *   Backend server (Node.js/Express.js) for user authentication, metadata management, and facilitating consented sharing.\n    *   Cloud hosting provider (for backend infrastructure, not explicitly named but implied).\n    *   LLM providers (if used for AI guidance/summaries, but *not* for core transcription which is local-first).\n*   **Data Subjects:** Users of Storycatcher II, and any individuals whose personal stories are recorded and processed.\n\n### Necessity & Proportionality Assessment\n\n**Necessity of Processing Activities:**\n*   **Voice-to-Text Transcription:** Essential for converting spoken narratives into a manageable, searchable, and editable text format, fulfilling the core purpose of story capture.\n*   **Local-First Storage:** Crucial for maintaining privacy-by-design and GDPR compliance, minimizing server-side data exposure for sensitive content.\n*   **Story Metadata Tagging:** Necessary for organizing, discovering, and enhancing the historical and contextual value of archived stories.\n*   **User Management:** Required for providing a personalized, secure 'My Stories' experience and managing user preferences.\n*   **Explicit Consent for Sharing:** Absolutely necessary to comply with GDPR principles, particularly for public sharing of potentially sensitive personal narratives.\n\n**Proportionality of Data Collection Scope:**\nThe data collection is proportionate to the stated purposes. Raw audio and full transcripts, which are the most sensitive data points, are primarily kept local. The backend only stores metadata and full story content if explicitly consented for sharing. User data collected (e.g., email for authentication) is minimal and necessary for service provision.\n\n**Less Intrusive Alternatives:**\n*   **Manual Transcription:** Not a feasible alternative given the project's objective of automated story capture and efficiency.\n*   **Server-Side STT:** Explicitly rejected in favor of local-first processing to minimize data transfer and exposure, demonstrating a commitment to less intrusive methods where feasible.\n*   **No Metadata/Limited Metadata:** Would significantly reduce the utility and discoverability of stories, hindering the core objective of archiving and structuring narratives.\n\n**Data Retention Periods and Justification:**\n*   **Local Raw Audio and Full Transcripts:** Retained on the user's device until the user explicitly deletes the story. Justification: To provide users with a persistent, private archive of their personal narratives, as per the application's core purpose.\n*   **Backend User Account Data and Story Metadata:** Retained as long as the user account is active or until the associated story metadata is explicitly deleted by the user. Justification: Necessary for user authentication, management of 'My Stories', and to enable consented public access/export functionality.\n*   **Consented Public Stories/Exports:** Retained on the backend indefinitely or until the user requests deletion, based on the explicit consent provided for public availability/export. Justification: To fulfill the user's request for public archiving or export.\n\n### Risk Analysis & Mitigation\n\n| Risk                                    | Likelihood | Severity | Mitigation Measures                                                                                                                                                                                                                                                                                                                              | Responsibility         |\n| :-------------------------------------- | :--------- | :------- | :--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :--------------------- |\n| **Unauthorized Access to Local Data**   | Medium     | High     | **Technical:** Primary data (audio/transcripts) is local, reducing server exposure. Rely on OS/browser security for device protection. **Organizational:** User education on device security.                                                                                                                                                    | Development, User      |\n| **Unauthorized Access to Backend Data** | Low        | High     | **Technical:** Secure login (password hashing, token-based authentication - JWT). Robust authorization (access restricted to authenticated users). Least privilege principle applied to backend access. HTTPS/TLS for all data in transit. **Organizational:** Regular security audits, access controls for backend infrastructure.                          | Development, Operations |\n| **Accidental Public Exposure**          | Low        | High     | **Technical:** Explicit opt-in consent flows required for any story export or public publication. Clear UI/UX design for sharing options. Default privacy settings. **Organizational:** Strict policy requiring documented consent before sharing.                                                                                                   | Development, Product   |\n| **Data Interception in Transit**        | Low        | Medium   | **Technical:** All communication between frontend and backend uses HTTPS/TLS encryption.                                                                                                                                                                                                                                                 | Development            |\n| **Misuse of Sensitive API Keys**        | Low        | High     | **Technical:** API keys managed securely via environment variables and `.env` files; never hardcoded or committed to version control. **Organizational:** Secure configuration management practices.                                                                                                                                           | Development, Operations |\n| **Lack of Explicit Consent**            | Low        | High     | **Technical:** Mandatory, clear, and unambiguous opt-in consent prompts for audio recording (browser-managed permissions) and for any data export/publication. Mechanisms to record consent status. **Organizational:** Legal review of consent texts, clear internal policies on consent management.                                          | Development, Legal     |\n| **Inadequate Data Deletion**            | Low        | High     | **Technical:** Implement robust and tested deletion mechanisms for both local (IndexedDB/localStorage) and backend (PostgreSQL) data upon user request, ensuring all associated data is removed. **Organizational:** Defined data retention and deletion policies.                                                                              | Development            |\n\n### Implementation & Review\n\n**Action Plan for Implementing Measures:**\n1.  **Develop & Test Consent Flows:** Implement and rigorously test all explicit opt-in consent flows for microphone access, data processing, and public sharing/export. Ensure consent records are maintained.\n2.  **Secure Backend & APIs:** Implement JWT-based authentication, role-based authorization, and HTTPS/TLS for all API endpoints. Ensure secure API key management using environment variables.\n3.  **Robust Local-First Storage:** Verify the integrity and security of local data persistence (IndexedDB/localStorage) and local STT engine integration.\n4.  **Implement Secure Deletion:** Develop and test functionalities for complete data deletion from both local storage and backend systems upon user request.\n5.  **Security Testing:** Conduct regular security audits, penetration testing, and vulnerability assessments on both frontend and backend components.\n6.  **Developer Training:** Provide ongoing training to development teams on privacy-by-design principles, secure coding practices, and GDPR compliance.\n\n**Monitoring Mechanisms:**\n*   **Access Logs:** Monitor backend API access logs for suspicious activity or unauthorized access attempts.\n*   **Consent Logs:** Maintain an audit trail of user consent actions (granting, withdrawing).\n*   **System Performance Monitoring:** Track system health and performance to detect anomalies that might indicate security incidents.\n*   **Regular Code Reviews:** Incorporate security and privacy checks into the development lifecycle through peer code reviews.\n\n**Review Schedule and Updates:**\n*   **Annual Review:** Conduct a comprehensive DPIA review annually to reassess risks, effectiveness of mitigation measures, and ensure ongoing compliance.\n*   **Event-Driven Review:** The DPIA will be reviewed and updated immediately upon:\n    *   Significant changes to data processing activities (e.g., new data types, new processing purposes).\n    *   Introduction of new features impacting personal data or privacy.\n    *   Changes in regulatory guidance or legal requirements.\n    *   Identification of new risks or security incidents.","reasoning":"This DataProtectionImpactAssessment artifact was AI-generated based on the requirements for Storycatcher II.","type":"DataProtectionImpactAssessment"},"majorVersionNumber":1,"minorVersionNumber":1,"patchNumber":1,"projectId":1413,"type":"DataProtectionImpactAssessment"},{"content":{"format":"markdown","content":"## Security Threat Model: Storycatcher II\n\nThis document outlines the security threat model for Storycatcher II, focusing on identifying potential threats, their associated risks, and proposed mitigation strategies using the STRIDE methodology.\n\n### Application Understanding & Assets\n\nStorycatcher II is a JavaScript-based application for secure, private capture and management of personal stories. It employs a \"local-first\" data strategy for sensitive content, complemented by a backend for user management and metadata.\n\n**Components and Data Flows:**\n\n```mermaid\ngraph LR\n    subgraph \"User Device (Client Trust Boundary)\"\n        A[\"Client - React/JavaScript UI\"] --> B(\"Microphone Access / MediaRecorder API\");\n        A --> C(\"Local Storage - IndexedDB / localStorage\");\n    end\n\n    subgraph \"Backend Services (Server Trust Boundary)\"\n        D(\"API Gateway / Authentication - Node.js\") --> E(\"User Management Service\");\n        D --> F(\"Story Processing Service\");\n        F --> G(\"AI-Guided Interview Logic\");\n        F --> I(\"Story Data Management\");\n    end\n\n    subgraph \"External Integration (External Trust Boundary)\"\n        J(\"LLM Provider API\");\n    end\n\n    A -- \"API Calls (HTTPS/TLS)\" --> D;\n    B -- \"Audio Stream\" --> F;\n    F -- \"Text & Analysis\" --> A;\n    G -- \"Question Generation\" --> J;\n    J -- \"AI Responses\" --> G;\n    I -- \"Store Story Metadata\" --> K(\"Backend Database - PostgreSQL / MongoDB\");\n\n    style A fill:#e0f7fa,stroke:#00796b,stroke-width:2px\n    style B fill:#e0f7fa,stroke:#00796b,stroke-width:2px\n    style C fill:#e0f7fa,stroke:#00796b,stroke-width:2px\n    style D fill:#c8e6c9,stroke:#388e3c,stroke-width:2px\n    style E fill:#c8e6c9,stroke:#388e3c,stroke-width:2px\n    style F fill:#c8e6c9,stroke:#388e3c,stroke-width:2px\n    style G fill:#c8e6c9,stroke:#388e3c,stroke-width:2px\n    style I fill:#c8e6c9,stroke:#388e3c,stroke-width:2px\n    style J fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px\n    style K fill:#fff8e1,stroke:#fbc02d,stroke-width:2px\n```\n\n**Sensitive Data Identified:**\n*   **Personally Identifiable Information (PII):** Usernames, emails, passwords (stored in backend database). Raw audio recordings, full transcripts (primarily local storage, transiently on backend for processing/export with consent).\n*   **Intellectual Property:** User-generated story content (audio, transcripts, summaries).\n*   **System Secrets:** LLM Provider API keys (backend environment variables).\n\n**Security Objectives & Compliance:**\n*   **Confidentiality:** Protect user PII and story content from unauthorized access.\n*   **Integrity:** Prevent unauthorized modification of user data and system configurations.\n*   **Availability:** Ensure system and data access for legitimate users.\n*   **Accountability:** Log user actions, especially related to data sharing.\n*   **GDPR Compliance:** Critical for local data storage for MVP, explicit opt-in consent for export/publication, and user data management.\n\n**User Interactions and Authentication Points:**\n*   **User Registration (`POST /auth/register`):** Initial account creation.\n*   **User Login (`POST /auth/login`):** Authentication for existing users.\n*   **Story Creation/Management:** Local-first, metadata sync with backend.\n*   **Story Export/Publication:** Requires explicit user consent, involves backend processing.\n*   **Admin/Partner Portal (Future):** Restricted access for content/user management.\n\n### Threat Identification (STRIDE Framework)\n\n| Category             | Threat Description                                                                   | Attack Vector/Scenario                                                                                                                                                                                                                                                          | Affected Component(s)                                                                     |\n| :------------------- | :----------------------------------------------------------------------------------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :---------------------------------------------------------------------------------------- |\n| **S**poofing         | Impersonation of legitimate users.                                                   | Attacker gains access to user credentials (e.g., via phishing, credential stuffing) and logs in as the user.                                                                                                                                                                    | User Management Service, API Gateway                                                      |\n|                      | Impersonation of backend services/LLM provider.                                      | Attacker intercepts/modifies API calls to impersonate backend services or LLM provider, leading to unauthorized data access or malicious responses.                                                                                                                            | API Gateway, LLM Provider API, Story Processing Service                                   |\n| **T**ampering        | Unauthorized modification of user data (e.g., story metadata, consent status).       | Attacker exploits vulnerabilities in API endpoints or database to alter story metadata, sharing consent, or user account details.                                                                                                                                                | Story Data Management, Backend Database, User Management Service                          |\n|                      | Malicious modification of client-side code/data.                                     | Attacker injects malicious scripts (XSS) to modify client behavior, alter locally stored stories, or manipulate API requests. User-side local storage could be tampered with if device is compromised.                                                                        | Client - React/JavaScript UI, Local Storage                                               |\n| **R**epudiation      | Users deny performing actions (e.g., sharing a story publicly).                      | A user shares a story publicly, then claims they did not provide consent or that the action was unauthorized, without sufficient audit trails.                                                                                                                               | Story Data Management, Backend Database                                                   |\n| **I**nformation Disclosure | Unauthorized access to sensitive user data (PII, story content, API keys).           | Attacker exploits vulnerabilities in API endpoints to retrieve user details, story metadata, or unconsented story content. Backend API keys could be exposed if environment variables are improperly handled or configuration files are leaked. Unencrypted data in transit. | Backend Database, Story Processing Service, LLM Provider API, API Gateway, Local Storage  |\n|                      | Disclosure of internal system errors/stack traces.                                   | Poor error handling reveals sensitive system information to attackers (e.g., database schemas, server paths).                                                                                                                                                                | API Gateway, Story Processing Service                                                     |\n| **D**enial of Service | System unavailability due to resource exhaustion or malicious requests.              | Attacker floods API endpoints with requests (DDoS), exhausts server resources, or exploits vulnerabilities causing crashes. Malicious client-side scripts could degrade user experience.                                                                                    | API Gateway, Story Processing Service, Client - React/JavaScript UI                       |\n|                      | Disruption of microphone access or local storage.                                    | Malicious code prevents microphone access or corrupts/deletes local story data, impacting core functionality.                                                                                                                                                               | Microphone Access / MediaRecorder API, Local Storage                                      |\n| **E**levation of Privilege | Unauthorized access to admin/partner functionalities or other users' data.         | Attacker exploits authentication/authorization flaws to bypass access controls, gaining elevated privileges (e.g., admin access, access to other users' private stories, or modifying system-wide settings).                                                                | API Gateway, User Management Service, Story Data Management, Admin/Partner Portal (future) |\n\n### Risk Assessment & Mitigation\n\n| Threat Category         | Identified Threat                                         | Likelihood | Impact | Risk Score | Mitigation                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     ```mermaid\nerDiagram\n    User {\n        string userId PK\n        string username\n        string email\n        string password_hash\n        string security_token\n        string preferred_llm\n        string preferred_language\n    }\n\n    StoryMetadata {\n        string storyId PK\n        string userId FK\n        string title\n        string description\n        string date_created\n        string last_modified\n        bool is_public\n        string public_url\n    }\n\n    StoryTag {\n        string tagId PK\n        string name\n    }\n\n    InterviewQuestionLog {\n        string logId PK\n        string storyId FK\n        string question_text\n        string ai_response\n        string timestamp\n    }\n\n    User ||--o{ StoryMetadata : \"creates\"\n    StoryMetadata ||--o{ StoryTag : \"categorized by\"\n    StoryMetadata ||--o{ InterviewQuestionLog : \"logs questions for\"\n```\n\n### Threat Identification (STRIDE Framework)\n\nThis section details potential threats to Storycatcher II, categorized using the STRIDE framework.\n\n#### Spoofing\n\n*   **User Impersonation:** An attacker could gain unauthorized access to a user's account by compromising their credentials (e.g., via weak passwords, phishing, or credential stuffing attacks). This allows them to log in as the legitimate user, access their story metadata, and potentially initiate public sharing without explicit consent if security controls are bypassed.\n*   **API Impersonation:** A malicious actor could attempt to spoof the backend API or external LLM provider. This might involve redirecting API calls to a rogue server or injecting malicious data, leading to unauthorized actions or data exfiltration.\n\n#### Tampering\n\n*   **Story Metadata Tampering:** An attacker could modify `StoryMetadata` records in the backend database, changing story titles, descriptions, or critically, the `is_public` status without the user's consent. This could lead to unauthorized public exposure of a story intended to be private.\n*   **Local Data Tampering:** If the user's local device is compromised (e.g., via malware or insecure browser extensions), the attacker could tamper with local story content (audio, transcripts in IndexedDB), potentially corrupting or altering the narrative.\n*   **API Request Tampering:** An attacker could intercept and modify API requests (e.g., changing parameters, altering story content during export/sharing) between the client and backend.\n\n#### Repudiation\n\n*   **Unaccounted Story Sharing:** A user could publicly share a story and later deny having done so, claiming their account was compromised or consent was not explicitly given. Without robust logging and audit trails of consent actions, it would be difficult to prove otherwise, impacting GDPR compliance.\n*   **Admin/Partner Action Repudiation:** In the future Admin/Partner Portal, administrators or partners could perform actions (e.g., content moderation, user management) and later deny their involvement if actions are not adequately logged and linked to specific authenticated users.\n\n#### Information Disclosure\n\n*   **Sensitive Data Exposure (Backend):** User PII (username, email, password hashes), story metadata, and potentially transient raw audio/transcripts (during consent-driven processing) could be exposed if the backend database or storage is breached. API keys for LLM providers could be disclosed if not securely managed (e.g., hardcoded, committed to version control).\n*   **Sensitive Data Exposure (In Transit):** If HTTPS/TLS is misconfigured or bypassed, data (user credentials, story metadata, AI analysis results) could be intercepted and read by unauthorized parties during client-backend communication.\n*   **Error Message Disclosure:** Poorly implemented error handling could expose sensitive system details (e.g., database errors, stack traces, internal paths) to attackers, aiding further exploitation.\n*   **Local Data Exposure:** While local-first prioritizes privacy, if the user's device is compromised, locally stored raw audio and transcripts could be directly accessed and exfiltrated.\n\n#### Denial of Service\n\n*   **API Endpoint Flooding:** An attacker could launch a Distributed Denial of Service (DDoS) attack against the backend API endpoints (`/auth/register`, `/auth/login`, etc.), making the service unavailable for legitimate users.\n*   **Resource Exhaustion:** Exploiting vulnerabilities that cause excessive resource consumption (CPU, memory, disk I/O) on the backend could lead to service degradation or crashes.\n*   **Local Storage/Microphone Access Disruption:** Malicious client-side code could attempt to prevent microphone access via the MediaRecorder API or corrupt/delete data in IndexedDB, rendering the core story capture and archiving functionality unusable for the end-user.\n\n#### Elevation of Privilege\n\n*   **Unauthorized Admin/Partner Access:** In the future, an attacker could exploit authentication or authorization flaws to gain access to the restricted Admin/Partner Portal, allowing them to manage content, users, or specific collections with elevated privileges.\n*   **Horizontal Privilege Escalation:** An attacker could exploit flaws to access or modify `StoryMetadata` belonging to other users, bypassing authorization checks intended to restrict access to personal stories.\n\n### Risk Assessment & Mitigation\n\nRisk scores are evaluated based on the likelihood of a threat occurring and its potential impact (High/Medium/Low). Mitigations are directly derived from the provided architecture, security principles, and requirements.\n\n| Threat Category         | Identified Threat                                         | Likelihood | Impact | Risk Score | Mitigation                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ```\nerDiagram\n    User ||--o{ StoryMetadata : \"has\"\n    StoryMetadata ||--o{ InterviewQuestionLog : \"logs\"\n    StoryMetadata ||--o{ PublicStoryArchive : \"publishes\"\n    StoryMetadata ||--o{ Tag : \"tagged with\"\n\n    User {\n        string userId PK\n        string username\n        string email\n        string password_hash\n        string security_token\n        string preferred_llm\n        string preferred_language\n    }\n\n    StoryMetadata {\n        string storyId PK\n        string userId FK\n        string title\n        string description\n        string date_created\n        string last_modified\n        bool is_public\n        string public_url\n    }\n\n    InterviewQuestionLog {\n        string logId PK\n        string storyId FK\n        string question_text\n        string ai_response\n        string timestamp\n    }\n\n    PublicStoryArchive {\n        string archiveId PK\n        string storyId FK\n        string content_summary\n        string publication_date\n    }\n\n    Tag {\n        string tagId PK\n        string name\n    }\n```\n\n### Validation & Integration\n\n*   **Completeness Verification:** The identified threats cover core functionalities like user authentication, data handling (local and backend), API key management, and data sharing, aligning with critical security requirements and GDPR compliance. Future considerations for admin/partner portals have been included.\n*   **Actionable Tasks Translation:** Each mitigation strategy translates directly into actionable development tasks (e.g., implement password hashing, enforce HTTPS, use environment variables, develop explicit consent UI/logic, implement access controls).\n*   **Security Acceptance Criteria:**\n    *   All user authentication flows must use strong hashing (e.g., bcrypt) and token-based mechanisms.\n    *   All API communication must enforce HTTPS/TLS 1.2 or higher.\n    *   Sensitive API keys must be loaded from environment variables and never hardcoded or committed to version control.\n    *   Explicit opt-in consent must be technically enforced and auditable for any story export or public sharing.\n    *   Access to `StoryMetadata` must be strictly limited to the owning `userId` via server-side authorization checks.\n    *   Error messages must be generic and not expose sensitive system information.\n    *   Admin/Partner Portal (future) must implement role-based access control (RBAC) and least privilege principles.\n*   **Review and Update Procedures:** This threat model should be reviewed and updated at key project milestones, especially before major releases, when new features are added (e.g., Admin/Partner Portal), or when significant architectural changes occur. Security code reviews and penetration testing should validate the implemented controls against these identified threats.\n\n### Conclusion\n\nThis threat model provides a foundational understanding of potential security vulnerabilities and outlines proactive mitigation strategies for the `NarrativeEngine` application. By systematically identifying threats across critical components  from user authentication and data storage to API interactions and external integrations  we have established a robust security baseline. The identified threats, coupled with their corresponding mitigations, form the basis for actionable development tasks and define clear security acceptance criteria for the project.\n\nSecurity is an ongoing process, not a one-time activity. The principles and findings within this document will guide secure development practices, influence architectural decisions, and inform testing strategies throughout the application's lifecycle. Regular reviews and updates of this threat model, especially in response to new features, architectural changes, or evolving threat landscapes, will ensure the continued resilience and integrity of `NarrativeEngine`. Adherence to these security measures is paramount to protecting user data, maintaining trust, and ensuring compliance with relevant data protection regulations like GDPR.","type":"SecurityThreatModel","reasoning":"This SecurityThreatModel artifact was AI-generated based on the requirements for Storycatcher II."},"majorVersionNumber":1,"minorVersionNumber":1,"patchNumber":1,"projectId":1413,"type":"SecurityThreatModel"},{"content":{"format":"markdown","reasoning":"This SecurityReview artifact was AI-generated based on the requirements for Storycatcher II.","type":"SecurityReview","content":"# Security and Compliance Analysis: Storycatcher II on Everest Platform\n\n## Management Summary\nThe Storycatcher II would significantly benefit from the Everest Platform's robust security infrastructure. The platform automatically addresses many fundamental security requirements such as data encryption, secure networking, infrastructure security, and compliance with standards like SOC2 Type 2 and GDPR.\n\nKey benefits of hosting on the Everest Platform include:\n- Strong data protection through built-in encryption (at rest and in transit)\n- Secure infrastructure with monitoring, logging, and alerting capabilities\n- Compliance foundation with SOC2 Type 2 and GDPR coverage\n- Secure deployment, operations, and incident response procedures\n\nHowever, several application-specific security requirements need more detailed specification:\n\nMajor gaps:\n- Detailed client-side data protection for local storage\n- Comprehensive application-level audit logging\n- Granular Role-Based Access Control (RBAC) definitions\n- Explicit Segregation of Duty (SoD) analysis for administrative functions\n- Refined consent management flows and data retention policies\n\nThe application specification provides a solid foundation for privacy-by-design and local-first data handling and demonstrates awareness of security's importance for personal data applications. With enhancements to address the identified gaps, the application would leverage the Everest Platform's security capabilities while properly implementing application-specific security requirements.\n\n## Requirements Covered by the Everest Platform\nThe following security and compliance requirements from the specification are fully covered by the Everest Platform:\n\n### Data Encryption\n- Data-at-rest encryption using AES-256 with customer-specific keys for all server-side data (e.g., StoryMetadata, User data).\n- Data-in-transit encryption using TLS 1.2 or higher for all communication between frontend and backend via HTTPS/TLS.\n\n### Infrastructure Security\n- Secure network architecture with strong tenant isolation.\n- Secure infrastructure logging, monitoring, and alerting.\n- Secure configuration management.\n- Secure deployment and operations.\n- Secure incident response and disaster recovery.\n- Penetration testing and vulnerability scanning.\n- Secure software updates and patch management.\n\n### Backup & Recovery\n- Secure backup procedures including encrypted and immutable backups for all server-side data.\n- Comprehensive disaster recovery capabilities.\n\n### Compliance Foundations\n- SOC2 Type 2 compliance.\n- GDPR compliance framework (platform-level).\n- Secure software development lifecycle.\n- Secure AI and machine learning security (for LLM integration infrastructure).\n\n### Secure Session Management\n- Platform-provided secure session handling to prevent session hijacking, supporting the token-based authentication mentioned.\n\n## Requirements Supported by Everest Frameworks (Requiring Specification Details)\nThe following requirements are supported by Everest Platform frameworks but need more detailed specifications:\n\n### Role-Based Access Control (RBAC)\n- **Current specification:** \"Authorization: Access to personal stories and management features is restricted to authenticated users (2292). Public archive viewing (2295) is open to all.\"\n- **Assessment:** The specification outlines two broad access levels: authenticated users and public viewers. This is a basic form of access control but lacks the granularity required for complex applications or future administrative roles. It does not define specific permissions associated with different types of user actions (e.g., creating, editing, deleting stories, managing tags, publishing).\n- **Recommendation:** Define a detailed RBAC matrix. Specify distinct roles (e.g., `StoryOwner`, `PublicViewer`, `SystemAdmin`) and their corresponding permissions for each API endpoint and resource (e.g., `POST /stories` requires `story-create` permission; `GET /stories/{id}` for private stories requires `story-read-own` permission; `GET /public-stories/{id}` requires `public-story-read` permission).\n\n### Audit Logging\n- **Current specification:** The DPIA mentions \"systematic monitoring (e.g., story metadata, user activity).\" No explicit requirements for application-level audit logging are detailed.\n- **Assessment:** While Everest provides infrastructure logging, application-specific audit trails of user actions are crucial for security monitoring, compliance, and incident investigation. The current specification lacks details on what specific user actions should be logged (e.g., login/logout, story creation/modification/deletion, consent changes, story publication), what data points should be included in logs (user ID, action, timestamp, success/failure, affected resource), log retention periods, and log review procedures.\n- **Recommendation:** Implement comprehensive application-level audit logging for all critical user and administrative actions. Define log content, format, retention policy, and establish procedures for regular review and secure storage of these logs, leveraging Everest's logging infrastructure.\n\n### Segregation of Duty (SoD)\n- **Current specification:** No explicit mention of Segregation of Duty requirements.\n- **Assessment:** SoD is not addressed in the provided artifacts. While the initial MVP might not have complex administrative roles, as the application scales or if administrative functions become more critical (e.g., content moderation for public archives, user account management), SoD becomes vital to prevent fraud, errors, or misuse of privileges.\n- **Recommendation:** Conduct an SoD analysis for all critical administrative functions. Define roles and permissions such that no single individual can perform conflicting tasks or complete a critical process end-to-end without oversight. For instance, the ability to publish a story to the public archive might require a separate approval step if content moderation becomes a feature.\n\n### PII Data Handling\n- **Current specification:** \"GDPR-Compliant Data Handling and Consent,\" \"local storage of data for MVP,\" \"explicit opt-in consent flows for any story export or publication.\" DPIA identifies voice-to-text transcription and local archiving as high-risk. Data Model emphasizes \"local-first\" for sensitive content.\n- **Assessment:** Strong awareness of GDPR and PII, with \"local-first\" being a key privacy-by-design principle. Explicit consent for export/publication is a good foundation. However, the specifics of consent management (how consent is captured, stored, and revoked, granularity of consent), detailed data retention policies for both local and server-side data, and data minimization strategies for transient server-side processing are not fully elaborated.\n- **Recommendation:** Detail the consent management system, including an audit trail of consent, mechanisms for users to easily review and revoke consent, and clear communication regarding data sharing with third-party LLM providers. Specify precise data retention and deletion policies for all data types (raw audio, transcripts, metadata, public stories) on both client and server. Implement strict data minimization for server-side transient processing of sensitive data (e.g., immediate deletion of audio/transcripts post-AI analysis).\n\n### Authentication Integration\n- **Current specification:** \"User Authentication (2285): Secure login mechanisms (e.g., password hashing, token-based authentication) protect user accounts.\" API endpoints `/auth/register` and `/auth/login` are defined.\n- **Assessment:** Basic user authentication is outlined. The specification does not include requirements for multi-factor authentication (MFA), single sign-on (SSO), or integration with external identity providers (e.g., OAuth2/OIDC, SAML). While token-based authentication is mentioned, the specifics of token management (e.g., refresh tokens, token revocation) are not detailed.\n- **Recommendation:** Leverage Everest Platform's secure session management capabilities. Implement strong password policies and consider enabling or requiring MFA for all user accounts. Explore integration with standard identity providers (e.g., OAuth2/OIDC) to offer SSO capabilities for improved user experience and security, particularly if targeting enterprise users.\n\n## Identified Gaps and Recommendations\nThe following gaps require additional specification:\n\n### Client-Side Local Storage Security\n- **Gap:** The \"local-first\" strategy for sensitive data (audio, raw transcripts) relies heavily on client-side storage (IndexedDB/localStorage). The specification does not detail how this local data is protected from unauthorized access or tampering if the user's device is compromised.\n- **Recommendation:** Implement client-side encryption for sensitive data stored in IndexedDB using Web Crypto API or similar mechanisms. Consider data integrity checks for locally stored content. Educate users on device security best practices.\n\n### Secure API Key Usage for External Services\n- **Gap:** \"Secure API Key Management\" focuses on backend environment variables. The TechStack diagram shows \"LLM Provider API\" connected to \"AI-Guided Interview Logic\" (backend). However, if any client-side component were to directly interact with external LLM providers, exposing API keys on the client is a significant risk. The current documentation implies backend proxying, but it should be explicitly stated.\n- **Recommendation:** Explicitly confirm and enforce that all interactions with sensitive external APIs (e.g., LLM providers) are proxied through the secure backend. No API keys or sensitive credentials for external services should ever be directly embedded in or accessible from client-side code.\n\n### Input Validation and Output Encoding\n- **Gap:** The provided artifacts do not explicitly mention requirements for input validation on all user-supplied data or output encoding/sanitization for data displayed in the UI. This is critical for preventing common web vulnerabilities like Cross-Site Scripting (XSS), SQL Injection (or NoSQL equivalent), and other injection attacks.\n- **Recommendation:** Implement robust server-side input validation for all API endpoints to ensure data conforms to expected formats and ranges. Apply appropriate output encoding (e.g., HTML entity encoding) for all user-generated content displayed in the React UI to prevent XSS.\n\n### Server-Side Transient Data Enforcement\n- **Gap:** The DPIA mentions \"backend processing these only transiently for AI analysis or or for export/public sharing with explicit user consent.\" The mechanism to ensure this transience (e.g., immediate deletion after use, strict short-term retention policies) is not defined.\n- **Recommendation:** Define and implement clear technical controls and policies to ensure that raw audio recordings and full transcriptions processed on the backend for AI analysis are only stored for the minimum necessary duration (e.g., immediately deleted after transcription and analysis completion). Document secure deletion procedures.\n\n### Granular Consent Management and Transparency\n- **Gap:** While \"explicit opt-in consent\" is stated, the specification lacks details on the granularity of consent (e.g., consent for transcription vs. AI analysis vs. public sharing), the auditability of consent records, and how users are informed about data flows, especially involving LLM providers.\n- **Recommendation:** Implement a granular consent management system that allows users to opt-in/out of specific data processing activities. Maintain an immutable audit log of all consent decisions. Provide clear, user-friendly privacy notices explaining what data is collected, how it's used, who it's shared with (e.g., LLM providers), and how to exercise data subject rights.\n\n## Compliance Frameworks Analysis\n\n### Compliance Frameworks Requested in the Specification\nThe specification suggests the following compliance frameworks as relevant:\n- GDPR\n\n### Compliance Frameworks Covered by the Everest Platform\nThe Everest Platform provides coverage for:\n- SOC2 Type 2 - Fully covered\n- GDPR - Fully covered (platform-level framework)\n- ISO 27001 - Planned (not yet covered)\n\n### Compliance Gap Analysis\n- **GDPR** - The Everest Platform provides a strong foundational framework for GDPR compliance. However, application-specific responsibilities, such as detailed consent management, explicit data retention policies for application data, secure local data handling, and comprehensive audit logging for user actions, require further specification and implementation within Storycatcher II to achieve full end-to-end compliance.\n- **SOC2 Type 2** - Fully covered by the Everest Platform at the infrastructure and platform level. Storycatcher II benefits directly from this.\n- **ISO 27001** - Planned for the Everest Platform. If ISO 27001 certification becomes a requirement for Storycatcher II, the application will need to define and implement specific controls that align with ISO 27001 requirements, beyond what the platform automatically covers, once the platform achieves this certification.\n\n**Recommendation:** Focus on fully implementing the application-specific aspects of GDPR (detailed consent, data minimization, local storage security, data subject rights) to leverage Everest's foundational compliance. Monitor Everest's ISO 27001 roadmap for future alignment if needed.\n\n---\n### Security Architecture Overview\n```mermaid\ngraph LR\n    subgraph \"Everest Platform Trust Boundary\"\n        E[\"Everest Platform Services\"]\n        DB[\"Everest Managed Database\"]\n        AuthSvc[\"Everest Auth Service\"]\n        LogSvc[\"Everest Logging/Monitoring\"]\n    end\n\n    subgraph \"Storycatcher II Backend (Application Responsibility)\"\n        B[\"API Gateway / Authentication\"]\n        UM[\"User Management Service\"]\n        SP[\"Story Processing Service\"]\n        AI[\"AI-Guided Interview Logic\"]\n        SD[\"Story Data Management\"]\n    end\n\n    subgraph \"User Device (Client Trust Boundary)\"\n        C[\"Client - React/JavaScript UI\"]\n        Mic[\"Microphone Access\"]\n        LS[\"Local Storage - IndexedDB / localStorage\"]\n    end\n\n    subgraph \"External Integration (External Trust Boundary)\"\n        LLM[\"LLM Provider API\"]\n    end\n\n    C -- \"HTTPS/TLS\" --> B;\n    Mic -- \"Audio Stream\" --> SP;\n    SP -- \"Text & Analysis\" --> C;\n    AI -- \"Question Generation\" --> LLM;\n    LLM -- \"AI Responses\" --> AI;\n\n    B --> UM;\n    B --> SP;\n    B --> SD;\n    SP --> AI;\n\n    B -- \"Auth Integration\" --> AuthSvc;\n    UM --> DB;\n    SP --> DB;\n    SD --> DB;\n\n    style E fill:#e0e0e0,stroke:#333,stroke-width:2px\n    style DB fill:#e0e0e0,stroke:#333,stroke-width:2px\n    style AuthSvc fill:#e0e0e0,stroke:#333,stroke-width:2px\n    style LogSvc fill:#e0e0e0,stroke:#333,stroke-width:2px\n\n    style B fill:#ccf,stroke:#333,stroke-width:2px\n    style UM fill:#ccf,stroke:#333,stroke-width:2px\n    style SP fill:#ccf,stroke:#333,stroke-width:2px\n    style AI fill:#ccf,stroke:#333,stroke-width:2px\n    style SD fill:#ccf,stroke:#333,stroke-width:2px\n\n    style C fill:#f9f,stroke:#333,stroke-width:2px\n    style Mic fill:#f9f,stroke:#333,stroke-width:2px\n    style LS fill:#f9f,stroke:#333,stroke-width:2px\n\n    style LLM fill:#c0c0c0,stroke:#333,stroke-width:2px\n```\n\n---\n### Compliance Framework Alignment\n```mermaid\ngraph TD\n    A[\"Storycatcher II Requirements\"] --> B(\"GDPR - Data Handling / Consent\");\n    A --> C(\"Secure API Key Management\");\n    A --> D(\"User Authentication / Authorization\");\n    A --> E(\"Voice-to-Text Transcription Local-First\");\n\n    F[\"Everest Platform Coverage\"] --> G(\"SOC2 Type 2 - Fully Covered\");\n    F --> H(\"GDPR - Foundational Coverage\");\n    F --> I(\"ISO 27001 - Planned Coverage\");\n    F --> J(\"Data Encryption - At Rest / In Transit\");\n    F --> K(\"Infrastructure Security / Operations\");\n    F --> L(\"Secure Session Management\");\n\n    B -- \"Requires App-Specific Implementation\" --> B1(\"Detailed Consent Flows\");\n    B -- \"Requires App-Specific Implementation\" --> B2(\"Local Storage Security\");\n    B -- \"Requires App-Specific Implementation\" --> B3(\"Transient Data Policies\");\n    C -- \"Requires App-Specific Policy\" --> C1(\"Backend Proxying of API Calls\");\n    D -- \"Requires App-Specific Definition\" --> D1(\"Granular RBAC\");\n    D -- \"Requires App-Specific Definition\" --> D2(\"Application Audit Logging\");\n    E -- \"App-Specific Control\" --> E1(\"Client-Side Data Protection\");\n\n    H -- \"Supports\" --> B;\n    J -- \"Supports\" --> D;\n    K -- \"Supports\" --> A;\n    L -- \"Supports\" --> D;\n\n    subgraph \"Compliance Gaps & Recommendations\"\n        G1(\"GDPR - App-Specific Details\") --> R1(\"Refine Consent, Retention, Local Security\");\n        G2(\"ISO 27001 - App-Specific Controls\") --> R2(\"Monitor Everest Roadmap, Define App Controls if Needed\");\n    end\n\n    style A fill:#ccf,stroke:#333,stroke-width:2px\n    style B fill:#f9f,stroke:#333,stroke-width:2px\n    style C fill:#f9f,stroke:#333,stroke-width:2px\n    style D fill:#f9f,stroke:#333,stroke-width:2px\n    style E fill:#f9f,stroke:#333,stroke-width:2px\n\n    style F fill:#e0e0e0,stroke:#333,stroke-width:2px\n    style G fill:#e0e0e0,stroke:#333,stroke-width:2px\n    style H fill:#e0e0e0,stroke:#333,stroke-width:2px\n    style I fill:#e0e0e0,stroke:#333,stroke-width:2px\n    style J fill:#e0e0e0,stroke:#333,stroke-width:2px\n    style K fill:#e0e0e0,stroke:#333,stroke-width:2px\n    style L fill:#e0e0e0,stroke:#333,stroke-width:2px\n\n    style B1 fill:#ffc,stroke:#333,stroke-width:2px\n    style B2 fill:#ffc,stroke:#333,stroke-width:2px\n    style B3 fill:#ffc,stroke:#333,stroke-width:2px\n    style C1 fill:#ffc,stroke:#333,stroke-width:2px\n    style D1 fill:#ffc,stroke:#333,stroke-width:2px\n    style D2 fill:#ffc,stroke:#333,stroke-width:2px\n    style E1 fill:#ffc,stroke:#333,stroke-width:2px\n\n    linkStyle 0 stroke:#00a,stroke-width:2px,fill:none;\n    linkStyle 1 stroke:#00a,stroke-width:2px,fill:none;\n    linkStyle 2 stroke:#00a,stroke-width:2px,fill:none;\n    linkStyle 3 stroke:#00a,stroke-width:2px,fill:none;\n    linkStyle 4 stroke:#00a,stroke-width:2px,fill:none;\n    linkStyle 5 stroke:#00a,stroke-width:2px,fill:none;\n    linkStyle 6 stroke:#00a,stroke-width:2px,fill:none;\n    linkStyle 7 stroke:#00a,stroke-width:2px,fill:none;\n    linkStyle 8 stroke:#00a,stroke-width:2px,fill:none;\n    linkStyle 9 stroke:#00a,stroke-width:2px,fill:none;\n    linkStyle 10 stroke:#00a,stroke-width:2px,fill:none;\n    linkStyle 11 stroke:#00a,stroke-width:2px,fill:none;\n    linkStyle 12 stroke:#00a,stroke-width:2px,fill:none;\n    linkStyle 13 stroke:#00a,stroke-width:2px,fill:none;\n    linkStyle 14 stroke:#00a,stroke-width:2px,fill:none;\n    linkStyle 15 stroke:#00a,stroke-width:2px,fill:none;\n    linkStyle 16 stroke:#00a,stroke-width:2px,fill:none;\n```"},"majorVersionNumber":1,"minorVersionNumber":1,"patchNumber":1,"projectId":1413,"type":"SecurityReview"},{"content":{"type":"Automation","content":"## Automation Strategy: Storycatcher II\n\n### Automation Overview\n\nStorycatcher II prioritizes a seamless, private, and intelligent user experience. This automation strategy focuses on transforming repetitive manual tasks and reactive system responses into proactive, intelligent workflows. By leveraging existing AI capabilities and enhancing system feedback mechanisms, we aim to minimize user effort, improve data quality, and ensure strict compliance.\n\n**Summary of Automation Opportunities:**\n1.  **AI-Assisted Metadata Tagging:** Automate the suggestion/generation of story metadata.\n2.  **Automated Contextual UI Feedback:** Provide real-time, intelligent UI state updates and error handling.\n3.  **Automated GDPR Consent Flow:** Streamline and enforce explicit user consent for data sharing.\n4.  **Proactive Offline Data Synchronization:** Ensure seamless background sync of offline content.\n\n**Automation Principles and Approach:**\n*   **User-Centric:** Automate to reduce friction and enhance the user journey, particularly in story capture and management.\n*   **Privacy-First:** Ensure all automation adheres to GDPR principles, especially regarding local data handling and consent.\n*   **Intelligent Augmentation:** Leverage AI to assist users, not replace their control, by suggesting rather than imposing.\n*   **Transparency:** Keep users informed of automated processes and system states.\n*   **Efficiency:** Streamline internal processes (e.g., development environment) to improve productivity.\n\n**Expected Benefits and Impact:**\n*   **Enhanced User Experience:** Smoother interactive loops, clearer feedback, reduced manual data entry.\n*   **Improved Data Quality:** More consistent and comprehensive metadata for stories.\n*   **Guaranteed Compliance:** Automated enforcement of GDPR consent flows.\n*   **Increased Productivity:** For both users (less manual work) and developers (streamlined setup).\n*   **Reduced Errors:** Proactive error handling and validation.\n\n### Automation Opportunities\n\n**1. Opportunity ID: AUTO-001 - AI-Assisted Metadata Tagging**\n*   **Related Requirements:** 2291 (Story Metadata Tagging), 2286 (AI-Guided Interview), 2287 (Voice-to-Text Transcription).\n*   **Type:** UX Optimization / Process Automation\n*   **Current State:** Users manually apply rich metadata (geo-tagging, temporal, dialect, general tags) to stories (2291). This is a post-capture manual step.\n*   **Proposed Automation:** After voice-to-text transcription (2287) and AI analysis (2286) of an audio segment, the AI will automatically suggest relevant metadata tags (e.g., keywords, topics, inferred locations or dates mentioned, potential dialect indicators) based on the transcript. These suggestions will be presented to the user for acceptance, modification, or rejection before final story archiving.\n*   **Impact:** Reduces manual effort for users, improves metadata quality and consistency, enhances future discoverability (2291), and leverages existing AI capabilities more fully.\n\n**2. Opportunity ID: AUTO-002 - Automated Contextual UI Feedback**\n*   **Related Requirements:** 2298 (Robust Error Handling and UI Feedback), 2288 (Interactive Story Capture Loop), 2300 (Microphone Access).\n*   **Type:** UX Optimization\n*   **Current State:** UI states (idle, recording, processing, showing_analysis) must be managed (2288), and error handling (2298) is separate. This implies reactive, potentially generic feedback.\n*   **Proposed Automation:** The frontend will proactively manage and display granular UI states and contextual feedback. During processing (STT, AI analysis), a specific \"Processing audio...\" indicator with progress will be shown. For errors (e.g., microphone access denied, API call failure), the UI will automatically display specific, actionable error messages (e.g., \"Microphone access denied. Please check browser settings.\") and guide the user on next steps (2298).\n*   **Impact:** Significantly improves user experience by providing real-time status and guidance, reduces user frustration, enhances system perceived responsiveness and reliability.\n\n**3. Opportunity ID: AUTO-003 - Automated GDPR Consent Flow**\n*   **Related Requirements:** 2290 (GDPR-Compliant Data Handling and Consent), 2293 (Story Export and Sharing), 2295 (Public Story Archive).\n*   **Type:** Compliance Automation / Process Automation\n*   **Current State:** Explicit opt-in consent is required for any story export or publication (2290, 2293, 2295). This implies a manual step that could be overlooked or implemented inconsistently.\n*   **Proposed Automation:** When a user attempts to export or publicly share a story, the system will automatically present a dedicated, unskippable GDPR consent form. This form will clearly state what data is being shared and for what purpose, requiring explicit user confirmation before proceeding. Backend validation will strictly enforce this consent before processing any sharing/export requests.\n*   **Impact:** Ensures strict legal and GDPR compliance (2290), builds user trust, and standardizes the consent process, reducing potential for human error.\n\n### Implementation Analysis\n\n**1. AUTO-001 - AI-Assisted Metadata Tagging**\n*   **UI/UX Changes:** A dedicated section on the 'Story Detail / Edit Page' (2292) to display suggested tags (e.g., as interactive chips). Users can click to accept, edit, or delete. A \"Generate Tags\" button could be present for manual re-triggering.\n*   **Data Model Updates:** The `Story` entity will need new fields or a structured JSONB field to store suggested tags, potentially with a flag indicating if they are AI-generated or user-confirmed.\n*   **Technical Considerations:** Enhance the `AI-Guided Interview Logic` (2286) to include a Natural Language Processing (NLP) module for keyword extraction, entity recognition (places, dates), and sentiment analysis from the `Transcript Text` (2287). This module would output a set of proposed tags.\n*   **Integration Requirements:** The `Story Processing Service` (F) would route the `Transcript Text` to the enhanced `AI-Guided Interview Logic` (G) for tagging. The generated tags would then be passed to `Story Data Management` (I) for storage and sent to the `Client - React/JavaScript UI` (A) for display.\n\n**2. AUTO-002 - Automated Contextual UI Feedback**\n*   **UI/UX Changes:** Implementation of global loading indicators, progress bars, toast notifications for transient messages (success/warning), and modal dialogs for critical errors requiring user action. Consistent visual language for different states.\n*   **Data Model Updates:** No direct data model changes. This is primarily frontend logic.\n*   **Technical Considerations:** Frontend application (2288, 2298) will utilize a centralized state management library (e.g., Redux, Zustand) to manage application-wide UI states (e.g., `isProcessing`, `hasError`). Interceptors for API calls and event listeners for browser APIs (e.g., MediaRecorder, microphone permissions) will trigger state updates.\n*   **Integration Requirements:** Frontend `Client - React/JavaScript UI` (A) listens to responses from `Backend Services` (D, F) and `Microphone Access` (B).\n\n**3. AUTO-003 - Automated GDPR Consent Flow**\n*   **UI/UX Changes:** A new, distinct UI component (modal or dedicated page) for GDPR consent, triggered automatically upon initiation of export/public sharing. Clear headings, bullet points for data usage, and explicit \"Accept\" / \"Decline\" buttons.\n*   **Data Model Updates:** The `Story` entity (I) will require a boolean field, e.g., `is_publicly_consented: boolean`, defaulting to `false`. User profile might need a timestamp for consent agreement.\n*   **Technical Considerations:** Backend `Story Export and Sharing Capabilities` (2293) and `Public Story Archive and Viewing` (2295) logic must include a mandatory check for the `is_publicly_consented` flag. If `false`, the request is denied, and the frontend is instructed to display the consent form.\n*   **Integration Requirements:** Frontend `Client - React/JavaScript UI` (A) sends requests to `Backend` (F) for export/share. The backend responds with a specific status if consent is missing, prompting the frontend to display the consent UI.\n\n**4. AUTO-004 - Proactive Offline Data Synchronization**\n*   **UI/UX Changes:** A subtle status indicator (e.g., a small icon or text in the header/footer) showing \"Offline changes pending,\" \"Syncing data...\", or \"All changes synced.\" Potentially a brief notification upon successful sync.\n*   **Data Model Updates:** Local storage (IndexedDB 2289) needs to track \"dirty\" records (changes made offline). The backend database (K) needs robust versioning or conflict resolution mechanisms for story segments and metadata.\n*   **Technical Considerations:** Frontend `Offline-First Story Archiving` (2289) will implement a background synchronization service worker that periodically checks for network connectivity and pending local changes. Upon reconnection, it will send incremental updates to the backend. The backend `Story Data Management` (I) must expose endpoints for partial updates and handle potential conflicts.\n*   **Integration Requirements:** Frontend `Local Storage - IndexedDB` (C) communicates with `Backend Story Data Management` (I) via new API endpoints when connectivity is restored.\n\n### Prioritization & Roadmap\n\n```mermaid\ngraph TD\n    subgraph \"Impact vs Effort Matrix\"\n        P1[\"AUTO-002: Automated Contextual UI Feedback\"]:::high-impact-medium-effort;\n        P2[\"AUTO-003: Automated GDPR Consent Flow\"]:::high-impact-medium-effort;\n        P3[\"AUTO-004: Proactive Offline Data Synchronization\"]:::high-impact-high-effort;\n        P4[\"AUTO-001: AI-Assisted Metadata Tagging\"]:::high-impact-high-effort;\n    end\n\n    classDef high-impact-medium-effort fill:#fff8e1,stroke:#fbc02d,stroke-width:2px;\n    classDef high-impact-high-effort fill:#ffcdd2,stroke:#d32f2f,stroke-width:2px;\n```\n\n**Implementation Phases:**\n\n*   **Phase 1: Quick Wins & Foundational (MVP Integration)**\n    *   **Focus:** Core user experience, critical compliance, and immediate usability improvements.\n    *   **Opportunities:**\n        *   **AUTO-002: Automated Contextual UI Feedback:** Essential for a usable and reliable MVP. (High Impact, Medium Effort)\n        *   **AUTO-003: Automated GDPR Consent Flow:** Non-negotiable for GDPR compliance (2290) when implementing export/sharing (2293, 2295). (High Impact, Medium Effort)\n    *   **Dependencies:** Requires core frontend (2288, 2298) and backend API (2293, 2295) functionality in place.\n    *   **Timeline:** Concurrent with initial MVP development, integrated into relevant feature sprints.\n\n*   **Phase 2: Core Enhancements (Post-MVP)**\n    *   **Focus:** Enhancing data integrity and seamless offline experience.\n    *   **Opportunity:**\n        *   **AUTO-004: Proactive Offline Data Synchronization:** Vital for robust offline-first functionality (2289) and ensuring data consistency. (High Impact, High Effort)\n    *   **Dependencies:** Depends on stable offline archiving (2289) and personal story management (2292). Requires careful design of sync logic.\n    *   **Timeline:** Post-MVP, potentially a dedicated sprint or mini-project.\n\n*   **Phase 3: Strategic & Advanced (Future Iterations)**\n    *   **Focus:** Leveraging AI for deeper user assistance and reducing cognitive load.\n    *   **Opportunity:**\n        *   **AUTO-001: AI-Assisted Metadata Tagging:** Significantly enhances story organization and discoverability (2291). (High Impact, High Effort)\n    *   **Dependencies:** Relies on mature Voice-to-Text (2287) and AI-Guided Interview (2286) components. May require further investment in NLP capabilities.\n    *   **Timeline:** After core features are stable and user feedback on metadata entry is gathered.\n\n**Dependencies and Logical Build Order:**\n*   AUTO-002 (UI Feedback) is a cross-cutting concern and should be integrated from the start across all UI components.\n*   AUTO-003 (GDPR Consent) is triggered by export/sharing, so its implementation should align with those features.\n*   AUTO-004 (Offline Sync) builds upon the offline-first archiving foundation (2289).\n*   AUTO-001 (AI Metadata) is an enhancement that can be layered on top of existing STT and AI processing.\n\n**Timeline and Resource Considerations:**\n*   **Phase 1:** Integrated into existing development sprints. Requires strong frontend-backend collaboration.\n*   **Phase 2:** May require dedicated frontend (service worker, IndexedDB management) and backend (sync API, conflict resolution) resources.\n*   **Phase 3:** Will require specialized AI/NLP expertise for model training/tuning and integration into the existing AI pipeline. Potential for iterative improvements over time.","format":"markdown","reasoning":"This Automation artifact was AI-generated based on the requirements for Storycatcher II."},"majorVersionNumber":1,"minorVersionNumber":1,"patchNumber":1,"projectId":1413,"type":"Automation"}],"changeRequests":[{"artifactType":"projectRequirements","changeType":"create","status":"success","data":{"id":null,"content":[{"title":"User Registration and Authentication","description":"The system shall allow new users to register and existing users to log in securely, forming the initial entry point to the application as per the 'Landing Page', 'Login Page', and 'Registration Page' specifications. This is critical for personalized story archiving.","priority":"critical","active":true,"type":"backend","projectId":1335},{"priority":"critical","title":"AI-Guided Interview Assistant","type":"backend","description":"The system shall provide an AI-guided interview process based on the 5W questioning method, facilitating the capture of personal stories. This includes prompting users with relevant questions after audio segments are processed.","active":true,"projectId":1335},{"title":"Voice-to-Text Transcription (Local-First)","projectId":1335,"description":"The system shall perform voice-to-text transcription of recorded audio segments using local-first STT engines (Whisper or Vosk). This is crucial for processing interviews and maintaining GDPR compliance by keeping data on the device.","type":"backend","priority":"critical","active":true},{"description":"The frontend shall implement an interactive loop allowing users to record audio segments, send them for processing, display the analysis (transcript, summary), and receive new guiding questions to continue the interview or finalize the story. UI states (idle, recording, processing, showing_analysis) must be managed.","active":true,"title":"Interactive Story Capture Loop","type":"frontend","projectId":1335,"priority":"critical"},{"active":true,"type":"frontend","title":"Offline-First Story Archiving","description":"The application shall support offline-first functionality for story archiving, utilizing IndexedDB or localStorage for local data persistence. This ensures stories can be captured and managed without constant internet connectivity.","priority":"critical","projectId":1335},{"active":true,"description":"The system shall be fully GDPR-compliant, ensuring local storage of data for MVP and implementing explicit opt-in consent flows for any story export or publication. Data privacy is paramount for user trust.","priority":"critical","projectId":1335,"title":"GDPR-Compliant Data Handling and Consent","type":"security"},{"type":"backend","title":"Story Metadata Tagging and Structuring","active":true,"description":"The system shall enable the application of rich metadata to stories, including geo-tagging, temporal structuring, dialect capture, and general tags. This enhances the discoverability and historical value of the archived stories.","priority":"high","projectId":1335},{"projectId":1335,"description":"Users shall be able to view, edit, and manage their personal collection of archived stories through a dedicated 'My Stories Page' and 'Story Detail / Edit Page'. This includes reviewing transcripts, summaries, and associated metadata.","priority":"high","active":true,"title":"Personal Story Management ('My Stories')","type":"frontend"},{"type":"backend","active":true,"title":"Story Export and Sharing Capabilities","description":"The system shall provide functionality to export and share stories in various formats, including PDF, Podcast, and Timeline. This fulfills the public and private purposes of the digital archive.","priority":"high","projectId":1335},{"projectId":1335,"active":true,"description":"The user interface shall support multiple languages, starting with German and English, with the ability for users to switch languages and persist their preference using local storage. This improves usability for a diverse audience.","priority":"high","type":"frontend","title":"Multilingual User Interface (i18n)"},{"description":"The system shall provide a 'Public Archive Page' and 'Public Story View Page' allowing public users to explore and view stories that have been explicitly consented for public sharing. This supports cultural and historical engagement.","type":"frontend","projectId":1335,"priority":"medium","title":"Public Story Archive and Viewing","active":true},{"title":"Containerized Development Environment","type":"backend","priority":"high","active":true,"projectId":1335,"description":"The project shall utilize Docker and Docker Compose to provide a consistent and easily reproducible development environment for both frontend and backend services. This streamlines setup and deployment."},{"title":"Secure API Key Management","priority":"high","description":"The application shall manage sensitive API keys (e.g., for LLM providers) securely, utilizing environment variables and `.env` files, ensuring they are not hardcoded or committed to version control.","type":"security","active":true,"projectId":1335},{"title":"Robust Error Handling and UI Feedback","type":"frontend","active":true,"projectId":1335,"description":"The system shall implement comprehensive error handling for API calls, microphone access, and other critical operations, providing clear feedback to the user and managing UI state transitions gracefully.","priority":"medium"},{"description":"The backend API shall be configured with appropriate CORS headers to allow communication with the frontend application, especially when running in separate containers or domains during development.","priority":"medium","title":"Cross-Origin Resource Sharing (CORS) Configuration","type":"backend","active":true,"projectId":1335},{"priority":"critical","title":"Microphone Access and Audio Recording","description":"The frontend shall securely request and manage microphone permissions from the user's browser, enabling the capture of audio for story recording using the MediaRecorder API.","active":true,"projectId":1335,"type":"frontend"},{"priority":"medium","type":"backend","description":"The AI-guided interview and voice-to-text transcription processes shall be optimized for performance to ensure minimal latency and a smooth user experience, particularly for real-time interaction.","projectId":1335,"title":"Performance of AI and STT Processing","active":true},{"active":true,"priority":"low","type":"backend","projectId":1335,"title":"Scalability for Future Cloud Deployment","description":"While the MVP is local-only, the system architecture shall consider future scalability to support cloud hosting (e.g., STACKIT/SICOS BW) and a growing number of users and archived stories."},{"active":true,"description":"The system shall eventually include restricted access pages for administrators, content moderators, and institutional partners to manage content, users, and specific collections, ensuring quality control and collaboration.","priority":"low","projectId":1335,"title":"Admin and Partner Portal Functionality","type":"backend"},{"priority":"low","projectId":1335,"description":"The application shall incorporate a 'Pricing & Subscription Page' and related backend logic to manage private archive subscriptions and corporate storytelling packages, supporting the defined business model.","title":"Pricing and Subscription Management","type":"backend","active":true}]},"old":{"id":null,"content":[]},"mode":"ai"},{"artifactType":"Requirement","changeType":"create","status":"success","data":{"content":"## Requirements Overview\n\nStorycatcher II is a digital archiving application designed to capture, preserve, and share personal stories. The system prioritizes user privacy through a local-first, GDPR-compliant approach, while leveraging AI for guided interviews and robust voice-to-text transcription. It aims to provide an intuitive experience for users to record, manage, and optionally share their narratives.\n\n### Requirements Categorization and Priority\n\n| ID    | Type      | Priority  | Description Summary                                          |\n| :---- | :-------- | :-------- | :----------------------------------------------------------- |\n| 2285  | backend   | critical  | User Registration and Authentication                         |\n| 2286  | backend   | critical  | AI-Guided Interview Assistant                                |\n| 2287  | backend   | critical  | Voice-to-Text Transcription (Local-First)                    |\n| 2288  | frontend  | critical  | Interactive Story Capture Loop                               |\n| 2289  | frontend  | critical  | Offline-First Story Archiving                                |\n| 2290  | security  | critical  | GDPR-Compliant Data Handling and Consent                     |\n| 2300  | frontend  | critical  | Microphone Access and Audio Recording                        |\n| 2291  | backend   | high      | Story Metadata Tagging and Structuring                       |\n| 2292  | frontend  | high      | Personal Story Management ('My Stories')                     |\n| 2293  | backend   | high      | Story Export and Sharing Capabilities                        |\n| 2294  | frontend  | high      | Multilingual User Interface (i18n)                           |\n| 2296  | backend   | high      | Containerized Development Environment                        |\n| 2297  | security  | high      | Secure API Key Management                                    |\n| 2295  | frontend  | medium    | Public Story Archive and Viewing                             |\n| 2298  | frontend  | medium    | Robust Error Handling and UI Feedback                        |\n| 2299  | backend   | medium    | Cross-Origin Resource Sharing (CORS) Configuration           |\n| 2301  | backend   | medium    | Performance of AI and STT Processing                         |\n| 2302  | backend   | low       | Scalability for Future Cloud Deployment                      |\n| 2303  | backend   | low       | Admin and Partner Portal Functionality                       |\n| 2304  | backend   | low       | Pricing and Subscription Management                          |\n\n## Functional Requirements\n\n### Core Business Functionality\n*   **User Registration and Authentication (2285):** The system shall enable secure user registration and login, serving as the primary access point for personalized story archiving.\n*   **AI-Guided Interview Assistant (2286):** The system shall provide an AI-driven interview process, utilizing the 5W questioning method to prompt users based on processed audio segments, facilitating story capture.\n*   **Voice-to-Text Transcription (2287):** The system shall perform voice-to-text transcription of audio using local-first STT engines (Whisper/Vosk) to process interviews on-device.\n*   **Story Metadata Tagging and Structuring (2291):** The system shall allow applying rich metadata to stories, including geo-tagging, temporal data, dialect, and general tags, to enhance discoverability.\n*   **Story Export and Sharing Capabilities (2293):** The system shall support exporting and sharing stories in PDF, Podcast, and Timeline formats, enabling both private and public dissemination.\n\n### User Interaction and Interface Requirements\n*   **Interactive Story Capture Loop (2288):** The frontend shall manage UI states (idle, recording, processing, showing_analysis) to facilitate an interactive loop for recording, processing, displaying analysis (transcript, summary), and receiving new guiding questions.\n*   **Personal Story Management ('My Stories') (2292):** Users shall be able to view, edit, and manage their archived stories, including reviewing transcripts, summaries, and metadata, via dedicated pages.\n*   **Public Story Archive and Viewing (2295):** The system shall provide public access pages for exploring and viewing stories explicitly consented for public sharing.\n*   **Microphone Access and Audio Recording (2300):** The frontend shall securely request and manage microphone permissions, enabling audio capture via the MediaRecorder API.\n*   **Multilingual User Interface (i18n) (2294):** The UI shall support multiple languages (German, English initially), allowing users to switch and persist their language preference.\n\n### Data Processing and Management Requirements\n*   **Offline-First Story Archiving (2289):** The application shall support offline functionality for story archiving using IndexedDB or localStorage for local data persistence.\n\n### Integration and Workflow Requirements\n*   **Admin and Partner Portal Functionality (2303):** (Future) The system shall include restricted access pages for administrators, content moderators, and institutional partners for content and user management.\n*   **Pricing and Subscription Management (2304):** (Future) The application shall incorporate a 'Pricing & Subscription Page' and backend logic for managing subscriptions.\n\n## Non-Functional Requirements\n\n### Performance and Scalability Requirements\n*   **Performance of AI and STT Processing (2301):** AI-guided interview and voice-to-text processes shall be optimized for minimal latency and a smooth user experience.\n*   **Scalability for Future Cloud Deployment (2302):** The system architecture shall consider future scalability for cloud hosting and a growing user base.\n\n### Security and Compliance Requirements\n*   **GDPR-Compliant Data Handling and Consent (2290):** (Detailed in separate section)\n*   **Secure API Key Management (2297):** (Detailed in separate section)\n\n### Usability and Reliability Requirements\n*   **Robust Error Handling and UI Feedback (2298):** The system shall implement comprehensive error handling for API calls and microphone access, providing clear user feedback.\n*   **Containerized Development Environment (2296):** Docker and Docker Compose shall be used to provide a consistent and reproducible development environment.\n*   **Cross-Origin Resource Sharing (CORS) Configuration (2299):** The backend API shall be configured with appropriate CORS headers to allow frontend communication.\n\n## Requirements Analysis\n\n### Mermaid Diagram Showing Requirement Relationships\n\n```mermaid\ngraph TD\n    A[\"2285 - User Auth\"] --> B[\"2288 - Interactive Capture Loop\"];\n    B --> C[\"2300 - Microphone Access\"];\n    C --> D[\"2287 - Voice-to-Text\"];\n    D --> E[\"2286 - AI-Guided Interview\"];\n    E --> B;\n    D --> F[\"2291 - Story Metadata Tagging\"];\n    F --> G[\"2292 - My Stories\"];\n    E --> G;\n    G --> H[\"2293 - Story Export/Sharing\"];\n    H --> I[\"2295 - Public Archive\"];\n    J[\"2290 - GDPR Compliance\"] --\"Impacts\"--> A;\n    J --\"Impacts\"--> D;\n    J --\"Impacts\"--> G;\n    J --\"Impacts\"--> H;\n    J --\"Impacts\"--> I;\n    K[\"2289 - Offline-First Archiving\"] --\"Supports\"--> G;\n    L[\"2297 - Secure API Key Management\"] --\"Supports\"--> E;\n    M[\"2301 - AI/STT Performance\"] --\"Optimizes\"--> D;\n    M --\"Optimizes\"--> E;\n    N[\"2298 - Error Handling\"] --\"Improves\"--> B;\n    N --\"Improves\"--> G;\n    O[\"2294 - Multilingual UI\"] --\"Enhances\"--> B;\n    O --\"Enhances\"--> G;\n    O --\"Enhances\"--> I;\n    P[\"2296 - Containerized Dev\"] --\"Facilitates\"--> A;\n    P --\"Facilitates\"--> D;\n    P --\"Facilitates\"--> L;\n    Q[\"2299 - CORS Config\"] --\"Enables\"--> A;\n    Q --\"Enables\"--> D;\n    R[\"2302 - Scalability\"] --\"Future\"--> A;\n    R --\"Future\"--> G;\n    S[\"2303 - Admin Portal\"] --\"Future\"--> G;\n    T[\"2304 - Pricing/Subscription\"] --\"Future\"--> A;\n```\n\n### Priority Matrix and Acceptance Criteria\n\n**Priority Matrix:** Requirements are categorized into Critical, High, Medium, and Low priorities. Critical requirements are essential for the MVP and core functionality. High priority items are vital for a complete and robust user experience. Medium priority items enhance usability and prepare for future growth, while Low priority items are future considerations for later phases.\n\n**Acceptance Criteria:** For each requirement, acceptance will be based on:\n*   **Functional Completeness:** All specified features are implemented and operate as described.\n*   **Performance:** The system meets defined performance benchmarks, particularly for AI/STT processing.\n*   **Security:** Adherence to all security protocols, including secure data handling and API key management.\n*   **Compliance:** Full compliance with GDPR regulations regarding data privacy and consent.\n*   **Usability:** The UI is intuitive, responsive, and provides clear feedback, supporting multilingual preferences.\n*   **Reliability:** The system handles errors gracefully and maintains data integrity, especially in offline scenarios.\n\n## Security & Compliance Requirements\n\n### Security Requirements\n*   **Secure User Registration and Authentication (2285):** Implement robust authentication mechanisms (e.g., password hashing, secure token management) to protect user accounts from unauthorized access.\n*   **Secure API Key Management (2297):** All sensitive API keys for external services (e.g., LLM providers) must be stored and accessed securely using environment variables or a secrets management system, preventing hardcoding or inclusion in version control.\n*   **Secure Microphone Access (2300):** Microphone access must be requested explicitly from the user and managed securely by the browser, adhering to standard web security practices.\n*   **Data Integrity and Confidentiality:** Ensure data stored locally (IndexedDB/localStorage) is protected from unauthorized access or tampering, though explicit encryption is not specified for MVP.\n\n### Compliance Frameworks and Regulations\n*   **GDPR (General Data Protection Regulation) (2290):** The system must be fully compliant with GDPR, specifically:\n    *   **Data Minimization:** Only collect data necessary for core functionality.\n    *   **Local Data Storage:** For MVP, user story data must be stored locally on the user's device.\n    *   **Explicit Consent:** For any story export or publication to a public archive, explicit, opt-in consent from the user is mandatory.\n    *   **Right to Erasure/Access:** Users must have clear mechanisms to access, correct, or delete their personal data.\n\n### Best Practice Implementation Guidelines\n*   **Principle of Least Privilege:** Components and services should only have the minimum necessary permissions.\n*   **Secure Coding Practices:** Adhere to OWASP Top 10 guidelines for web application security.\n*   **Regular Security Audits:** Conduct periodic security reviews and vulnerability assessments.\n*   **Data Encryption in Transit:** Use HTTPS/TLS for all communication between frontend and backend to protect data during transmission.\n*   **CORS Configuration (2299):** Implement strict CORS policies on the backend to prevent unauthorized cross-origin requests.","id":1840},"old":{"id":null,"content":null},"mode":"ai"},{"artifactType":"ProjectOverview","changeType":"create","status":"success","data":{"id":1841,"content":"# Project Overview: Storycatcher II\n\n## Executive Summary\n\n**Project Name:** Storycatcher II\n\nStorycatcher II is a JavaScript-based application designed to facilitate the secure and private capture, management, and presentation of personal stories. As a second iteration, it emphasizes enhanced user experience, robust data privacy, and intelligent assistance.\n\n**Purpose and Key Objectives:** The primary purpose is to provide a platform for individuals to digitally archive their personal narratives. Key objectives include establishing secure user authentication, implementing an AI-guided interview process based on the 5W method, performing local-first voice-to-text transcription, enabling interactive story capture, ensuring offline-first data archiving, and strictly adhering to GDPR compliance by prioritizing local data handling.\n\n**Target Audience and Expected Outcomes:** The primary target audience comprises individuals seeking a secure and structured way to document their life stories. Future expansion may include cultural institutions or businesses interested in corporate storytelling. Expected outcomes are a user-friendly, private, and efficient tool that empowers users to preserve their heritage and memories digitally.\n\n**Business Value and Success Criteria:** Storycatcher II offers significant business value by addressing the growing demand for digital legacy tools with strong privacy assurances. It facilitates cultural preservation and creates a foundation for potential subscription models for private archiving or corporate packages. Success will be measured by high user engagement in story capture, successful implementation of GDPR-compliant local data storage, accuracy and performance of AI and STT processes, and seamless offline functionality.\n\n## Project Description\n\n**Problem Statement:** Many existing digital storytelling tools either lack structured guidance for narrative capture or compromise user data privacy by relying heavily on cloud-based processing and storage. There is a need for a solution that combines intelligent assistance with a strong commitment to data sovereignty and user control.\n\n**Proposed Solution:** Storycatcher II addresses these challenges by offering an AI-guided interview assistant to structure story capture, utilizing local-first voice-to-text transcription for enhanced privacy, and implementing an offline-first architecture for data persistence on the user's device. This approach ensures a private, guided, and accessible storytelling experience.\n\n**Project Scope:**\n*   **Included:**\n    *   Secure User Registration and Authentication (2285)\n    *   AI-Guided Interview Assistant (2286)\n    *   Voice-to-Text Transcription (Local-First STT) (2287)\n    *   Interactive Story Capture Loop (2288)\n    *   Offline-First Story Archiving (2289)\n    *   GDPR-Compliant Data Handling and Consent (2290)\n    *   Story Metadata Tagging and Structuring (2291)\n    *   Personal Story Management ('My Stories') (2292)\n    *   Story Export and Sharing Capabilities (2293)\n    *   Multilingual User Interface (i18n) (2294)\n    *   Public Story Archive and Viewing (2295) - *Medium Priority*\n    *   Containerized Development Environment (2296)\n    *   Secure API Key Management (2297)\n    *   Robust Error Handling and UI Feedback (2298)\n    *   Cross-Origin Resource Sharing (CORS) Configuration (2299)\n    *   Microphone Access and Audio Recording (2300)\n    *   Performance Optimization for AI and STT Processing (2301)\n*   **Excluded (for MVP, but future considerations):**\n    *   Scalability for Future Cloud Deployment (2302)\n    *   Admin and Partner Portal Functionality (2303)\n    *   Pricing and Subscription Management (2304)\n\n**Key Deliverables:** A fully functional web application providing secure user authentication, an interactive AI-guided story capture process with local-first transcription, offline story archiving, and mechanisms for reviewing, managing, and exporting personal stories, all compliant with GDPR.\n\n**Constraints:** The project is a JavaScript-based web application. A critical constraint is the \"local-first\" approach for sensitive data processing (STT) and storage (archiving), ensuring GDPR compliance by minimizing external data exposure.\n\n## Stakeholders & Context\n\n**Primary Stakeholders and Their Roles:**\n*   **Users:** Individuals who will capture, manage, and share their personal stories. Their needs drive core features like privacy, ease of use, and guided storytelling.\n*   **Project Team:** Developers, designers, and project managers responsible for the design, implementation, and deployment of Storycatcher II.\n*   **Product Owner:** Defines the vision, prioritizes features, and ensures the product aligns with user needs and business objectives.\n*   **Legal/Compliance Team:** Ensures adherence to GDPR and other relevant data privacy regulations.\n\n**Business Context and Market Drivers:** The project operates within a growing market for digital personal archiving and cultural heritage preservation. Key drivers include increasing awareness of data privacy, demand for accessible storytelling tools, and the desire to preserve family histories and personal narratives digitally. The emphasis on \"local-first\" and GDPR compliance addresses significant market concerns regarding data sovereignty.\n\n**High-Level Timeline and Phases:** The project will be developed iteratively, focusing on delivering a Minimum Viable Product (MVP) first, encompassing all critical and high-priority requirements. Subsequent phases will address medium and low-priority features, including scalability for cloud deployment and specialized portals.\n\n## Requirements Overview\n\n**Summary of Functional Requirements:**\n*   **Critical:** User authentication, AI-guided interviews via 5W method, local-first voice-to-text transcription, interactive frontend for story capture, offline-first story archiving, comprehensive GDPR compliance, and secure microphone access. These form the core privacy-centric storytelling experience.\n*   **High:** Rich metadata tagging for stories, dedicated personal story management (view/edit), diverse story export and sharing options, multilingual UI support (German/English), containerized development environment for consistency, and secure API key management. These enhance usability, manageability, and development efficiency.\n*   **Medium:** Public archive for consented stories, robust error handling with clear UI feedback, and proper CORS configuration for API communication, performance optimization for AI/STT. These ensure broader accessibility, stability, and responsiveness.\n*   **Low:** Future considerations include scalability for cloud deployment, administrator/partner portals, and pricing/subscription management, which address long-term growth and business models.\n\n**Non-Functional Requirements:**\n*   **Security & Privacy:** GDPR compliance (2290), secure API key management (2297), secure user authentication (2285), local-first data processing/storage (2287, 2289).\n*   **Performance:** Optimized AI and STT processing for minimal latency (2301).\n*   **Usability:** Multilingual user interface (2294), clear UI feedback and error handling (2298).\n*   **Maintainability & Operability:** Containerized development environment (2296), consideration for future scalability (2302).\n*   **Data Integrity:** Robust data persistence for offline archiving (2289).\n\n**Key Assumptions:**\n*   Users will have modern web browsers capable of supporting necessary APIs (e.g., MediaRecorder, IndexedDB).\n*   Local-first STT engines (Whisper/Vosk) can be integrated efficiently into the backend environment to meet performance and GDPR requirements.\n*   Backend infrastructure (even if private/on-premise) will be available for STT and AI processing.\n\n**Dependencies:**\n*   Frontend depends on secure backend API for authentication, AI guidance, and STT processing.\n*   Backend depends on selected local-first STT engines (Whisper/Vosk) and potentially LLM providers for AI guidance.\n\n## System Architecture\n\n```mermaid\ngraph LR\n    subgraph \"User Device\"\n        A[\"Client - React/JavaScript UI\"] --> B(\"Microphone Access / MediaRecorder API\");\n        A --> C(\"Local Storage - IndexedDB / localStorage\");\n    end\n\n    subgraph \"Backend Services - Node.js\"\n        D(\"API Gateway / Authentication\") --> E(\"User Management Service\");\n        D --> F(\"Story Processing Service\");\n        F --> G(\"AI-Guided Interview Logic\");\n        F --> H(\"Local-First STT Engine - Whisper / Vosk\");\n        F --> I(\"Story Data Management\");\n    end\n\n    subgraph \"External Integration\"\n        J(\"LLM Provider API - for AI Guidance\");\n    end\n\n    A -- \"API Calls\" --> D;\n    B -- \"Audio Stream\" --> F;\n    F -- \"Text & Analysis\" --> A;\n    G -- \"Question Generation\" --> J;\n    J -- \"AI Responses\" --> G;\n    I -- \"Store Story Metadata\" --> K(\"Backend Database - PostgreSQL / MongoDB\");\n\n    style A fill:#e0f7fa,stroke:#00796b,stroke-width:2px\n    style B fill:#e0f7fa,stroke:#00796b,stroke-width:2px\n    style C fill:#e0f7fa,stroke:#00796b,stroke-width:2px\n    style D fill:#c8e6c9,stroke:#388e3c,stroke-width:2px\n    style E fill:#c8e6c9,stroke:#388e3c,stroke-width:2px\n    style F fill:#c8e6c9,stroke:#388e3c,stroke-width:2px\n    style G fill:#c8e6c9,stroke:#388e3c,stroke-width:2px\n    style H fill:#c8e6c9,stroke:#388e3c,stroke-width:2px\n    style I fill:#c8e6c9,stroke:#388e3c,stroke-width:2px\n    style J fill:#fff8e1,stroke:#fbc02d,stroke-width:2px\n    style K fill:#bbdefb,stroke:#1976d2,stroke-width:2px\n```\n\n## Interactive Story Capture Loop\n\n```mermaid\nsequenceDiagram\n    actor User;\n    participant Frontend;\n    participant Backend;\n    participant STT_Engine as \"Local-First STT Engine\";\n    participant AI_Interviewer as \"AI Interviewer\";\n\n    User->>Frontend: \"Start Recording Story\";\n    Frontend->>Frontend: \"Activate Microphone / MediaRecorder\";\n    Frontend->>User: \"Display Recording UI\";\n\n    loop \"Record Audio Segments\"\n        User->>Frontend: \"Speak into Microphone\";\n        Frontend->>Frontend: \"Capture Audio Segment\";\n        User->>Frontend: \"Stop Recording Segment\";\n        Frontend->>Backend: \"Send Audio Segment for Processing\";\n        Backend->>STT_Engine: \"Request Transcription of Audio\";\n        STT_Engine-->>Backend: \"Return Transcript Text\";\n        Backend->>AI_Interviewer: \"Analyze Transcript / Generate Questions (5W)\";\n        AI_Interviewer-->>Backend: \"Return Analysis and Next Question\";\n        Backend-->>Frontend: \"Send Transcript, Summary, New Question\";\n        Frontend->>Frontend: \"Store Transcript / Summary Locally (IndexedDB)\";\n        Frontend->>User: \"Display Analysis and New Question\";\n\n        alt \"User wants to continue\"\n            User->>Frontend: \"Continue Recording\";\n        else \"User wants to finalize\"\n            User->>Frontend: \"Finalize Story\";\n            Frontend->>Backend: \"Request Story Finalization\";\n            Backend-->>Frontend: \"Confirm Story Archived\";\n            Frontend->>User: \"Display 'Story Archived' Confirmation\";\n            break;\n        end\n    end\n```\n\n## Success Metrics & Risks\n\n**How Success Will Be Measured:**\n*   **User Adoption:** Number of registered users and active storytellers.\n*   **Story Capture Rate:** Average number of audio segments and complete stories captured per active user.\n*   **Data Privacy Compliance:** Successful internal and external audits confirming adherence to GDPR, especially regarding local data handling and consent flows.\n*   **System Stability & Performance:** Uptime of backend services, latency of STT and AI processing, and responsiveness of the frontend.\n*   **Offline Functionality:** Successful story capture and management when the device is offline, with seamless synchronization upon reconnection.\n\n**Key Performance Indicators (KPIs):**\n*   Percentage of users completing at least one full story.\n*   Average latency for audio transcription and AI question generation.\n*   STT accuracy rate (word error rate - WER).\n*   Number of support tickets related to data privacy or technical issues.\n*   User retention rate for story archiving.\n\n**Major Risks and Mitigation Strategies:**\n*   **Risk: GDPR Compliance Complexity:** Ensuring full compliance with \"local-first\" data handling and explicit consent can be intricate.\n    *   **Mitigation:** Engage legal counsel early, implement privacy-by-design principles throughout development, develop clear and auditable consent flows for all data processing and sharing.\n*   **Risk: Voice-to-Text Accuracy and Performance:** Local-first STT engines might not match cloud-based accuracy or speed, impacting user experience.\n    *   **Mitigation:** Benchmark multiple local STT engines (Whisper, Vosk) to select the most performant and accurate. Optimize model deployment. Provide clear UI feedback during processing delays.\n*   **Risk: Microphone Access and Browser Compatibility:** Issues with browser permissions or API differences could hinder audio recording.\n    *   **Mitigation:** Implement robust permission handling with clear user prompts. Conduct extensive cross-browser and cross-device testing. Provide fallback mechanisms or clear error messages.\n*   **Risk: User Adoption due to Privacy Concerns:** Despite \"local-first,\" users may still be hesitant to trust a new platform with sensitive personal stories.\n    *   **Mitigation:** Be transparent about data handling practices. Clearly communicate the \"local-first\" and GDPR compliance benefits. Build a strong privacy policy and user trust through consistent reliable performance.\n*   **Risk: Scalability Challenges for Future Cloud Deployment:** While MVP is local-first, future cloud deployment might face architectural hurdles.\n    *   **Mitigation:** Design the backend services with modularity and microservices principles from the outset. Use containerization (Docker) to ensure portability. Plan for future infrastructure scaling (e.g., message queues, load balancing)."},"old":{"content":null,"id":null},"mode":"ai"},{"artifactType":"UserFlows","changeType":"create","status":"success","data":{"id":1842,"content":"## User Flows Overview\n\nThis document outlines the key user journeys within Storycatcher II, a privacy-centric application for capturing and managing personal stories. The purpose of these flows is to visualize the step-by-step interactions between the user and the system, highlighting critical paths, decision points, and system responses. Flows are categorized to provide a clear understanding of core functionalities, user onboarding, and data management processes, all strictly adhering to the requirements outlined in the project artifacts.\n\n## Primary User Journey Flows\n\n### User Registration and Login Flow (Requirement 2285)\nThis flow details the initial entry point for users, allowing new users to register securely and existing users to log in.\n\n```mermaid\ngraph TD\n    A[\"User - Landing Page\"] --> B{\"Has Account?\"};\n    B -- \"No\" --> C[\"Registration Page\"];\n    C --> D{\"Enter Details / Register\"};\n    D --> E(\"Backend - Register User\");\n    E -- \"Success\" --> F[\"Login Page\"];\n    B -- \"Yes\" --> F;\n    F --> G{\"Enter Credentials / Login\"};\n    G --> H(\"Backend - Authenticate User\");\n    H -- \"Success\" --> I[\"Dashboard / My Stories Page\"];\n    H -- \"Failure\" --> F;\n    E -- \"Failure\" --> C;\n```\n\n### Interactive Story Capture Flow (Requirements 2288, 2300, 2287, 2286)\nThis core flow describes how users record audio, receive AI-guided questions, and process story segments, integrating microphone access, local-first STT, and AI assistance.\n\n```mermaid\ngraph TD\n    A[\"User - Dashboard\"] --> B[\"Start New Story / Record\"];\n    B --> C{\"Microphone Access Granted?\"};\n    C -- \"No\" --> D[\"Request Microphone Permission\"];\n    D -- \"Granted\" --> E(\"Frontend - Activate MediaRecorder\");\n    D -- \"Denied\" --> F[\"Display Mic Access Error\"];\n    C -- \"Yes\" --> E;\n    E --> G[\"Frontend - Display Recording UI\"];\n\n    subgraph \"Interactive Recording Loop\"\n        G --> H[\"User - Speak into Microphone\"];\n        H --> I[\"Frontend - Capture Audio Segment\"];\n        I --> J[\"User - Stop Recording Segment\"];\n        J --> K(\"Frontend - Send Audio to Backend\");\n        K --> L(\"Backend - Local-First STT Engine\");\n        L --> M(\"Backend - AI Interview Logic\");\n        M --> N[\"Backend - Send Transcript / Analysis / Question\"];\n        N --> O[\"Frontend - Store Data Locally IndexedDB\"];\n        O --> P[\"Frontend - Display Analysis / New Question\"];\n        P --> Q{\"Continue Recording?\"};\n        Q -- \"Yes\" --> G;\n    end\n\n    Q -- \"No / Finalize\" --> R[\"Frontend - Finalize Story\"];\n    R --> S(\"Backend - Story Finalization\");\n    S --> T[\"Frontend - Story Archived Confirmation\"];\n    F --> X[\"User - End Session\"];\n    T --> X;\n```\n\n## Supporting and Alternative Flows\n\n### Story Management and Export Flow (Requirements 2292, 2291, 2293, 2290)\nThis flow covers users reviewing, editing, adding metadata to, and exporting their archived stories, including the explicit consent step for sharing.\n\n```mermaid\ngraph TD\n    A[\"User - My Stories Page\"] --> B[\"Select Story\"];\n    B --> C[\"Story Detail / Edit Page\"];\n    C --> D{\"Action?\"};\n    D -- \"Edit Metadata\" --> E[\"Edit Metadata Form\"];\n    E --> F(\"Backend - Update Story Metadata\");\n    D -- \"Export / Share\" --> G[\"Export / Share Options\"];\n    G --> H{\"Public Sharing Selected?\"};\n    H -- \"Yes\" --> I[\"Display GDPR Consent Form\"];\n    I --> J{\"User Grants Consent?\"};\n    J -- \"No\" --> K[\"Cancel Export / Back\"];\n    J -- \"Yes\" --> L(\"Backend - Process Export / Share\");\n    H -- \"No\" --> L;\n    L --> M[\"Frontend - Export / Share Confirmation\"];\n    F --> C;\n    K --> G;\n    M --> A;\n```\n\n### Public Story Viewing Flow (Requirement 2295)\nThis flow describes how users can browse and view stories that have been explicitly consented for public sharing.\n\n```mermaid\ngraph LR\n    A[\"User - Public Archive Page\"] --> B[\"Browse Stories\"];\n    B --> C[\"Select Public Story\"];\n    C --> D[\"Public Story View Page\"];\n    D --> E[\"User - End Session\"];\n```\n\n### Error Handling and Feedback Flow (Requirement 2298)\nThis general flow illustrates how the system provides feedback to the user when errors occur, ensuring a robust user experience.\n\n```mermaid\ngraph TD\n    A[\"User Action\"] --> B(\"System Operation\");\n    B -- \"Success\" --> C[\"UI - Display Success\"];\n    B -- \"Failure\" --> D{\"Error Type?\"};\n    D -- \"API Call Failed\" --> E[\"UI - Network Error Message\"];\n    D -- \"Permission Denied\" --> F[\"UI - Permission Required Message\"];\n    D -- \"Processing Error\" --> G[\"UI - Operation Failed Message\"];\n    E --> H[\"UI - Suggest Retry / Contact Support\"];\n    F --> H;\n    G --> H;\n    H --> I[\"User - Acknowledge / Retry\"];\n```\n\n## Flow Analysis and Optimization\n\nThe defined user flows prioritize a secure, private, and intuitive experience. The \"Interactive Story Capture Flow\" is central, leveraging local-first processing (2287) and AI guidance (2286) to minimize latency (2301) and keep sensitive data on the user's device, reinforcing GDPR compliance (2290). Error handling (2298) is integrated across flows to provide clear UI feedback, enhancing usability.\n\nOptimization opportunities include refining the AI-guided interview's question generation for maximum relevance and engagement. The \"Offline-First Story Archiving\" (2289) ensures continuity, but the synchronization process when reconnected should be seamless and non-blocking. The \"Story Export and Sharing Flow\" explicitly incorporates GDPR consent (2290), which is critical for user trust and legal compliance. Accessibility (2294 - Multilingual UI) is considered from the outset, broadening the user base. Each flow directly corresponds to critical and high-priority requirements, ensuring that the MVP delivers core value while maintaining privacy and security."},"old":{"content":null,"id":null},"mode":"ai"},{"artifactType":"UserStories","changeType":"create","status":"success","data":{"content":"## User Stories Overview\n\nThis document outlines the user stories for Storycatcher II, adopting an Agile methodology to incrementally deliver value. User stories, structured as \"As a [user type], I want [functionality] so that [benefit],\" facilitate understanding requirements from a user perspective, guiding development, testing, and prioritization.\n\n### Epic-Level User Stories\n\nMajor features are grouped into the following epics:\n\n*   **User Identity & Security:** Encompasses secure user access, authentication, and fundamental data privacy.\n*   **Core Story Capture:** Focuses on the interactive process of recording, transcribing, and receiving AI-guided questions.\n*   **Story Management & Archiving:** Covers local data persistence, organization, and review of personal narratives.\n*   **Story Dissemination:** Deals with options for exporting and sharing stories, including public access.\n*   **Platform Foundation:** Includes underlying technical requirements for development, performance, and future scalability.\n\n### Story Mapping\n\nThe following diagram illustrates the primary user journey for story capture and management, linking key stages to their supporting requirements.\n\n```mermaid\ngraph TD\n    subgraph \"User Journey: Story Capture & Management\"\n        A[\"User Access\"] --> B[\"Start Story\"];\n        B --> C[\"Record/AI Guide\"];\n        C --> D[\"Review/Refine\"];\n        D --> E[\"Archive/Share\"];\n    end\n\n    A --\"Includes\"--> \"2285 - User Auth\";\n    B --\"Includes\"--> \"2300 - Mic Access\";\n    C --\"Includes\"--> \"2288 - Interactive Capture\";\n    C --\"Includes\"--> \"2287 - Voice-to-Text\";\n    C --\"Includes\"--> \"2286 - AI-Guided Interview\";\n    D --\"Includes\"--> \"2292 - My Stories\";\n    D --\"Includes\"--> \"2291 - Metadata Tagging\";\n    E --\"Includes\"--> \"2289 - Offline Archiving\";\n    E --\"Includes\"--> \"2293 - Export/Sharing\";\n    E --\"Includes\"--> \"2295 - Public Archive\";\n\n    subgraph \"Cross-Cutting Concerns\"\n        F[\"2290 - GDPR Compliance\"]\n        G[\"2294 - Multilingual UI\"]\n        H[\"2298 - Error Handling\"]\n        I[\"2301 - Performance\"]\n    end\n\n    F --> A; F --> C; F --> E;\n    G --> A; G --> B; G --> C; G --> D; G --> E;\n    H --> C; H --> D;\n    I --> C;\n```\n\n## Detailed User Stories\n\nStories are grouped by priority, reflecting the project's MVP focus. Story Points (SP) are relative estimates (1: trivial, 2: simple, 3: moderate, 5: complex).\n\n### Critical Priority Stories\n\n*   **ID: 2285 - User Registration and Authentication**\n    *   As a new user, I want to register securely so that I can access personalized story archiving.\n    *   As an existing user, I want to log in securely so that I can continue managing my stories.\n    *   **Acceptance Criteria:** User can create/log in to account securely; Authentication protects user data.\n    *   **SP:** 3. **Dependencies:** 2297.\n*   **ID: 2286 - AI-Guided Interview Assistant**\n    *   As a storyteller, I want AI-guided questions based on the 5W method so that my story capture is structured and comprehensive.\n    *   **Acceptance Criteria:** AI prompts relevant questions after audio processing; Questions align with 5W method.\n    *   **SP:** 5. **Dependencies:** 2287, 2301, 2297.\n*   **ID: 2287 - Voice-to-Text Transcription (Local-First)**\n    *   As a storyteller, I want my recorded audio transcribed to text using local-first STT so that my data remains on-device and private.\n    *   **Acceptance Criteria:** Audio segments are accurately transcribed locally; Transcription adheres to GDPR.\n    *   **SP:** 5. **Dependencies:** 2300, 2301, 2290.\n*   **ID: 2288 - Interactive Story Capture Loop**\n    *   As a storyteller, I want an interactive UI to record, process, display analysis, and receive new questions so that I can smoothly capture my narrative.\n    *   **Acceptance Criteria:** UI clearly shows recording, processing, and analysis states; Displays transcript/summary; Presents next question.\n    *   **SP:** 5. **Dependencies:** 2300, 2287, 2286, 2298.\n*   **ID: 2289 - Offline-First Story Archiving**\n    *   As a storyteller, I want to capture and archive stories offline so that I can work without constant internet access.\n    *   **Acceptance Criteria:** Stories persist locally via IndexedDB/localStorage; Data syncs upon reconnection.\n    *   **SP:** 3. **Dependencies:** 2290.\n*   **ID: 2290 - GDPR-Compliant Data Handling and Consent**\n    *   As a user, I want my data handled GDPR-compliantly with local storage and explicit consent so that my privacy is protected.\n    *   **Acceptance Criteria:** Story data stored locally by default; Explicit opt-in for any export/publication.\n    *   **SP:** 5. **Dependencies:** 2287, 2289, 2293, 2295.\n*   **ID: 2300 - Microphone Access and Audio Recording**\n    *   As a storyteller, I want the system to securely access my microphone so that I can record audio segments for my stories.\n    *   **Acceptance Criteria:** Browser prompts for mic permission; Audio recorded via MediaRecorder API.\n    *   **SP:** 2. **Dependencies:** 2288.\n\n### High Priority Stories\n\n*   **ID: 2291 - Story Metadata Tagging and Structuring**\n    *   As a storyteller, I want to add rich metadata (geo-tagging, temporal, dialect, general tags) to my stories so that they are discoverable and historically valuable.\n    *   **Acceptance Criteria:** User can apply various metadata types; Metadata is stored with the story.\n    *   **SP:** 3. **Dependencies:** 2292.\n*   **ID: 2292 - Personal Story Management ('My Stories')**\n    *   As a storyteller, I want to view, edit, and manage my personal collection of archived stories so that I can review and refine my narratives.\n    *   **Acceptance Criteria:** Dedicated 'My Stories' page exists; User can view/edit transcripts, summaries, and metadata.\n    *   **SP:** 3. **Dependencies:** 2289, 2291.\n*   **ID: 2293 - Story Export and Sharing Capabilities**\n    *   As a storyteller, I want to export and share my stories in various formats (PDF, Podcast, Timeline) so that I can disseminate them privately or publicly.\n    *   **Acceptance Criteria:** Options for PDF, Podcast, Timeline export are available; Sharing requires explicit consent.\n    *   **SP:** 5. **Dependencies:** 2290, 2292.\n*   **ID: 2294 - Multilingual User Interface (i18n)**\n    *   As a user, I want to switch UI languages (German/English) and persist my preference so that I can use the application comfortably.\n    *   **Acceptance Criteria:** UI supports German and English; Language preference is saved locally.\n    *   **SP:** 2.\n*   **ID: 2296 - Containerized Development Environment**\n    *   As a developer, I want a containerized (Docker) development environment so that setup is consistent and reproducible.\n    *   **Acceptance Criteria:** Docker Compose sets up frontend/backend services; Environment is consistent across machines.\n    *   **SP:** 3.\n*   **ID: 2297 - Secure API Key Management**\n    *   As a developer, I want API keys managed securely via environment variables so that sensitive information is protected from version control.\n    *   **Acceptance Criteria:** API keys loaded from .env files; No hardcoded keys in source.\n    *   **SP:** 2. **Dependencies:** 2286.\n\n### Medium Priority Stories\n\n*   **ID: 2295 - Public Story Archive and Viewing**\n    *   As a public user, I want to explore and view publicly shared stories so that I can engage with cultural content.\n    *   **Acceptance Criteria:** Public archive page exists; Public stories are viewable without login.\n    *   **SP:** 3. **Dependencies:** 2293, 2290.\n*   **ID: 2298 - Robust Error Handling and UI Feedback**\n    *   As a user, I want clear feedback and graceful error handling during operations so that I understand system status and issues.\n    *   **Acceptance Criteria:** API call errors are handled; Microphone access errors are managed; UI state updates clearly.\n    *   **SP:** 2.\n*   **ID: 2299 - Cross-Origin Resource Sharing (CORS) Configuration**\n    *   As a developer, I want the backend API configured with correct CORS headers so that frontend/backend communication works seamlessly.\n    *   **Acceptance Criteria:** CORS allows frontend access; Prevents cross-origin issues during development/production.\n    *   **SP:** 1.\n*   **ID: 2301 - Performance of AI and STT Processing**\n    *   As a storyteller, I want fast AI and STT processing so that my interview experience is smooth and low-latency.\n    *   **Acceptance Criteria:** STT and AI processing latency is minimal; User experience feels responsive.\n    *   **SP:** 3. **Dependencies:** 2286, 2287.\n\n### Low Priority Stories (Future Considerations)\n\n*   **ID: 2302 - Scalability for Future Cloud Deployment**\n    *   As a system architect, I want the system designed for future cloud scalability so that it can grow with user base and data.\n    *   **Acceptance Criteria:** Architecture supports cloud deployment patterns; Services are modular.\n    *   **SP:** 1.\n*   **ID: 2303 - Admin and Partner Portal Functionality**\n    *   As an administrator, I want access to restricted pages for content and user management so that I can moderate the platform.\n    *   **Acceptance Criteria:** Admin portal exists; Provides user/content management.\n    *   **SP:** 1. **Dependencies:** 2285.\n*   **ID: 2304 - Pricing and Subscription Management**\n    *   As a business, I want pricing and subscription management functionality so that I can monetize private archiving and corporate packages.\n    *   **Acceptance Criteria:** Pricing page exists; Subscription logic implemented.\n    *   **SP:** 1. **Dependencies:** 2285.\n\n## Story Organization\n\nStories are organized by the Epics defined above and further prioritized as Critical, High, Medium, and Low. Critical stories form the core MVP. High priority stories enhance the core experience. Medium and Low priority stories are planned for subsequent phases.\n\n*   **User Persona Mapping:**\n    *   **Storyteller:** Primary user, interacting with all core capture and management features (2285, 2286, 2287, 2288, 2289, 2291, 2292, 2293, 2300, 2301).\n    *   **Public User:** Views publicly shared stories (2295).\n    *   **Developer:** Focuses on infrastructure and technical enablers (2296, 2297, 2299).\n    *   **Administrator/Partner:** Future roles for content and user management (2303).\n    *   **Business:** Future role for monetization (2304).\n\n*   **Workflow and Process Integration:** Critical stories drive the main user workflow from registration to story capture and initial management. Dependencies ensure a logical build order, with foundational elements (e.g., authentication, microphone access) preceding interactive components. Cross-cutting concerns like GDPR (2290), multilingual support (2294), and error handling (2298) are integrated throughout the development process.\n\n## Access Control and Security Stories\n\nSecurity and access control are paramount, especially given the GDPR compliance requirement.\n\n*   **User Stories Requiring Explicit Permissions:**\n    *   **2285 - User Registration and Authentication:** Requires authentication to access any personalized features.\n    *   **2290 - GDPR-Compliant Data Handling and Consent:** Explicit opt-in consent is required for any story export or publication (2293, 2295).\n    *   **2300 - Microphone Access and Audio Recording:** Requires explicit user permission via browser prompts.\n    *   **2292 - Personal Story Management ('My Stories'):** Access is restricted to the logged-in user for their own stories.\n    *   **2303 - Admin and Partner Portal Functionality:** (Future) Access will be restricted to authorized admin/partner users.\n\n*   **Actions Protected by Segregation of Duty Requirements:**\n    *   For the MVP, explicit segregation of duties is not a primary concern beyond basic user/admin roles. Future Admin/Partner portals (2303) will introduce distinct roles for content moderation versus user management.\n\n*   **Actions Requiring Audit Log or Audit Trail:**\n    *   While not explicitly detailed for MVP, future enhancements for Admin/Partner portals (2303) and critical data operations (e.g., story deletion, consent changes related to 2290) would benefit from audit logging to track user and system actions for compliance and accountability.\n\n*   **Role-Based Access Control Requirements:**\n    *   **User Role:** Can register, log in, capture stories, manage their own stories, and optionally consent to public sharing.\n    *   **Public Role:** Can view publicly consented stories (2295) without authentication.\n    *   **Admin/Partner Roles (Future):** Will have elevated privileges for content moderation, user management, and potentially collection management (2303).","id":1843},"old":{"id":null,"content":null},"mode":"ai"},{"artifactType":"DataModel","changeType":"create","status":"success","data":{"content":"## Data Model Overview\n\nThe Storycatcher II data model is designed with a \"local-first\" approach for sensitive personal story content, complemented by a backend database for user management, story metadata, and publicly shared narratives. This hybrid architecture prioritizes GDPR compliance by minimizing cloud data exposure for private content while enabling features like user authentication, story organization, and public archiving.\n\nKey entities include `User` (for authentication and preferences), `StoryMetadata` (for managing story details and public sharing status), `StoryTag` (for discoverability and categorization), and `InterviewQuestionLog` (for tracking the AI-guided interview process). Raw audio recordings and their full transcriptions are primarily stored locally on the user's device (e.g., in IndexedDB), with the backend processing these only transiently for AI analysis or for export/public sharing with explicit user consent.\n\nData flows from the frontend, where audio is captured and processed locally. Metadata about the story is then synchronized with the backend database. When a story is consented for public sharing or export, the backend facilitates the necessary transformations and storage of the derived content. The lifecycle of a story involves creation (local and metadata sync), ongoing management (local content, backend metadata), and optional sharing/export, all governed by explicit consent mechanisms.\n\n## Entity-Relationship Diagram\n\n```mermaid\nerDiagram\n    USER ||--o{ STORY_METADATA : \"creates\"\n    STORY_METADATA ||--o{ STORY_TAG : \"has\"\n    STORY_METADATA ||--o{ INTERVIEW_QUESTION_LOG : \"generates\"\n\n    USER {\n        string user_id PK\n        string username\n        string email\n        string password_hash\n        string preferred_language\n        datetime created_at\n        datetime updated_at\n    }\n\n    STORY_METADATA {\n        string story_id PK\n        string user_id FK\n        string title\n        string description\n        boolean is_public\n        string local_story_identifier\n        datetime created_at\n        datetime updated_at\n    }\n\n    STORY_TAG {\n        string tag_id PK\n        string story_id FK\n        string tag_type\n        string tag_value\n    }\n\n    INTERVIEW_QUESTION_LOG {\n        string log_id PK\n        string story_id FK\n        string question_text\n        datetime prompt_timestamp\n        string ai_model_used\n    }\n```\n\n## Entity Specifications\n\n### USER\nRepresents a registered user of the Storycatcher II application.\n*   **user_id**: String, Primary Key. Unique identifier for the user.\n*   **username**: String, Unique, Not Null. User's chosen username for login.\n*   **email**: String, Unique, Not Null. User's email address, used for login and communication.\n*   **password_hash**: String, Not Null. Hashed and salted password for secure authentication.\n*   **preferred_language**: String, Default 'en'. User's selected UI language (e.g., 'en', 'de').\n*   **created_at**: Datetime, Not Null. Timestamp of user registration.\n*   **updated_at**: Datetime, Not Null. Last timestamp of user profile update.\n*   **Business Rules**: Each user must have a unique username and email. Passwords must be securely hashed.\n\n### STORY_METADATA\nStores descriptive information about a story, managed on the backend. The actual audio and transcript content of the story resides primarily on the user's local device.\n*   **story_id**: String, Primary Key. Unique identifier for the story metadata.\n*   **user_id**: String, Foreign Key to USER. Links the story to its creator.\n*   **title**: String, Not Null. User-defined title for the story.\n*   **description**: Text, Optional. A brief summary or description of the story.\n*   **is_public**: Boolean, Default False. Indicates if the user has explicitly consented to make this story public.\n*   **local_story_identifier**: String, Not Null. A unique identifier generated on the client-side to link this backend metadata record to the full story content stored in the user's local IndexedDB.\n*   **created_at**: Datetime, Not Null. Timestamp when the story metadata was first created.\n*   **updated_at**: Datetime, Not Null. Last timestamp of story metadata update.\n*   **Business Rules**: A story must belong to a user. `is_public` requires explicit user consent.\n\n### STORY_TAG\nRepresents a tag associated with a story, enhancing discoverability and organization.\n*   **tag_id**: String, Primary Key. Unique identifier for the tag entry.\n*   **story_id**: String, Foreign Key to STORY_METADATA. Links the tag to a specific story.\n*   **tag_type**: String, Not Null. Category of the tag (e.g., 'geo', 'temporal', 'dialect', 'general').\n*   **tag_value**: String, Not Null. The actual content of the tag (e.g., 'Berlin', '1990s', 'Bavarian', 'Childhood').\n*   **Business Rules**: Multiple tags can be associated with a single story.\n\n### INTERVIEW_QUESTION_LOG\nLogs the AI-generated questions presented to the user during the interactive story capture process.\n*   **log_id**: String, Primary Key. Unique identifier for the log entry.\n*   **story_id**: String, Foreign Key to STORY_METADATA. Links the question to the story being recorded.\n*   **question_text**: Text, Not Null. The question prompted by the AI assistant.\n*   **prompt_timestamp**: Datetime, Not Null. Timestamp when the question was presented.\n*   **ai_model_used**: String, Optional. Identifier for the AI model that generated the question.\n*   **Business Rules**: Records the sequence of AI interactions for a given story.\n\n## Data Security and Privacy Considerations\n\nThe data model is built with GDPR compliance as a critical priority, emphasizing a local-first approach for sensitive content.\n\n### Data Identification and Classification\n*   **Confidential Data**: Raw audio recordings, full voice-to-text transcriptions, user passwords (hashed), personal story content (before explicit public consent). This data is primarily stored locally on the user's device.\n*   **Internal Data**: User account information (username, email, preferred_language), story metadata (title, description, tags) when `is_public` is false. This data is stored on the backend.\n*   **Public Data**: Story metadata and processed story content (e.g., exported PDF, podcast) that users have explicitly consented to make public (`is_public` is true).\n\n### Analysis of Data Types Stored and Processed\n*   **Personally Identifiable Information (PII)**: User registration details (email, username), and potentially geo-tags or other identifying information within story metadata.\n*   **Sensitive Personal Data**: Voice recordings and their transcriptions contain personal narratives, opinions, and potentially sensitive biographical details. While processed by the backend's local-first STT engine, the raw audio and full transcripts are primarily retained on the user's device.\n\n### Suitable Security Measures\n*   **Authentication**: Robust mechanisms (e.g., password hashing, secure token management) for user accounts.\n*   **Secure API Key Management**: Environment variables for sensitive API keys (e.g., LLM providers).\n*   **Data in Transit**: All communication between frontend and backend uses HTTPS/TLS.\n*   **CORS Configuration**: Strict CORS policies on the backend to prevent unauthorized cross-origin requests.\n*   **Principle of Least Privilege**: Services and components have minimal necessary permissions.\n*   **Secure Coding Practices**: Adherence to OWASP Top 10 guidelines.\n*   **Local Data Protection**: Reliance on browser's IndexedDB security model, which isolates data per origin.\n\n### Special Protection Requirements\n*   **PII Data**:\n    *   **Purpose**: Collected for user identification, personalized experience, and account management (Req 2285).\n    *   **Consent**: User registration implies consent for basic account data processing. Explicit, opt-in consent is mandatory for any story export or publication (Req 2290, 2293, 2295).\n    *   **Retention**: PII is retained as long as the user account exists. Users are provided mechanisms to access, correct, or delete their data (GDPR Right to Erasure/Access).\n*   **Health Care Data**: Not applicable; the system is not designed to collect or process health-related information.\n*   **Payment Data**: Not applicable for the MVP; pricing and subscription management (Req 2304) are future considerations.","id":1846},"old":{"id":null,"content":null},"mode":"ai"},{"artifactType":"Architecture","changeType":"create","status":"success","data":{"id":1845,"content":"## Architecture Overview\n\nStorycatcher II is a privacy-centric, JavaScript-based web application designed for secure personal story capture. Its core architectural principle is \"local-first\" data handling for sensitive information, ensuring GDPR compliance. The system uses a modular approach, separating frontend client, backend services, and external integrations.\n\n**Architectural Principles and Design Patterns:**\n*   **Local-First:** Prioritizes on-device data processing (STT) and storage (story archiving) to maximize user privacy and GDPR compliance (2287, 2289, 2290).\n*   **Privacy-by-Design:** Integrates GDPR compliance (2290) and secure API key management (2297) from the outset.\n*   **Modular Design:** Backend services are logically separated (User Management, Story Processing) to facilitate maintainability and future scalability (2302).\n*   **Interactive Loop:** The frontend supports a dynamic recording, processing, and feedback cycle for guided interviews (2288).\n\n**Technology Stack Integration and Rationale:**\nThe architecture leverages a JavaScript ecosystem for both frontend (React) and backend (Node.js) for consistency and developer efficiency. Local-first Voice-to-Text (STT) engines like Whisper or Vosk are integrated directly into the backend to keep transcription on-premises, addressing privacy requirements (2287). IndexedDB/localStorage ensures offline story archiving (2289).\n\n**Scalability and Performance Strategy:**\nPerformance optimization is critical for AI and STT processes to ensure a smooth user experience (2301). The modular backend design considers future cloud deployment and scaling (2302), allowing individual services to scale independently.\n\n## Component Architecture\n\nThe system comprises a frontend client, a Node.js backend with distinct services, and an external LLM integration.\n\n```mermaid\ngraph LR\n    subgraph \"User Device\"\n        A[\"Client - React/JavaScript UI\"] --> B(\"Microphone Access / MediaRecorder API\");\n        A --> C(\"Local Storage - IndexedDB / localStorage\");\n    end\n\n    subgraph \"Backend Services - Node.js\"\n        D(\"API Gateway / Authentication\") --> E(\"User Management Service\");\n        D --> F(\"Story Processing Service\");\n        F --> G(\"AI-Guided Interview Logic\");\n        F --> H(\"Local-First STT Engine - Whisper / Vosk\");\n        F --> I(\"Story Data Management\");\n    end\n\n    subgraph \"External Integration\"\n        J(\"LLM Provider API - for AI Guidance\");\n    end\n\n    A -- \"API Calls\" --> D;\n    B -- \"Audio Stream\" --> F;\n    F -- \"Text & Analysis\" --> A;\n    G -- \"Question Generation\" --> J;\n    J -- \"AI Responses\" --> G;\n    I -- \"Store Story Metadata\" --> K(\"Backend Database - PostgreSQL / MongoDB\");\n\n    style A fill:#e0f7fa,stroke:#00796b,stroke-width:2px\n    style B fill:#e0f7fa,stroke:#00796b,stroke-width:2px\n    style C fill:#e0f7fa,stroke:#00796b,stroke-width:2px\n    style D fill:#c8e6c9,stroke:#388e3c,stroke-width:2px\n    style E fill:#c8e6c9,stroke:#388e3c,stroke-width:2px\n    style F fill:#c8e6c9,stroke:#388e3c,stroke-width:2px\n    style G fill:#c8e6c9,stroke:#388e3c,stroke-width:2px\n    style H fill:#c8e6c9,stroke:#388e3c,stroke-width:2px\n    style I fill:#c8e6c9,stroke:#388e3c,stroke-width:2px\n    style J fill:#fff8e1,stroke:#fbc02d,stroke-width:2px\n    style K fill:#bbdefb,stroke:#1976d2,stroke-width:2px\n```\n\n**Component Responsibilities and Interfaces:**\n*   **Client - React/JavaScript UI (2288, 2292, 2294, 2295, 2298, 2300):** Manages user interaction, audio recording via MediaRecorder API (2300), displays content, and handles local data persistence.\n*   **Local Storage - IndexedDB/localStorage (2289, 2290):** Stores story data locally for offline functionality and GDPR compliance.\n*   **API Gateway / Authentication (2285, 2299):** Entry point for all frontend requests, handles user authentication, and enforces CORS policies (2299).\n*   **User Management Service (2285):** Manages user registration, login, and profile data.\n*   **Story Processing Service (2286, 2287, 2291, 2293, 2301):** Orchestrates the core story capture loop. Receives audio, sends to STT, integrates AI for questions, handles metadata tagging (2291), and manages export/sharing (2293).\n*   **AI-Guided Interview Logic (2286):** Implements the 5W questioning method, interacting with an external LLM.\n*   **Local-First STT Engine (2287, 2301):** Performs voice-to-text transcription of audio segments on the backend server, ensuring data remains local.\n*   **Story Data Management (2291, 2292):** Manages CRUD operations for story content and metadata with the backend database.\n*   **Backend Database (PostgreSQL / MongoDB):** Persists user accounts and story metadata (not raw audio/transcripts for MVP).\n*   **LLM Provider API (2286, 2297):** External service for AI question generation. API keys are securely managed (2297).\n\n**Data Flow and Communication Patterns:**\n*   **User to Frontend:** Direct interaction, microphone input (2300).\n*   **Frontend to Backend:** RESTful API calls for authentication, story segment processing, and story management. Audio streams are sent to the backend (2288).\n*   **Backend Internal:** Service-to-service communication for orchestration (e.g., Story Processing calling STT and AI logic).\n*   **Backend to External LLM:** Secure API calls for AI guidance.\n*   **Backend to Database:** Standard database queries.\n*   **Backend to Frontend:** Transcripts, analysis, new questions, and confirmations are sent back (2288).\n\n## Technology Stack and Infrastructure\n\n*   **Frontend:** React (JavaScript) for interactive UI (2288, 2294). Leverages MediaRecorder API for audio capture (2300) and IndexedDB/localStorage for offline data persistence (2289).\n*   **Backend:** Node.js (JavaScript) for API services. Integrates local-first STT engines (Whisper/Vosk) for on-premise transcription (2287). Database choice is flexible (PostgreSQL/MongoDB) for user and metadata storage.\n*   **Infrastructure:** Docker and Docker Compose are used for a consistent and reproducible development environment (2296).\n*   **Integration Patterns:** RESTful APIs for client-server communication. HTTPS/TLS is used for all data in transit for security.\n*   **Communication Protocols:** HTTP/S for API calls, WebSockets potentially for real-time audio streaming (implicitly supported by MediaRecorder API and backend processing).\n*   **Performance:** AI and STT processing are optimized for minimal latency (2301) using efficient algorithms and local execution.\n\n## Security Architecture\n\n**Security Principles and Threat Model Integration:**\nSecurity is paramount, built on principles of privacy-by-design and least privilege. Key threats include unauthorized access to user accounts/data, data interception, and non-compliance with GDPR.\n\n**Authentication and Authorization Architecture:**\n*   **User Authentication (2285):** Secure login mechanisms (e.g., password hashing, token-based authentication) protect user accounts.\n*   **Authorization:** Access to personal stories and management features is restricted to authenticated users (2292). Public archive viewing (2295) is open to all.\n\n**Data Protection and Encryption Strategies:**\n*   **Local-First Storage (2289, 2290):** The primary data protection strategy is keeping sensitive story content (audio, raw transcripts) on the user's device, minimizing server-side data exposure.\n*   **Data in Transit:** All communication between frontend and backend uses HTTPS/TLS to encrypt data during transmission.\n*   **Secure API Key Management (2297):** Sensitive API keys for external services are managed via environment variables, preventing hardcoding.\n*   **Microphone Access (2300):** Browser-managed permissions ensure secure and explicit user consent for audio recording.\n\n**Compliance and Regulatory Considerations:**\n*   **GDPR Compliance (2290):** The system ensures local storage of MVP data, explicit opt-in consent for any story export or public sharing (2293, 2295), and mechanisms for users to manage their data.\n\n## Architecture Security & Compliance\n\n**Threat Model of the Architecture:**\n*   **Unauthorized Access to User Accounts:** A user's account could be compromised, leading to unauthorized access to their story metadata and ability to trigger exports.\n    *   **Mitigation:** Robust authentication (2285), password hashing, secure token management.\n*   **Data Interception in Transit:** Data (e.g., audio segments, metadata) could be intercepted during transmission between frontend and backend.\n    *   **Mitigation:** Mandatory HTTPS/TLS for all communication.\n*   **Unauthorized Data Export/Sharing:** User stories could be shared publicly or exported without explicit consent.\n    *   **Mitigation:** Strict GDPR-compliant consent flows (2290) for all export and public sharing features (2293, 2295).\n*   **Compromise of API Keys:** Sensitive LLM API keys could be exposed, leading to unauthorized service usage or data breaches.\n    *   **Mitigation:** Secure API key management using environment variables (2297).\n*   **Malicious Microphone Access:** Unauthorized access to a user's microphone.\n    *   **Mitigation:** Reliance on browser's secure permission model for MediaRecorder API (2300).\n\n**Required Security Controls and Mitigations:**\n*   **Authentication & Authorization:** Implement JWT or similar token-based authentication for user sessions (2285). Implement role-based access control for future admin/partner functionalities (2303).\n*   **Data Storage:** Local-first storage (IndexedDB/localStorage) for critical story data (2289). Backend database stores only necessary user and story metadata (2291).\n*   **Data in Transit:** Enforce HTTPS/TLS across all client-server and inter-service communication.\n*   **Consent Management:** Implement clear, explicit, opt-in consent UI for sharing and export actions (2290, 2293, 2295).\n*   **Secure Coding:** Adhere to OWASP Top 10 guidelines for web application security.\n*   **CORS Configuration:** Properly configure CORS headers on the backend to restrict access to authorized origins (2299).\n*   **Environment Variables:** Utilize environment variables for all sensitive configurations and API keys (2297).\n\n**Shared Responsibility Model Definition:**\n*   **User:** Responsible for device security, granting microphone permissions, and explicit consent decisions.\n*   **Storycatcher II Application:** Responsible for secure application development, authentication, API key management, GDPR compliance (local-first, consent), data integrity, and secure communication.\n*   **LLM Provider:** Responsible for the security and compliance of their AI service and API."},"old":{"content":null,"id":null},"mode":"ai"},{"artifactType":"TechStack","changeType":"create","status":"success","data":{"id":1844,"content":"Storycatcher II leverages a modern, privacy-centric technology stack designed to deliver a robust, local-first, and AI-guided storytelling experience. The architecture emphasizes data sovereignty, performance, and a streamlined development workflow.\n\n## Technology Stack Overview\n\nStorycatcher II employs a client-server architecture with a strong emphasis on local data processing and storage for privacy.\n\n```mermaid\ngraph LR\n    subgraph \"User Device\"\n        A[\"Client - React/JavaScript UI\"] --> B(\"Microphone Access / MediaRecorder API\");\n        A --> C(\"Local Storage - IndexedDB / localStorage\");\n    end\n\n    subgraph \"Backend Services - Node.js\"\n        D(\"API Gateway / Authentication\") --> E(\"User Management Service\");\n        D --> F(\"Story Processing Service\");\n        F --> G(\"AI-Guided Interview Logic\");\n        F --> H(\"Local-First STT Engine - Whisper / Vosk\");\n        F --> I(\"Story Data Management\");\n    end\n\n    subgraph \"External Integration\"\n        J(\"LLM Provider API - for AI Guidance\");\n    end\n\n    A -- \"API Calls (HTTPS/TLS)\" --> D;\n    B -- \"Audio Stream\" --> F;\n    F -- \"Text & Analysis\" --> A;\n    G -- \"Question Generation\" --> J;\n    J -- \"AI Responses\" --> G;\n    I -- \"Store Story Metadata\" --> K(\"Backend Database - PostgreSQL / MongoDB\");\n\n    style A fill:#e0f7fa,stroke:#00796b,stroke-width:2px\n    style B fill:#e0f7fa,stroke:#00796b,stroke-width:2px\n    style C fill:#e0f7fa,stroke:#00796b,stroke-width:2px\n    style D fill:#c8e6c9,stroke:#388e3c,stroke-width:2px\n    style E fill:#c8e6c9,stroke:#388e3c,stroke-width:2px\n    style F fill:#c8e6c9,stroke:#388e3c,stroke-width:2px\n    style G fill:#c8e6c9,stroke:#388e3c,stroke-width:2px\n    style H fill:#c8e6c9,stroke:#388e3c,stroke-width:2px\n    style I fill:#c8e6c9,stroke:#388e3c,stroke-width:2px\n    style J fill:#fff8e1,stroke:#fbc02d,stroke-width:2px\n    style K fill:#bbdefb,stroke:#1976d2,stroke-width:2px\n```\n\n**Technology Selection Principles and Criteria:**\n*   **GDPR Compliance (2290):** Prioritizing local-first data processing and storage.\n*   **Performance (2301):** Optimizing AI and STT processes for minimal latency.\n*   **JavaScript Ecosystem:** Leveraging a unified language for both frontend and backend for consistency and developer efficiency.\n*   **Containerization (2296):** Ensuring consistent and reproducible development environments.\n*   **Security (2297):** Implementing secure API key management and data handling.\n*   **Open Standards:** Utilizing browser-native APIs where possible (e.g., MediaRecorder, IndexedDB).\n\n**Integration and Compatibility Considerations:**\nFrontend and backend communicate via RESTful API calls over HTTPS/TLS. The backend integrates local-first STT engines and external LLM providers. CORS configuration (2299) is essential for seamless communication, especially during development.\n\n## Frontend Technologies\n\n*   **Frontend Framework:** React.js / JavaScript UI (Artifact 1 - System Architecture)\n    *   Chosen for building interactive user interfaces (2288) and single-page applications.\n*   **Local Data Persistence:** IndexedDB / localStorage (Artifact 1 - System Architecture, 2289)\n    *   Critical for offline-first story archiving (2289) and GDPR-compliant local data handling (2290).\n*   **Audio Recording:** MediaRecorder API (2300)\n    *   Standard browser API for secure microphone access and audio capture.\n*   **Internationalization:** i18n libraries (2294)\n    *   For supporting multilingual user interfaces (German and English initially).\n*   **Build Tools:** Standard JavaScript bundlers (e.g., Webpack/Vite implied by React ecosystem)\n    *   To compile, bundle, and optimize frontend assets.\n\n## Backend Technologies\n\n*   **Runtime Environment:** Node.js (Artifact 1 - System Architecture)\n    *   Enables a unified JavaScript stack across frontend and backend.\n*   **Web Framework:** Express.js (Implied by Node.js for API services)\n    *   For building RESTful APIs for user authentication, story processing, and data management.\n*   **Authentication and Authorization:** JWT-based authentication (Implied by 2285 - User Registration and Authentication)\n    *   For secure user login and API access control.\n*   **Voice-to-Text (STT) Engine:** Whisper / Vosk (Artifact 1 - System Architecture, 2287)\n    *   Selected for local-first transcription to ensure GDPR compliance and data privacy (2290).\n*   **AI-Guided Interview Logic:** Custom Node.js modules integrating with LLM Provider API (2286)\n    *   Implements the 5W questioning method and text analysis.\n*   **LLM Integration:** External LLM Provider API (Artifact 1 - System Architecture, 2286)\n    *   For AI guidance and question generation, with secure API key management (2297).\n*   **CORS Configuration:** Express.js CORS middleware (2299)\n    *   To manage cross-origin resource sharing between frontend and backend.\n\n## Data and Storage Solutions\n\n*   **Backend Database:** PostgreSQL / MongoDB (Artifact 1 - System Architecture)\n    *   PostgreSQL (relational) or MongoDB (NoSQL) for storing user data, story metadata (2291), and transcripts/summaries that are not strictly local-only.\n*   **Frontend Local Storage:** IndexedDB / localStorage (2289, 2290)\n    *   Primary storage for user story data, transcripts, and summaries on the user's device.\n\n## Infrastructure and DevOps\n\n*   **Containerization:** Docker and Docker Compose (2296)\n    *   For creating consistent, isolated, and reproducible development and deployment environments for both frontend and backend services.\n*   **Deployment and Hosting:** Docker containers (MVP)\n    *   For the MVP, deployment is container-based. Future plans include cloud hosting (e.g., STACKIT/SICOS BW, 2302).\n*   **Secure API Key Management:** Environment variables and `.env` files (2297)\n    *   To securely store and load sensitive API keys for LLM providers and other services.\n*   **Communication Security:** HTTPS/TLS (Artifact 2 - Security Best Practices)\n    *   Ensuring encrypted communication between the frontend and backend.\n\n## Technology Justification\n\n*   **React.js (Frontend Framework):** Chosen for its component-based architecture, enabling the interactive story capture loop (2288) and complex UI states, including multilingual support (2294) and robust error feedback (2298).\n*   **Node.js / Express.js (Backend Runtime/Framework):** Provides a unified JavaScript development experience (Artifact 1), facilitating faster development and easier context switching. It's well-suited for building the API gateway (2285), processing audio streams, and managing AI/STT logic (2286, 2287).\n*   **IndexedDB / localStorage (Frontend Storage):** Directly supports the critical requirement for offline-first story archiving (2289) and GDPR-compliant local data handling (2290), ensuring user data remains on the device by default.\n*   **Whisper / Vosk (Local-First STT Engine):** Essential for fulfilling the critical requirement of local-first voice-to-text transcription (2287), directly addressing GDPR compliance (2290) by minimizing data transfer off-device.\n*   **PostgreSQL / MongoDB (Backend Database):** Provides robust data persistence for user accounts (2285) and story metadata (2291), which may be shared or managed across sessions. The choice allows flexibility between relational integrity and schema flexibility.\n*   **Docker and Docker Compose (Containerization):** Critical for establishing a consistent and easily reproducible development environment (2296), streamlining setup for developers and ensuring parity between development and deployment stages.\n*   **MediaRecorder API (Frontend Audio):** A standard browser API that securely requests and manages microphone permissions (2300), enabling audio capture directly within the browser, crucial for the interactive capture loop (2288).\n*   **LLM Provider API (AI Guidance):** Powers the AI-guided interview assistant (2286) using the 5W questioning method. Its integration is managed securely (2297) to protect sensitive API keys.\n*   **HTTPS/TLS (Communication Security):** Fundamental for securing data in transit between the frontend and backend, protecting user credentials and story data, a key aspect of overall security (2285, 2290)."},"old":{"id":null,"content":null},"mode":"ai"},{"artifactType":"Pages","changeType":"create","status":"success","data":{"content":"## Page Navigation Flow\n\nThe Storycatcher II application guides users through a clear set of pages, facilitating secure access, interactive story capture, and efficient management of personal narratives. The navigation flow emphasizes a user-centric design, allowing seamless transitions between core functionalities while maintaining privacy and data integrity.\n\n```mermaid\ngraph TD\n    subgraph \"Public / Unauthenticated Access\"\n        LP[\"Landing Page\"] --> LGP(\"Login Page\");\n        LP --> RP(\"Registration Page\");\n        LP --> PAP(\"Public Archive Page\");\n    end\n\n    subgraph \"Authenticated User Flow\"\n        LGP --> MSP(\"My Stories Page\");\n        RP --> MSP;\n        MSP --> SCP(\"Story Capture Page\");\n        MSP --> SDSP(\"Story Detail / Edit Page\");\n        MSP --> LGP;\n        SCP --> MSP;\n        SDSP --> MSP;\n        SDSP --> ESOP(\"Export / Share Options\");\n        ESOP --> SDSP;\n        ESOP --> MSP;\n    end\n\n    subgraph \"Public Story Viewing\"\n        PAP --> PSVP(\"Public Story View Page\");\n        PSVP --> PAP;\n    end\n\n    style LP fill:#f0f8ff,stroke:#3178c6,stroke-width:2px\n    style LGP fill:#e0f7fa,stroke:#00796b,stroke-width:2px\n    style RP fill:#e0f7fa,stroke:#00796b,stroke-width:2px\n    style MSP fill:#c8e6c9,stroke:#388e3c,stroke-width:2px\n    style SCP fill:#fff3e0,stroke:#e65100,stroke-width:2px\n    style SDSP fill:#fffde7,stroke:#fbc02d,stroke-width:2px\n    style ESOP fill:#ffe0b2,stroke:#fb8c00,stroke-width:2px\n    style PAP fill:#e3f2fd,stroke:#1e88e5,stroke-width:2px\n    style PSVP fill:#e3f2fd,stroke:#1e88e5,stroke-width:2px\n```\n\n**Overview of Page Hierarchy and User Flow:**\n\nThe application's navigation is structured around two primary states: unauthenticated and authenticated. The `Landing Page` serves as the initial entry point, directing users to `Login`, `Registration`, or the `Public Archive`. Upon successful login or registration, users are directed to the `My Stories Page`, which acts as their personalized dashboard. From `My Stories`, users can initiate `Story Capture`, manage individual stories via the `Story Detail / Edit Page`, or `Logout`. The `Story Capture Page` is an interactive loop for recording and processing audio. The `Story Detail / Edit Page` allows for metadata management and initiates `Export / Share Options`, which includes crucial GDPR consent steps. Publicly shared stories are accessible via the `Public Archive Page` and individual `Public Story View Pages`, which are available to both authenticated and unauthenticated users.\n\n## Page Specifications\n\n### Landing Page\n*   **Purpose**: The initial entry point for the application, providing an overview and directing users to registration, login, or the public archive.\n*   **Target Users**: New users, returning users, public users.\n*   **Key Content**: Application branding, brief description of Storycatcher II's purpose (privacy-centric story capture), calls to action for registration, login, and exploring public stories.\n*   **Actions Available**: \"Register\", \"Log In\", \"Explore Public Archive\".\n*   **Navigation**:\n    *   To `Registration Page` (via \"Register\").\n    *   To `Login Page` (via \"Log In\").\n    *   To `Public Archive Page` (via \"Explore Public Archive\").\n\n### Registration Page\n*   **Purpose**: Allows new users to create an account to access personalized story archiving features (Requirement 2285).\n*   **Target Users**: New users.\n*   **Key Content**: Form fields for username, email, password, password confirmation. Privacy policy link, terms of service checkbox.\n*   **Actions Available**: \"Register Account\", \"Back to Login\".\n*   **Navigation**:\n    *   From `Landing Page`.\n    *   To `My Stories Page` (on successful registration and automatic login).\n    *   To `Login Page`.\n    *   Displays error feedback (Requirement 2298) on failed registration.\n\n### Login Page\n*   **Purpose**: Enables existing users to securely log in to their accounts (Requirement 2285).\n*   **Target Users**: Existing users.\n*   **Key Content**: Form fields for username/email and password. \"Forgot Password\" link (if implemented in future, not explicit MVP req).\n*   **Actions Available**: \"Log In\", \"Register New Account\".\n*   **Navigation**:\n    *   From `Landing Page`.\n    *   From `Registration Page`.\n    *   To `My Stories Page` (on successful login).\n    *   To `Registration Page`.\n    *   Displays error feedback (Requirement 2298) on failed login.\n\n### My Stories Page\n*   **Purpose**: Serves as the user's dashboard for viewing, editing, and managing their personal collection of archived stories (Requirement 2292, 2289).\n*   **Target Users**: Authenticated storytellers.\n*   **Key Content**: List of archived stories (titles, summaries, creation dates), options to sort/filter stories. Displays confirmation for archived stories (part of 2288).\n*   **Actions Available**: \"Start New Story\", \"Select Story\" (to view/edit), \"Logout\".\n*   **Navigation**:\n    *   From `Login Page` or `Registration Page`.\n    *   From `Story Capture Page` (after finalizing a story).\n    *   From `Story Detail / Edit Page`.\n    *   To `Story Capture Page`.\n    *   To `Story Detail / Edit Page`.\n    *   To `Login Page` (on logout).\n    *   Supports offline-first display of stories (Requirement 2289).\n\n### Story Capture Page\n*   **Purpose**: Provides the interactive interface for recording audio segments, displaying AI-guided questions, and showing transcription/analysis (Requirement 2288).\n*   **Target Users**: Authenticated storytellers.\n*   **Key Content**: Microphone access prompt/status (Requirement 2300), recording controls (start, stop, pause), real-time or near real-time transcript display (Requirement 2287), AI-generated guiding questions (Requirement 2286), summary of current segment. UI states for idle, recording, processing, showing analysis (Requirement 2288).\n*   **Actions Available**: \"Start Recording\", \"Stop Recording Segment\", \"Continue Recording\", \"Finalize Story\".\n*   **Navigation**:\n    *   From `My Stories Page`.\n    *   To `My Stories Page` (on finalizing story).\n    *   Displays robust error handling and UI feedback for microphone access or processing issues (Requirement 2298).\n\n### Story Detail / Edit Page\n*   **Purpose**: Allows users to view the full transcript and summary of a specific story, edit its metadata, and initiate export or sharing (Requirement 2292, 2291, 2293).\n*   **Target Users**: Authenticated storytellers.\n*   **Key Content**: Full story transcript, detailed summary, editable metadata fields (geo-tagging, temporal, dialect, general tags - Requirement 2291), story playback controls.\n*   **Actions Available**: \"Edit Metadata\", \"Save Changes\", \"Cancel Edit\", \"Export Story\", \"Share Story\", \"Delete Story\".\n*   **Navigation**:\n    *   From `My Stories Page`.\n    *   To `My Stories Page`.\n    *   To `Export / Share Options` (on selecting export/share).\n\n### Export / Share Options\n*   **Purpose**: Presents options for exporting a story in various formats (PDF, Podcast, Timeline) and managing explicit consent for public sharing (Requirement 2293, 2290).\n*   **Target Users**: Authenticated storytellers.\n*   **Key Content**: Checkboxes/radio buttons for export formats (PDF, Podcast, Timeline). Clear GDPR consent form for public sharing, including opt-in confirmation (Requirement 2290).\n*   **Actions Available**: \"Select Format\", \"Grant Consent for Public Sharing\", \"Confirm Export/Share\", \"Cancel\".\n*   **Navigation**:\n    *   From `Story Detail / Edit Page`.\n    *   To `Story Detail / Edit Page`.\n    *   To `My Stories Page` (after successful export/share confirmation).\n\n### Public Archive Page\n*   **Purpose**: Allows public users to browse and explore stories that have been explicitly consented for public sharing (Requirement 2295).\n*   **Target Users**: Public users, authenticated users.\n*   **Key Content**: Browseable list of publicly available stories, including titles, authors, summaries, and potentially metadata tags. Search and filter options.\n*   **Actions Available**: \"Select Story\" (to view details).\n*   **Navigation**:\n    *   From `Landing Page`.\n    *   To `Public Story View Page`.\n    *   To `Login Page` / `Registration Page`.\n\n### Public Story View Page\n*   **Purpose**: Displays the full content of a single story that has been explicitly consented for public viewing (Requirement 2295).\n*   **Target Users**: Public users, authenticated users.\n*   **Key Content**: Full story transcript, summary, associated public metadata, author (if shared). No editing or export options.\n*   **Actions Available**: \"Back to Public Archive\".\n*   **Navigation**:\n    *   From `Public Archive Page`.\n    *   To `Public Archive Page`.","id":1847},"old":{"content":null,"id":null},"mode":"ai"},{"artifactType":"Design","changeType":"create","status":"success","data":{"content":"## Design System Overview\n\nStorycatcher II's design philosophy centers on privacy, intuition, and accessibility. The interface will be clean, guided, and trustworthy, reflecting the application's commitment to local-first data handling and GDPR compliance (Requirements 2289, 2290). The design aims for a user-friendly and efficient experience, empowering users to easily capture and manage personal narratives (Artifact 1, 2).\n\nThe design language will be clear and unobtrusive, prioritizing content and user interaction. It will project reliability and security, essential for a platform handling sensitive personal stories. A modular, component-based architecture (leveraging React.js, Artifact 9) will ensure consistency, reusability, and maintainability across the application. Components will be organized to support efficient development and consistent user experience.\n\n## Visual Design Elements\n\nA color palette will be defined to convey trust and clarity, using a limited set of primary and accent colors. Neutral tones will dominate for readability, with strategic use of accent colors to highlight interactive elements and feedback (e.g., success, error states, Requirement 2298).\n\nA clear and readable typography system will be established, with distinct hierarchies for titles, headings, body text, and UI labels. This ensures content legibility and guides user attention. A consistent spacing system and a responsive grid will be used to ensure visual balance, readability, and adaptability across various screen sizes, supporting intuitive layout of information and components.\n\nA set of clear, intuitive icons will be designed or selected to represent actions (e.g., record, stop, save, share) and content types, enhancing usability and reducing cognitive load (e.g., for story management, Requirement 2292; export/sharing, Requirement 2293).\n\n## Component Library\n\n### UI component specifications and variations\n*   **Authentication Forms**: Input fields, buttons, and validation messages for user registration and login (Requirement 2285).\n*   **Audio Recording Controls**: Buttons for start, stop, pause, and indicators for recording status and duration (Requirements 2288, 2300).\n*   **Text Displays**: Areas for displaying real-time voice-to-text transcripts, AI-generated summaries, and guiding questions (Requirement 2288).\n*   **Story List/Grid Views**: Components for displaying archived stories with metadata (title, tags) (Requirement 2292).\n*   **Story Detail/Edit Forms**: Input fields for editing story title, description, and applying metadata tags (geo-tagging, temporal, dialect, general tags) (Requirements 2291, 2292).\n*   **Export/Share Options**: Checkboxes, dropdowns, and buttons for selecting export formats (PDF, Podcast, Timeline) and managing sharing consent (Requirements 2293, 2290).\n*   **Language Selector**: A component for switching UI languages (German/English) (Requirement 2294).\n*   **Consent Dialogs**: Explicit opt-in prompts for data handling and public sharing (Requirement 2290).\n\n### Interactive states and behaviors\nComponents will include defined states for idle, hover, active, disabled, loading, and error (Requirements 2288, 2298). Form inputs will include validation feedback.\n\n### Component usage guidelines and best practices\nGuidelines will ensure consistent application of components across the UI, promoting reusability and a unified user experience.\n\n### Accessibility and responsive design considerations\nAll components will be designed to be accessible, supporting keyboard navigation, screen readers, and multilingual content (Requirement 2294). Responsive design principles will ensure optimal display and functionality across diverse devices.\n\n## Design Patterns and Guidelines\n\n### Interaction design patterns and user flows\nUser interactions will follow established flows to provide a predictable and efficient experience. Key flows, such as the `Interactive Story Capture Flow`, will guide the user through recording, processing, and AI interaction (Requirement 2288).\n\n```mermaid\ngraph TD\n    A[\"User - Dashboard\"] --> B[\"Start New Story / Record\"];\n    B --> C{\"Microphone Access Granted?\"};\n    C -- \"No\" --> D[\"Request Microphone Permission\"];\n    D -- \"Granted\" --> E(\"Frontend - Activate MediaRecorder\");\n    D -- \"Denied\" --> F[\"Display Mic Access Error\"];\n    C -- \"Yes\" --> E;\n    E --> G[\"Frontend - Display Recording UI\"];\n\n    subgraph \"Interactive Recording Loop\"\n        G --> H[\"User - Speak into Microphone\"];\n        H --> I[\"Frontend - Capture Audio Segment\"];\n        I --> J[\"User - Stop Recording Segment\"];\n        J --> K(\"Frontend - Send Audio to Backend\");\n        K --> L(\"Backend - Local-First STT Engine\");\n        L --> M(\"Backend - AI Interview Logic\");\n        M --> N[\"Backend - Send Transcript / Analysis / Question\"];\n        N --> O[\"Frontend - Store Data Locally IndexedDB\"];\n        O --> P[\"Frontend - Display Analysis / New Question\"];\n        P --> Q{\"Continue Recording?\"};\n        Q -- \"Yes\" --> G;\n    end\n\n    Q -- \"No / Finalize\" --> R[\"Frontend - Finalize Story\"];\n    R --> S(\"Backend - Story Finalization\");\n    S --> T[\"Frontend - Story Archived Confirmation\"];\n    F --> X[\"User - End Session\"];\n    T --> X;\n```\n\n### Navigation and information architecture principles\nNavigation will be intuitive, allowing users to easily move between primary sections like 'My Stories', 'Public Archive', and the story capture interface. A clear hierarchy will be maintained (Artifact 3 - Story Mapping).\n\n### Form design and data input patterns\nForms for registration (Requirement 2285) and metadata tagging (Requirement 2291) will feature clear labels, input validation, and assistive text to guide users.\n\n### Error handling and feedback mechanisms\nComprehensive error handling (Requirement 2298) will provide clear, immediate feedback for issues such as microphone access denial, API call failures, or processing errors. UI states will gracefully transition, and user-friendly messages will guide recovery or suggest support.","id":1848},"old":{"id":null,"content":null},"mode":"ai"},{"artifactType":"UIPreview","changeType":"create","status":"success","data":{"totalApproved":3,"id":[892,893,894],"pages":[{"genTimer":54691,"htmlContent":"<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n <meta charset=\"UTF-8\">\n <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n <title>Storycatcher II - Capture Your Legacy</title>\n <script src=\"https://cdn.tailwindcss.com\"></script>\n</head>\n<body class=\"min-h-screen bg-[#f0f8ff] text-[#2C3E50] font-sans flex flex-col\">\n\n <!-- Header/Navigation -->\n <header class=\"w-full py-4 px-6 md:px-12 flex justify-between items-center bg-white/50 backdrop-blur-sm shadow-md z-10\">\n <div class=\"flex items-center space-x-2\">\n <!-- Storycatcher II Logo/Icon -->\n <svg class=\"w-8 h-8 text-[#3178c6]\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5s3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18s-3.332.477-4.5 1.253\"></path>\n </svg>\n <span class=\"text-2xl font-bold text-[#2C3E50]\">Storycatcher II</span>\n </div>\n <nav class=\"space-x-4\">\n <a href=\"#\" class=\"text-[#607B8B] hover:text-[#3178c6] transition-colors duration-300\">Features</a>\n <a href=\"#\" class=\"text-[#607B8B] hover:text-[#3178c6] transition-colors duration-300\">About</a>\n <a href=\"#\" class=\"text-[#607B8B] hover:text-[#3178c6] transition-colors duration-300\">Contact</a>\n </nav>\n </header>\n\n <!-- Main Content - Hero Section -->\n <main class=\"flex-grow flex items-center justify-center py-12 px-6 md:px-12 lg:px-24\">\n <div class=\"w-full max-w-6xl bg-white/30 backdrop-blur-lg rounded-xl shadow-xl border border-white/50 p-8 md:p-12 lg:p-16 text-center\">\n <h1 class=\"text-4xl md:text-5xl lg:text-6xl font-bold text-[#2C3E50] leading-tight mb-6\">\n Capture Your Legacy.<br>Your Story, Your Privacy.\n </h1>\n <p class=\"text-lg md:text-xl text-[#607B8B] max-w-3xl mx-auto mb-10\">\n Storycatcher II empowers you to effortlessly record, transcribe, and archive your personal narratives with cutting-edge AI guidance and uncompromising privacy.\n Your memories, preserved locally, on your terms.\n </p>\n \n <div class=\"flex flex-col sm:flex-row justify-center items-center gap-6\">\n <!-- Call to Action: Register -->\n <a href=\"registration.html\" class=\"bg-gradient-to-r from-[#3178c6] to-[#2A65A4] text-white font-semibold py-3 px-8 rounded-full shadow-lg hover:from-[#2A65A4] hover:to-[#3178c6] hover:scale-105 transition-all duration-300 flex items-center justify-center group\">\n <svg class=\"w-6 h-6 mr-2 text-white group-hover:rotate-6 transition-transform\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z\"></path>\n </svg>\n Start Your Story\n </a>\n\n <!-- Call to Action: Login -->\n <a href=\"login.html\" class=\"bg-white text-[#3178c6] border border-[#3178c6] font-semibold py-3 px-8 rounded-full shadow-lg hover:bg-[#3178c6] hover:text-white hover:scale-105 transition-all duration-300 flex items-center justify-center group\">\n <svg class=\"w-6 h-6 mr-2 text-[#3178c6] group-hover:text-white\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1\"></path>\n </svg>\n Login\n </a>\n\n <!-- Call to Action: Public Archive -->\n <a href=\"public-archive.html\" class=\"bg-transparent text-[#3178c6] border border-[#3178c6] font-semibold py-3 px-8 rounded-full hover:bg-[#3178c6]/10 hover:scale-105 transition-all duration-300 flex items-center justify-center group\">\n <svg class=\"w-6 h-6 mr-2 text-[#3178c6]\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M21 12a9 9 0 11-18 0 9 9 0 0118 0z\"></path>\n <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M10 12H5M14 12h5M10 16H5M14 16h5M10 8H5M14 8h5M12 2.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5s3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18s-3.332.477-4.5 1.253\"></path>\n </svg>\n Explore Public Stories\n </a>\n </div>\n </div>\n </main>\n\n <!-- Feature Highlights Section -->\n <section class=\"w-full py-16 px-6 md:px-12 lg:px-24 bg-[#f0f8ff]\">\n <div class=\"max-w-6xl mx-auto grid grid-cols-1 md:grid-cols-3 gap-8\">\n <!-- Feature 1: Privacy First -->\n <div class=\"bg-white/50 backdrop-blur-sm rounded-xl shadow-lg p-6 flex flex-col items-center text-center hover:shadow-xl transition-all duration-300\">\n <div class=\"p-4 rounded-full bg-[#3178c6]/10 mb-4\">\n <svg class=\"w-10 h-10 text-[#3178c6]\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v3h8z\"></path>\n </svg>\n </div>\n <h3 class=\"text-xl font-semibold text-[#2C3E50] mb-3\">Privacy-First Approach</h3>\n <p class=\"text-[#607B8B]\">Your stories are stored locally on your device, ensuring complete data privacy and GDPR compliance. You control your narrative.</p>\n </div>\n\n <!-- Feature 2: AI-Guided Storytelling -->\n <div class=\"bg-white/50 backdrop-blur-sm rounded-xl shadow-lg p-6 flex flex-col items-center text-center hover:shadow-xl transition-all duration-300\">\n <div class=\"p-4 rounded-full bg-[#3178c6]/10 mb-4\">\n <svg class=\"w-10 h-10 text-[#3178c6]\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10\"></path>\n </svg>\n </div>\n <h3 class=\"text-xl font-semibold text-[#2C3E50] mb-3\">AI-Guided Storytelling</h3>\n <p class=\"text-[#607B8B]\">Our intelligent assistant uses the 5W method to prompt you with relevant questions, ensuring a rich and comprehensive narrative.</p>\n </div>\n\n <!-- Feature 3: Offline Capture & Management -->\n <div class=\"bg-white/50 backdrop-blur-sm rounded-xl shadow-lg p-6 flex flex-col items-center text-center hover:shadow-xl transition-all duration-300\">\n <div class=\"p-4 rounded-full bg-[#3178c6]/10 mb-4\">\n <svg class=\"w-10 h-10 text-[#3178c6]\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M8 9l3 3-3 3m5 0h3M5 20h14a2 2 0 002-2V6a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z\"></path>\n </svg>\n </div>\n <h3 class=\"text-xl font-semibold text-[#2C3E50] mb-3\">Seamless Offline Access</h3>\n <p class=\"text-[#607B8B]\">Capture and manage your stories anytime, anywhere, even without an internet connection. Data syncs when you're back online.</p>\n </div>\n </div>\n </section>\n\n <!-- Footer -->\n <footer class=\"w-full py-8 px-6 md:px-12 bg-[#2C3E50] text-white text-center\">\n <div class=\"max-w-6xl mx-auto flex flex-col md:flex-row justify-between items-center space-y-4 md:space-y-0\">\n <p class=\"text-sm text-[#607B8B]\">&copy; 2023 Storycatcher II. All rights reserved.</p>\n <div class=\"flex space-x-6\">\n <a href=\"#\" class=\"text-[#607B8B] hover:text-[#3178c6] transition-colors duration-300 text-sm\">Privacy Policy</a>\n <a href=\"#\" class=\"text-[#607B8B] hover:text-[#3178c6] transition-colors duration-300 text-sm\">Terms of Service</a>\n <a href=\"#\" class=\"text-[#607B8B] hover:text-[#3178c6] transition-colors duration-300 text-sm\">Support</a>\n </div>\n </div>\n </footer>\n\n</body>\n</html>","pageName":"Landing Page"},{"genTimer":106157,"htmlContent":"<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n <meta charset=\"UTF-8\">\n <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n <title>My Stories - Storycatcher II</title>\n <script src=\"https://cdn.tailwindcss.com\"></script>\n <style>\n /* Custom scrollbar for better aesthetics */\n ::-webkit-scrollbar {\n width: 8px;\n height: 8px;\n }\n ::-webkit-scrollbar-track {\n background: #f1f1f1;\n border-radius: 10px;\n }\n ::-webkit-scrollbar-thumb {\n background: #888;\n border-radius: 10px;\n }\n ::-webkit-scrollbar-thumb:hover {\n background: #555;\n }\n </style>\n</head>\n<body class=\"font-sans bg-[#f8fcf8] text-gray-800 antialiased min-h-screen flex flex-col\">\n\n <!-- Top Navigation Bar -->\n <header class=\"bg-white bg-opacity-70 backdrop-blur-lg shadow-lg py-4 px-6 md:px-8 flex flex-col md:flex-row items-center justify-between sticky top-0 z-50 border-b border-gray-200\">\n <div class=\"flex items-center justify-between w-full md:w-auto mb-4 md:mb-0\">\n <a href=\"#\" class=\"flex items-center space-x-2 text-[#388e3c] font-bold text-2xl transition-all duration-300 hover:text-[#2a6d2f]\">\n <!-- Storycatcher II Logo SVG - Geometric, simple -->\n <svg class=\"w-8 h-8\" fill=\"currentColor\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n <path d=\"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-1-13h2v6h-2zm0 8h2v2h-2z\"/>\n </svg>\n <span>Storycatcher II</span>\n </a>\n <!-- Mobile Menu Toggle -->\n <button class=\"md:hidden text-gray-700 hover:text-[#388e3c] focus:outline-none focus:ring-2 focus:ring-[#388e3c]\" id=\"mobile-menu-button\">\n <svg class=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M4 6h16M4 12h16M4 18h16\"></path>\n </svg>\n </button>\n </div>\n\n <!-- Navigation Links (Hidden on mobile by default) -->\n <nav class=\"w-full md:w-auto flex-col md:flex-row md:flex items-center space-y-4 md:space-y-0 md:space-x-8 text-lg hidden\" id=\"mobile-menu\">\n <a href=\"#\" class=\"text-gray-700 hover:text-[#388e3c] font-semibold transition-colors duration-200\">My Stories</a>\n <a href=\"#\" class=\"text-gray-700 hover:text-[#388e3c] transition-colors duration-200\">Public Archive</a>\n <a href=\"#\" class=\"text-gray-700 hover:text-[#388e3c] transition-colors duration-200\">New Story</a>\n <div class=\"relative group\">\n <button class=\"flex items-center text-gray-700 hover:text-[#388e3c] transition-colors duration-200 focus:outline-none\">\n <svg class=\"w-5 h-5 mr-1\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M3 5h12M9 3v2m1.048 9.5A18.022 18.022 0 018.672 16.5c-2.192 0-4.202.946-5.832 2.5a.5.5 0 01-.176.126.5.5 0 01-.362.007L2 19.5c.012 0 .012 0 .012 0A18.022 18.022 0 005.328 16.5c2.192 0 4.202-.946 5.832-2.5a.5.5 0 01.176-.126.5.5 0 01.362-.007L12 14.5c-.012 0-.012 0-.012 0A18.022 18.022 0 018.672 11.5c-2.192 0-4.202.946-5.832-2.5\"></path>\n </svg>\n Language\n <svg class=\"w-4 h-4 ml-1\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M19 9l-7 7-7-7\"></path>\n </svg>\n </button>\n <div class=\"absolute right-0 mt-2 w-32 bg-white rounded-lg shadow-xl py-2 opacity-0 group-hover:opacity-100 group-hover:translate-y-0 translate-y-2 transition-all duration-300 pointer-events-none group-hover:pointer-events-auto\">\n <a href=\"#\" class=\"block px-4 py-2 text-gray-800 hover:bg-gray-100\">English</a>\n <a href=\"#\" class=\"block px-4 py-2 text-gray-800 hover:bg-gray-100\">Deutsch</a>\n </div>\n </div>\n <a href=\"#\" class=\"bg-gradient-to-r from-[#388e3c] to-[#2a6d2f] text-white py-2 px-6 rounded-full font-semibold shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105\">Logout</a>\n </nav>\n </header>\n\n <main class=\"flex-grow container mx-auto px-4 py-8 md:py-12\">\n <div class=\"bg-white bg-opacity-70 backdrop-blur-lg rounded-2xl shadow-xl p-6 md:p-8 border border-[#c8e6c9]\">\n <div class=\"flex flex-col md:flex-row justify-between items-center mb-8 space-y-4 md:space-y-0\">\n <h1 class=\"text-4xl font-extrabold text-gray-900 leading-tight\">My Stories</h1>\n <a href=\"#\" class=\"bg-gradient-to-r from-[#388e3c] to-[#2a6d2f] text-white py-3 px-8 rounded-full font-semibold shadow-md hover:shadow-lg transition-all duration-300 hover:scale-105 flex items-center space-x-2\">\n <svg class=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M12 6v6m0 0v6m0-6h6m-6 0H6\"></path>\n </svg>\n <span>Start New Story</span>\n </a>\n </div>\n\n <!-- Filter and Sort Options -->\n <div class=\"flex flex-col sm:flex-row justify-between items-center mb-8 gap-4\">\n <div class=\"relative w-full sm:w-auto\">\n <select class=\"block appearance-none w-full bg-white border border-gray-300 text-gray-700 py-3 px-4 pr-8 rounded-lg leading-tight focus:outline-none focus:bg-white focus:border-[#388e3c] transition-all duration-200 shadow-sm hover:shadow-md\" id=\"sort-by\">\n <option>Sort by: Most Recent</option>\n <option>Sort by: Oldest</option>\n <option>Sort by: Title (A-Z)</option>\n </select>\n <div class=\"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700\">\n <svg class=\"fill-current h-4 w-4\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\"><path d=\"M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z\"/></svg>\n </div>\n </div>\n <div class=\"relative w-full sm:w-auto\">\n <select class=\"block appearance-none w-full bg-white border border-gray-300 text-gray-700 py-3 px-4 pr-8 rounded-lg leading-tight focus:outline-none focus:bg-white focus:border-[#388e3c] transition-all duration-200 shadow-sm hover:shadow-md\" id=\"filter-by\">\n <option>Filter by: All Stories</option>\n <option>Filter by: Drafts</option>\n <option>Filter by: Published</option>\n <option>Filter by: Tags</option>\n </select>\n <div class=\"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700\">\n <svg class=\"fill-current h-4 w-4\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\"><path d=\"M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z\"/></svg>\n </div>\n </div>\n </div>\n\n <!-- Story List/Grid -->\n <div class=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n\n <!-- Story Card 1 -->\n <div class=\"story-card bg-[#c8e6c9] bg-opacity-70 backdrop-blur-md rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-[1.02] border border-[#388e3c]/30 p-6 flex flex-col justify-between\">\n <div>\n <h3 class=\"text-xl font-bold text-gray-900 mb-2\">My Childhood Memories in Berlin</h3>\n <p class=\"text-gray-700 text-sm mb-4 line-clamp-3\">A vivid recollection of growing up in post-war Berlin, exploring the vibrant neighborhoods and the resilience of its people. Captured with AI guidance on historical context.</p>\n <div class=\"flex flex-wrap gap-2 mb-4\">\n <span class=\"text-xs bg-[#388e3c]/10 text-[#388e3c] px-3 py-1 rounded-full font-semibold\">#Childhood</span>\n <span class=\"text-xs bg-[#388e3c]/10 text-[#388e3c] px-3 py-1 rounded-full font-semibold\">#Berlin</span>\n <span class=\"text-xs bg-[#388e3c]/10 text-[#388e3c] px-3 py-1 rounded-full font-semibold\">#History</span>\n </div>\n </div>\n <div class=\"flex items-center justify-between text-sm text-gray-500 mt-4\">\n <span>Archived: 2023-10-26</span>\n <div class=\"flex space-x-2\">\n <a href=\"#\" class=\"text-[#388e3c] hover:text-[#2a6d2f] transition-colors duration-200\" title=\"Edit Story\">\n <svg class=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z\"></path>\n </svg>\n </a>\n <a href=\"#\" class=\"text-[#388e3c] hover:text-[#2a6d2f] transition-colors duration-200\" title=\"Share/Export\">\n <svg class=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"1.5\" d=\"M13.5 6H5.25A2.25 2.25 0 003 8.25v10.5A2.25 2.25 0 005.25 21h10.5A2.25 2.25 0 0018 18.75V10.5m-10.5 6L21 3m0 0l-7.5 7.5M21 3v7.5\"></path>\n </svg>\n </a>\n </div>\n </div>\n </div>\n\n <!-- Story Card 2 -->\n <div class=\"story-card bg-[#c8e6c9] bg-opacity-70 backdrop-blur-md rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-[1.02] border border-[#388e3c]/30 p-6 flex flex-col justify-between\">\n <div>\n <h3 class=\"text-xl font-bold text-gray-900 mb-2\">The Old Oak Tree by the River</h3>\n <p class=\"text-gray-700 text-sm mb-4 line-clamp-3\">A heartwarming tale of a beloved oak tree, witnessing generations of family picnics and whispered secrets. A metaphor for enduring legacy and quiet strength.</p>\n <div class=\"flex flex-wrap gap-2 mb-4\">\n <span class=\"text-xs bg-[#388e3c]/10 text-[#388e3c] px-3 py-1 rounded-full font-semibold\">#Nature</span>\n <span class=\"text-xs bg-[#388e3c]/10 text-[#388e3c] px-3 py-1 rounded-full font-semibold\">#Family</span>\n <span class=\"text-xs bg-[#388e3c]/10 text-[#388e3c] px-3 py-1 rounded-full font-semibold\">#Legacy</span>\n </div>\n </div>\n <div class=\"flex items-center justify-between text-sm text-gray-500 mt-4\">\n <span>Archived: 2023-09-15</span>\n <div class=\"flex space-x-2\">\n <a href=\"#\" class=\"text-[#388e3c] hover:text-[#2a6d2f] transition-colors duration-200\" title=\"Edit Story\">\n <svg class=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z\"></path>\n </svg>\n </a>\n <a href=\"#\" class=\"text-[#388e3c] hover:text-[#2a6d2f] transition-colors duration-200\" title=\"Share/Export\">\n <svg class=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"1.5\" d=\"M13.5 6H5.25A2.25 2.25 0 003 8.25v10.5A2.25 2.25 0 005.25 21h10.5A2.25 2.25 0 0018 18.75V10.5m-10.5 6L21 3m0 0l-7.5 7.5M21 3v7.5\"></path>\n </svg>\n </a>\n </div>\n </div>\n </div>\n\n <!-- Story Card 3 -->\n <div class=\"story-card bg-[#c8e6c9] bg-opacity-70 backdrop-blur-md rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-[1.02] border border-[#388e3c]/30 p-6 flex flex-col justify-between\">\n <div>\n <h3 class=\"text-xl font-bold text-gray-900 mb-2\">Grandma's Secret Recipe</h3>\n <p class=\"text-gray-700 text-sm mb-4 line-clamp-3\">A cherished family recipe, passed down through generations, along with the stories and traditions associated with its preparation. A true taste of heritage.</p>\n <div class=\"flex flex-wrap gap-2 mb-4\">\n <span class=\"text-xs bg-[#388e3c]/10 text-[#388e3c] px-3 py-1 rounded-full font-semibold\">#FamilyRecipe</span>\n <span class=\"text-xs bg-[#388e3c]/10 text-[#388e3c] px-3 py-1 rounded-full font-semibold\">#Tradition</span>\n <span class=\"text-xs bg-[#388e3c]/10 text-[#388e3c] px-3 py-1 rounded-full font-semibold\">#Food</span>\n </div>\n </div>\n <div class=\"flex items-center justify-between text-sm text-gray-500 mt-4\">\n <span>Archived: 2023-08-01</span>\n <div class=\"flex space-x-2\">\n <a href=\"#\" class=\"text-[#388e3c] hover:text-[#2a6d2f] transition-colors duration-200\" title=\"Edit Story\">\n <svg class=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z\"></path>\n </svg>\n </a>\n <a href=\"#\" class=\"text-[#388e3c] hover:text-[#2a6d2f] transition-colors duration-200\" title=\"Share/Export\">\n <svg class=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"1.5\" d=\"M13.5 6H5.25A2.25 2.25 0 003 8.25v10.5A2.25 2.25 0 005.25 21h10.5A2.25 2.25 0 0018 18.75V10.5m-10.5 6L21 3m0 0l-7.5 7.5M21 3v7.5\"></path>\n </svg>\n </a>\n </div>\n </div>\n </div>\n\n <!-- Story Card 4 -->\n <div class=\"story-card bg-[#c8e6c9] bg-opacity-70 backdrop-blur-md rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-[1.02] border border-[#388e3c]/30 p-6 flex flex-col justify-between\">\n <div>\n <h3 class=\"text-xl font-bold text-gray-900 mb-2\">First Solo Trip: Discovering Myself</h3>\n <p class=\"text-gray-700 text-sm mb-4 line-clamp-3\">The transformative journey of a solo backpacking trip through Southeast Asia, filled with unexpected challenges, personal growth, and breathtaking landscapes.</p>\n <div class=\"flex flex-wrap gap-2 mb-4\">\n <span class=\"text-xs bg-[#388e3c]/10 text-[#388e3c] px-3 py-1 rounded-full font-semibold\">#Travel</span>\n <span class=\"text-xs bg-[#388e3c]/10 text-[#388e3c] px-3 py-1 rounded-full font-semibold\">#Adventure</span>\n <span class=\"text-xs bg-[#388e3c]/10 text-[#388e3c] px-3 py-1 rounded-full font-semibold\">#SelfDiscovery</span>\n </div>\n </div>\n <div class=\"flex items-center justify-between text-sm text-gray-500 mt-4\">\n <span>Archived: 2023-07-05</span>\n <div class=\"flex space-x-2\">\n <a href=\"#\" class=\"text-[#388e3c] hover:text-[#2a6d2f] transition-colors duration-200\" title=\"Edit Story\">\n <svg class=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z\"></path>\n </svg>\n </a>\n <a href=\"#\" class=\"text-[#388e3c] hover:text-[#2a6d2f] transition-colors duration-200\" title=\"Share/Export\">\n <svg class=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"1.5\" d=\"M13.5 6H5.25A2.25 2.25 0 003 8.25v10.5A2.25 2.25 0 005.25 21h10.5A2.25 2.25 0 0018 18.75V10.5m-10.5 6L21 3m0 0l-7.5 7.5M21 3v7.5\"></path>\n </svg>\n </a>\n </div>\n </div>\n </div>\n\n <!-- Placeholder for no stories -->\n <div class=\"md:col-span-2 lg:col-span-3 text-center py-12 text-gray-500\" id=\"no-stories-placeholder\" style=\"display: none;\">\n <svg class=\"mx-auto w-16 h-16 text-gray-400 mb-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"1.5\" d=\"M9 13h6m-3-3v6m-9 1V7a2 2 0 012-2h6l2 2h6a2 2 0 012 2v8a2 2 0 01-2 2H5a2 2 0 01-2-2z\"></path>\n </svg>\n <p class=\"text-xl font-semibold mb-2\">No stories yet!</p>\n <p class=\"text-md\">Start capturing your memories by clicking the \"Start New Story\" button above.</p>\n </div>\n\n </div>\n </div>\n </main>\n\n <footer class=\"bg-gray-100 bg-opacity-70 backdrop-blur-lg mt-8 py-6 text-center text-gray-600 border-t border-gray-200\">\n <p>&copy; 2023 Storycatcher II. All rights reserved. <span class=\"ml-2\">Privacy Policy</span></p>\n </footer>\n\n <script>\n // Mobile menu toggle logic\n document.getElementById('mobile-menu-button').addEventListener('click', function() {\n const mobileMenu = document.getElementById('mobile-menu');\n mobileMenu.classList.toggle('hidden');\n mobileMenu.classList.toggle('flex');\n });\n\n // Example: Show/hide no stories placeholder if no story cards are present\n const storyCardsContainer = document.querySelector('.grid.gap-6');\n const storyCards = storyCardsContainer ? storyCardsContainer.querySelectorAll('.story-card') : [];\n const noStoriesPlaceholder = document.getElementById('no-stories-placeholder');\n\n if (storyCards.length === 0) {\n noStoriesPlaceholder.style.display = 'block';\n } else {\n noStoriesPlaceholder.style.display = 'none';\n }\n </script>\n</body>\n</html>","pageName":"My Stories Page"},{"htmlContent":"<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n <meta charset=\"UTF-8\">\n <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n <title>Story Capture - Storycatcher II</title>\n <script src=\"https://cdn.tailwindcss.com\"></script>\n <style>\n /* Custom scrollbar for better aesthetics */\n .custom-scrollbar::-webkit-scrollbar {\n width: 8px;\n }\n .custom-scrollbar::-webkit-scrollbar-track {\n background: #f8e8d8; /* Slightly darker than main bg for track */\n border-radius: 10px;\n }\n .custom-scrollbar::-webkit-scrollbar-thumb {\n background: #e65100; /* Accent color for thumb */\n border-radius: 10px;\n }\n .custom-scrollbar::-webkit-scrollbar-thumb:hover {\n background: #d84300; /* Darker accent on hover */\n }\n </style>\n</head>\n<body class=\"font-sans antialiased text-gray-800 bg-[#fff3e0] min-h-screen flex flex-col\">\n\n <!-- Navigation Header -->\n <header class=\"w-full bg-[#f8e8d8] shadow-md py-4 px-6 md:px-8 flex items-center justify-between\">\n <a href=\"#\" class=\"flex items-center text-gray-800 hover:text-[#e65100] transition-all duration-300\">\n <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" class=\"w-6 h-6 mr-2\">\n <path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18\" />\n </svg>\n <span class=\"font-semibold text-lg\">My Stories</span>\n </a>\n <h1 class=\"text-2xl md:text-3xl font-bold text-[#e65100]\">Storycatcher II</h1>\n <div class=\"w-12\"></div> <!-- Spacer to balance flex -->\n </header>\n\n <!-- Main Content Area -->\n <main class=\"flex-1 container mx-auto p-4 md:p-8 lg:p-10 flex flex-col items-center justify-center\">\n\n <div class=\"w-full max-w-5xl grid grid-cols-1 md:grid-cols-2 gap-6 mb-8\">\n\n <!-- Recording Controls Card -->\n <div class=\"bg-white/30 backdrop-blur-lg rounded-xl p-6 shadow-xl border border-white border-opacity-40 flex flex-col items-center justify-between text-center transition-all duration-300 hover:shadow-2xl\">\n <h2 class=\"text-xl md:text-2xl font-semibold mb-4 text-[#e65100]\">Story Capture</h2>\n \n <!-- Microphone Status -->\n <div class=\"flex items-center space-x-3 mb-6\">\n <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"currentColor\" class=\"w-8 h-8 text-green-500 animate-pulse\">\n <path d=\"M12 2A4 4 0 008 6v4a4 4 0 008 0V6a4 4 0 00-4-4z\" />\n <path fill-rule=\"evenodd\" d=\"M7 11.5a.5.5 0 01.5-.5h9a.5.5 0 01.5.5v.5a.5.5 0 01-.5.5h-9a.5.5 0 01-.5-.5v-.5zM12 18a6 6 0 006-6v-1a.5.5 0 011 0v1a7 7 0 01-14 0v-1a.5.5 0 011 0v1a6 6 0 006 6z\" clip-rule=\"evenodd\" />\n <path d=\"M12 18.5a.5.5 0 01.5.5v.5a.5.5 0 01-.5.5h-1a.5.5 0 01-.5-.5v-.5a.5.5 0 01.5-.5h1z\" />\n </svg>\n <span class=\"text-lg font-medium text-gray-700\">Recording...</span>\n </div>\n\n <!-- Recording Duration -->\n <p class=\"text-4xl md:text-5xl font-bold text-gray-900 mb-8\">00:01:45</p>\n\n <!-- Recording Controls -->\n <div class=\"flex space-x-6\">\n <button class=\"p-4 rounded-full bg-gray-200 text-gray-700 hover:bg-gray-300 transition-all duration-300 shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-[#e65100]\">\n <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"currentColor\" viewBox=\"0 0 24 24\" stroke-width=\"1.5\" stroke=\"currentColor\" class=\"w-8 h-8\">\n <path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M15.75 5.25v13.5m-7.5-13.5v13.5\" />\n </svg>\n </button>\n <button class=\"p-4 rounded-full bg-[#e65100] text-white hover:bg-[#d84300] transition-all duration-300 shadow-xl hover:shadow-2xl focus:outline-none focus:ring-2 focus:ring-[#e65100]\">\n <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"currentColor\" viewBox=\"0 0 24 24\" stroke-width=\"1.5\" stroke=\"currentColor\" class=\"w-8 h-8\">\n <path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M5.25 7.5A2.25 2.25 0 017.5 5.25h9A2.25 2.25 0 0118.75 7.5v9a2.25 2.25 0 01-2.25 2.25h-9A2.25 2.25 0 015.25 16.5v-9z\" />\n </svg>\n </button>\n </div>\n </div>\n\n <!-- AI-Guided Question Card -->\n <div class=\"bg-white/30 backdrop-blur-lg rounded-xl p-6 shadow-xl border border-white border-opacity-40 flex flex-col justify-between transition-all duration-300 hover:shadow-2xl\">\n <h2 class=\"text-xl md:text-2xl font-semibold mb-4 text-[#e65100]\">AI Assistant</h2>\n <div class=\"flex-1 flex flex-col justify-center items-center text-center\">\n <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" stroke-width=\"1.5\" stroke=\"currentColor\" class=\"w-16 h-16 text-gray-500 mb-4\">\n <path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M12 18v-5.25m0 0a6.01 6.01 0 001.5-1.052c1.331-.269 2.671-.53 4-1.248m-4 1.248a6.01 6.01 0 01-1.5-1.052c-1.331-.269-2.671-.53-4-1.248m0 0hd2.25m2.25 0h-2.25M6 12.75V12A6 6 0 0112 6V4m-.75 2.25L7.5 10.5m0 0l3.625-1.353M12 18.75V19a2.25 2.25 0 002.25 2.25h.25A2.25 2.25 0 0017 19v-.25m-4.5-5.625h2.25H12Z\" />\n </svg>\n <p class=\"text-lg md:text-xl font-medium text-gray-700 leading-relaxed\">\n \"Can you tell me more about the people involved in this memory? Who was there, and what roles did they play?\"\n </p>\n </div>\n <div class=\"mt-6 text-sm text-gray-500\">\n Next question in 5 seconds...\n </div>\n </div>\n\n </div>\n\n <div class=\"w-full max-w-5xl grid grid-cols-1 lg:grid-cols-3 gap-6\">\n\n <!-- Real-time Transcript Card -->\n <div class=\"lg:col-span-2 bg-white/30 backdrop-blur-lg rounded-xl p-6 shadow-xl border border-white border-opacity-40 flex flex-col transition-all duration-300 hover:shadow-2xl\">\n <h2 class=\"text-xl md:text-2xl font-semibold mb-4 text-[#e65100]\">Real-time Transcript</h2>\n <div class=\"flex-1 overflow-y-auto h-64 md:h-80 lg:h-96 custom-scrollbar pr-2\">\n <p class=\"text-gray-700 text-base leading-relaxed\">\n <span class=\"font-semibold text-gray-900\">User:</span> It was a warm summer evening, just like this one, back in '98. The air was thick with the smell of jasmine and freshly cut grass. My grandmother was sitting on the porch swing, humming an old folk song. My grandfather was tending to his rose bushes, meticulously trimming each stem. I remember feeling so peaceful, just watching them. It felt like time stood still, a perfect moment captured forever.\n <br><br>\n <span class=\"font-semibold text-gray-900\">AI:</span> Can you tell me more about the people involved in this memory? Who was there, and what roles did they play?\n <br><br>\n <span class=\"font-semibold text-gray-900\">User:</span> Yes, my grandmother, Elara, was the heart of our home. She always had a story to tell, a song to sing, and a warm hug ready. My grandfather, Arthur, was more reserved, but his love was evident in the way he cared for his garden, which was truly his pride and joy. He taught me the importance of patience and nurturing. And then there was my dog, Buster, a scruffy terrier mix who would always nap at my feet, a silent guardian of our family moments.\n <br><br>\n <span class=\"font-semibold text-gray-900\">AI:</span> What was the significance of the rose bushes to your grandfather? Did they hold any special meaning or stories?\n <br><br>\n <span class=\"font-semibold text-gray-900\">User:</span> The rose bushes were more than just plants to him. Each one had a name, a story. The deep red one, he called 'Memory Lane,' because it reminded him of his courtship with my grandmother. The vibrant yellow one was 'Sunshine,' named after my mother's bright disposition. He believed that tending to them was like tending to our family's history, always growing, always beautiful, but requiring constant care. He'd tell us stories of where he got each rose, the special occasions they marked, and the lessons he learned from their cycles of bloom and dormancy.\n <br><br>\n <span class=\"font-semibold text-gray-900\">AI:</span> How did these moments on the porch shape your understanding of family and tradition?\n </p>\n </div>\n </div>\n\n <!-- Segment Summary Card -->\n <div class=\"bg-white/30 backdrop-blur-lg rounded-xl p-6 shadow-xl border border-white border-opacity-40 flex flex-col transition-all duration-300 hover:shadow-2xl\">\n <h2 class=\"text-xl md:text-2xl font-semibold mb-4 text-[#e65100]\">Current Segment Summary</h2>\n <div class=\"flex-1 overflow-y-auto custom-scrollbar pr-2\">\n <p class=\"text-gray-700 text-base leading-relaxed\">\n The user describes the significance of their grandfather's rose bushes, each named after a family memory or person. 'Memory Lane' (red) symbolizes his courtship, and 'Sunshine' (yellow) represents his daughter. He viewed tending the roses as nurturing family history, sharing stories of their origins and the life lessons derived from their growth cycles.\n </p>\n </div>\n </div>\n\n </div>\n\n </main>\n\n <!-- Footer with Finalize Button -->\n <footer class=\"w-full bg-[#f8e8d8] shadow-md py-4 px-6 md:px-8 flex justify-center\">\n <button class=\"px-8 py-3 bg-[#e65100] text-white font-semibold rounded-full shadow-lg hover:bg-[#d84300] transition-all duration-300 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-[#e65100] focus:ring-offset-2\">\n <div class=\"flex items-center space-x-2\">\n <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" class=\"w-6 h-6\">\n <path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M9 12.75L11.25 15L15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" />\n </svg>\n <span>Finalize Story & Archive</span>\n </div>\n </button>\n </footer>\n\n</body>\n</html>","genTimer":30406,"pageName":"Story Capture Page"}],"totalGenerated":3},"old":{"content":null,"id":null},"mode":"ai"},{"artifactType":"API","changeType":"create","status":"success","data":{"content":"# API Specification: Storycatcher II\n\n## API Overview\n\nStorycatcher II's API is designed to support a privacy-centric, local-first storytelling application. It provides secure access, AI-guided story capture, and robust story management, with a strong emphasis on GDPR compliance. The backend, built with Node.js/Express.js, serves as an API Gateway and processes sensitive data (audio transcription) on a local-first basis, minimizing external exposure.\n\n**Architecture and Design Principles:**\nThe API follows a RESTful design, enabling client-server communication. A core principle is \"local-first\" data handling (Req 2287, 2289, 2290), where sensitive story content (raw audio, full transcripts) is processed and stored primarily on the user's device. The backend manages user authentication, story metadata, AI guidance, and facilitates consented export/sharing.\n\n**Authentication and Authorization:**\nUser authentication (Req 2285) is handled via JSON Web Tokens (JWT). Upon successful login, a JWT is issued to the client, which must be included in the `Authorization` header (`Bearer <token>`) for all subsequent protected API calls. Authorization for user-specific resources (e.g., `My Stories`) is based on the authenticated user's ID. Public resources (e.g., `Public Archive`) do not require authentication.\n\n**Base URL, Versioning, and Rate Limiting:**\n*   **Base URL**: `https://api.storycatcher.com/v1` (Placeholder for MVP, actual URL will be configured via Docker Compose - Req 2296, 2299).\n*   **Versioning**: `v1` (Initial version, indicated in the base URL).\n*   **Rate Limiting**: Not implemented for MVP. Future considerations will include rate limiting to prevent abuse and ensure performance (Req 2301).\n\n## Endpoint Documentation\n\n### Authentication\n\n#### 1. User Registration\n*   **Endpoint**: `POST /auth/register`\n*   **Description**: Registers a new user account (Req 2285).\n*   **Request Body**:\n    ```json\n    {\n      \"username\": \"string\",\n      \"email\": \"string\",\n      \"password\": \"string\"\n    }\n    ```\n*   **Response**:\n    *   **201 Created**:\n        ```json\n        {\n          \"message\": \"User registered successfully\",\n          \"userId\": \"string\",\n          \"token\": \"string\"\n        }\n        ```\n    *   **400 Bad Request**: Invalid input (e.g., missing fields, weak password).\n    *   **409 Conflict**: Username or email already exists.\n*   **Example**:\n    ```bash\n    curl -X POST -H \"Content-Type: application/json\" -d '{\"username\": \"testuser\", \"email\": \"test@example.com\", \"password\": \"SecurePassword123!\"}' https://api.storycatcher.com/v1/auth/register\n    ```\n\n#### 2. User Login\n*   **Endpoint**: `POST /auth/login`\n*   **Description**: Authenticates an existing user (Req 2285).\n*   **Request Body**:\n    ```json\n    {\n      \"email\": \"string\",\n      \"password\": \"string\"\n    }\n    ```\n*   **Response**:\n    *   **200 OK**:\n        ```json\n        {\n          \"message\": \"Login successful\",\n          \"userId\": \"string\",\n          \"token\": \"string\"\n        }\n        ```\n    *   **401 Unauthorized**: Invalid credentials.\n*   **Example**:\n    ```bash\n    curl -X POST -H \"Content-Type: application/json\" -d '{\"email\": \"test@example.com\", \"password\": \"SecurePassword123!\"}' https://api.storycatcher.com/v1/auth/login\n    ```\n\n### Story Processing & Management\n\n#### 3. Process Audio Segment\n*   **Endpoint**: `POST /stories/segment`\n*   **Description**: Receives an audio segment for local-first STT transcription and AI-guided question generation (Req 2287, 2286, 2288).\n*   **Request Body**: `multipart/form-data` containing audio file.\n    *   `audioFile`: Binary audio data (e.g., `audio/wav`, `audio/webm`).\n    *   `storyId`: String (Optional, for existing story context).\n*   **Response**:\n    *   **200 OK**:\n        ```json\n        {\n          \"transcript\": \"string\",\n          \"summary\": \"string\",\n          \"nextQuestion\": \"string\",\n          \"storyId\": \"string\"\n        }\n        ```\n    *   **400 Bad Request**: Invalid audio format or missing data.\n    *   **500 Internal Server Error**: STT or AI processing failure (Req 2298).\n*   **Example**:\n    ```bash\n    curl -X POST -H \"Authorization: Bearer <token>\" -F \"audioFile=@/path/to/audio.wav\" -F \"storyId=existing-story-123\" https://api.storycatcher.com/v1/stories/segment\n    ```\n\n#### 4. Finalize Story\n*   **Endpoint**: `POST /stories/finalize`\n*   **Description**: Marks a story as finalized after interactive capture (Req 2288).\n*   **Request Body**:\n    ```json\n    {\n      \"storyId\": \"string\",\n      \"title\": \"string\",\n      \"description\": \"string\",\n      \"localStoryIdentifier\": \"string\"\n    }\n    ```\n*   **Response**:\n    *   **200 OK**:\n        ```json\n        {\n          \"message\": \"Story finalized and metadata saved\",\n          \"storyId\": \"string\"\n        }\n        ```\n    *   **400 Bad Request**: Missing `storyId` or `localStoryIdentifier`.\n    *   **404 Not Found**: Story not found for the user.\n*   **Example**:\n    ```bash\n    curl -X POST -H \"Authorization: Bearer <token>\" -H \"Content-Type: application/json\" -d '{\"storyId\": \"new-story-abc\", \"title\": \"My Life Story\", \"description\": \"A journey through my childhood.\", \"localStoryIdentifier\": \"indexeddb-id-xyz\"}' https://api.storycatcher.com/v1/stories/finalize\n    ```\n\n#### 5. Get User Stories\n*   **Endpoint**: `GET /stories`\n*   **Description**: Retrieves metadata for all stories belonging to the authenticated user (Req 2292).\n*   **Response**:\n    *   **200 OK**:\n        ```json\n        [\n          {\n            \"storyId\": \"string\",\n            \"title\": \"string\",\n            \"description\": \"string\",\n            \"isPublic\": \"boolean\",\n            \"createdAt\": \"datetime\",\n            \"updatedAt\": \"datetime\",\n            \"tags\": [\n              {\"type\": \"string\", \"value\": \"string\"}\n            ]\n          }\n        ]\n        ```\n    *   **401 Unauthorized**: Missing or invalid token.\n*   **Example**:\n    ```bash\n    curl -X GET -H \"Authorization: Bearer <token>\" https://api.storycatcher.com/v1/stories\n    ```\n\n#### 6. Update Story Metadata\n*   **Endpoint**: `PUT /stories/{story_id}/metadata`\n*   **Description**: Updates metadata for a specific story (Req 2291, 2292).\n*   **Path Parameters**: `story_id` (string) - The ID of the story.\n*   **Request Body**:\n    ```json\n    {\n      \"title\": \"string\",\n      \"description\": \"string\",\n      \"tags\": [\n        {\"type\": \"string\", \"value\": \"string\"}\n      ]\n    }\n    ```\n*   **Response**:\n    *   **200 OK**:\n        ```json\n        {\n          \"message\": \"Story metadata updated successfully\",\n          \"storyId\": \"string\"\n        }\n        ```\n    *   **400 Bad Request**: Invalid input.\n    *   **401 Unauthorized**: Missing or invalid token.\n    *   **403 Forbidden**: User does not own the story.\n    *   **404 Not Found**: Story does not exist.\n*   **Example**:\n    ```bash\n    curl -X PUT -H \"Authorization: Bearer <token>\" -H \"Content-Type: application/json\" -d '{\"title\": \"My Childhood Memories\", \"tags\": [{\"type\": \"temporal\", \"value\": \"1990s\"}, {\"type\": \"general\", \"value\": \"family\"}]}' https://api.storycatcher.com/v1/stories/story-123/metadata\n    ```\n\n#### 7. Export/Share Story\n*   **Endpoint**: `POST /stories/{story_id}/export`\n*   **Description**: Exports a story in a specified format or prepares it for public sharing, requiring explicit consent (Req 2293, 2290).\n*   **Path Parameters**: `story_id` (string) - The ID of the story.\n*   **Request Body**:\n    ```json\n    {\n      \"format\": \"string\",  // e.g., \"PDF\", \"Podcast\", \"Timeline\"\n      \"isPublic\": \"boolean\", // True if user explicitly consents to public sharing\n      \"consentGranted\": \"boolean\" // Must be true if isPublic is true\n    }\n    ```\n*   **Response**:\n    *   **200 OK**:\n        ```json\n        {\n          \"message\": \"Story export/share initiated\",\n          \"downloadUrl\": \"string\" // Optional, for direct downloads\n        }\n        ```\n    *   **400 Bad Request**: Invalid format, missing `consentGranted` for public sharing.\n    *   **401 Unauthorized**: Missing or invalid token.\n    *   **403 Forbidden**: User does not own the story.\n    *   **404 Not Found**: Story does not exist.\n*   **Example**:\n    ```bash\n    curl -X POST -H \"Authorization: Bearer <token>\" -H \"Content-Type: application/json\" -d '{\"format\": \"PDF\", \"isPublic\": true, \"consentGranted\": true}' https://api.storycatcher.com/v1/stories/story-123/export\n    ```\n\n### Public Archive\n\n#### 8. Get Public Stories\n*   **Endpoint**: `GET /public/stories`\n*   **Description**: Retrieves metadata for stories explicitly consented for public viewing (Req 2295).\n*   **Response**:\n    *   **200 OK**:\n        ```json\n        [\n          {\n            \"storyId\": \"string\",\n            \"title\": \"string\",\n            \"description\": \"string\",\n            \"authorUsername\": \"string\",\n            \"createdAt\": \"datetime\",\n            \"tags\": [\n              {\"type\": \"string\", \"value\": \"string\"}\n            ]\n          }\n        ]\n        ```\n*   **Example**:\n    ```bash\n    curl -X GET https://api.storycatcher.com/v1/public/stories\n    ```\n\n#### 9. Get Single Public Story\n*   **Endpoint**: `GET /public/stories/{story_id}`\n*   **Description**: Retrieves the full content of a single public story (Req 2295).\n*   **Path Parameters**: `story_id` (string) - The ID of the public story.\n*   **Response**:\n    *   **200 OK**:\n        ```json\n        {\n          \"storyId\": \"string\",\n          \"title\": \"string\",\n          \"description\": \"string\",\n          \"authorUsername\": \"string\",\n          \"fullTranscript\": \"string\",\n          \"summary\": \"string\",\n          \"createdAt\": \"datetime\",\n          \"tags\": [\n            {\"type\": \"string\", \"value\": \"string\"}\n          ]\n        }\n        ```\n    *   **404 Not Found**: Story does not exist or is not public.\n*   **Example**:\n    ```bash\n    curl -X GET https://api.storycatcher.com/v1/public/stories/public-story-456\n    ```\n\n## Data Models & Security\n\n### Request/Response Object Schemas\n\n**User Credentials (for /auth/register, /auth/login)**\n```json\n{\n  \"username\": { \"type\": \"string\", \"description\": \"User's unique username\" },\n  \"email\": { \"type\": \"string\", \"format\": \"email\", \"description\": \"User's email address\" },\n  \"password\": { \"type\": \"string\", \"minLength\": 8, \"description\": \"User's password\" }\n}\n```\n\n**Token Response**\n```json\n{\n  \"userId\": { \"type\": \"string\", \"description\": \"Unique identifier for the user\" },\n  \"token\": { \"type\": \"string\", \"description\": \"JWT for authentication\" }\n}\n```\n\n**Story Metadata (based on STORY_METADATA entity)**\n```json\n{\n  \"storyId\": { \"type\": \"string\", \"description\": \"Unique ID for the story\" },\n  \"title\": { \"type\": \"string\", \"description\": \"Title of the story\" },\n  \"description\": { \"type\": \"string\", \"description\": \"Brief description of the story\" },\n  \"isPublic\": { \"type\": \"boolean\", \"description\": \"True if story is publicly consented\" },\n  \"localStoryIdentifier\": { \"type\": \"string\", \"description\": \"Client-side identifier for local content\" },\n  \"createdAt\": { \"type\": \"string\", \"format\": \"date-time\", \"description\": \"Creation timestamp\" },\n  \"updatedAt\": { \"type\": \"string\", \"format\": \"date-time\", \"description\": \"Last update timestamp\" },\n  \"tags\": { \"type\": \"array\", \"items\": { \"$ref\": \"#/components/schemas/StoryTag\" } }\n}\n```\n\n**Story Tag (based on STORY_TAG entity)**\n```json\n{\n  \"type\": { \"type\": \"string\", \"description\": \"Category of the tag (e.g., geo, temporal)\" },\n  \"value\": { \"type\": \"string\", \"description\": \"Value of the tag\" }\n}\n```\n\n**Interview Log (based on INTERVIEW_QUESTION_LOG entity)**\n```json\n{\n  \"logId\": { \"type\": \"string\", \"description\": \"Unique ID for the log entry\" },\n  \"storyId\": { \"type\": \"string\", \"description\": \"Associated story ID\" },\n  \"questionText\": { \"type\": \"string\", \"description\": \"AI-generated question\" },\n  \"promptTimestamp\": { \"type\": \"string\", \"format\": \"date-time\", \"description\": \"Timestamp when question was prompted\" },\n  \"aiModelUsed\": { \"type\": \"string\", \"description\": \"Identifier of AI model\" }\n}\n```\n\n### Authentication Mechanisms\n\n*   **JWT (JSON Web Tokens)**: Used for stateless authentication. Tokens are signed by the backend and verified on each protected request. Clients must store tokens securely (e.g., HttpOnly cookies or Web Storage with appropriate security measures).\n\n### Security Headers and CORS Policies\n\n*   **HTTPS/TLS**: All API communications are secured with HTTPS/TLS (Req 2299, Artifact 6).\n*   **CORS (Cross-Origin Resource Sharing)**: The backend is configured with appropriate CORS headers to allow communication only from authorized frontend origins (Req 2299, Artifact 9). This prevents unauthorized cross-origin requests.\n    *   Example CORS configuration (conceptual, implementation specific):\n        ```\n        Access-Control-Allow-Origin: <frontend-origin>\n        Access-Control-Allow-Methods: GET, POST, PUT, DELETE, OPTIONS\n        Access-Control-Allow-Headers: Content-Type, Authorization\n        ```\n*   **Secure API Key Management**: Sensitive API keys for LLM providers are stored using environment variables and `.env` files, never hardcoded or committed to version control (Req 2297, Artifact 9).\n\n## Integration Guidelines\n\n### Client Integration Patterns\n\n*   **RESTful API Calls**: The frontend (React/JavaScript UI) will make standard RESTful HTTP requests to the backend.\n*   **Authentication Flow**:\n    1.  User registers/logs in via `/auth/register` or `/auth/login`.\n    2.  Backend returns a JWT.\n    3.  Frontend stores the JWT securely.\n    4.  For subsequent protected requests, the frontend includes the JWT in the `Authorization: Bearer <token>` header.\n*   **Audio Streaming**: Audio segments are sent as `multipart/form-data` to `/stories/segment` (Req 2288).\n*   **Local Data Sync**: Story metadata (`StoryMetadata`, `StoryTag`, `InterviewQuestionLog`) is synchronized with the backend, while the actual story content (audio, full transcript) remains local on the client (IndexedDB/localStorage - Req 2289).\n\n### Error Handling and Retry Strategies\n\n*   **HTTP Status Codes**: API responses use standard HTTP status codes (e.g., 200 OK, 201 Created, 400 Bad Request, 401 Unauthorized, 403 Forbidden, 404 Not Found, 500 Internal Server Error) (Req 2298).\n*   **JSON Error Responses**: In case of errors, the API returns a JSON object with `message` and optionally `details` fields for clear feedback (Req 2298).\n    ```json\n    {\n      \"error\": \"string\",\n      \"message\": \"string\",\n      \"details\": \"string\"\n    }\n    ```\n*   **Retry Strategy**: For transient errors (e.g., 5xx server errors, network issues), clients should implement an exponential backoff retry strategy to avoid overwhelming the server and improve resilience.\n\n### SDK Recommendations\n\n*   No specific SDKs are recommended for the MVP. Standard HTTP client libraries (e.g., `fetch` API in JavaScript) are sufficient for integration.","id":1849},"old":{"content":null,"id":null},"mode":"ai"},{"artifactType":"Personas","changeType":"create","status":"success","data":{"content":"## Overview\nPersonas provide an abstraction to formalize the notion of a person using a given application. Note that multiple users can be assigned to the same persona. Technically, a persona is characterized by a collection of tasks which this person performs with the application.\n\nA business role will be generated for each persona to support the Everest platform's permission system.\n\n## Executive Summary\nStorycatcher II's MVP identifies three core personas: **Storyteller**, **Public Viewer**, and **Developer**. The **Storyteller** is the primary user who creates and manages personal narratives. The **Public Viewer** explores publicly shared content. The **Developer** focuses on the application's technical infrastructure. Future phases will introduce **Administrator** and **Business Administrator** roles.\n\nAccess control employs a Role-Based Access Control (RBAC) model, ensuring adherence to the principle of least privilege. Permissions are granularly assigned, with strong emphasis on GDPR compliance and explicit consent for sensitive data operations like public sharing.\n\n```mermaid\ngraph TD\n    A[\"Storycatcher II Users\"]\n    A --> B[\"Storyteller\"];\n    A --> C[\"Public Viewer\"];\n    A --> D[\"Developer\"];\n\n    B -- \"Future Role\" --> E[\"Administrator\"];\n    B -- \"Future Role\" --> F[\"Business Administrator\"];\n```\n\n## Persona Definitions\n\n### Storyteller\n*   **Persona Profile**: An authenticated user dedicated to capturing, managing, and optionally sharing their personal stories. Prioritizes privacy and structured storytelling.\n*   **Key Tasks**: Register/login, record audio with AI guidance, manage personal stories (metadata, offline archiving), export/share stories with consent, manage UI language.\n*   **Business Role Mapping**: `Storycatcher-Storyteller`\n\n### Public Viewer\n*   **Persona Profile**: An unauthenticated user interested in exploring public cultural narratives.\n*   **Key Tasks**: Browse and view publicly consented stories, manage UI language.\n*   **Business Role Mapping**: `Storycatcher-PublicViewer`\n\n### Developer\n*   **Persona Profile**: A technical professional responsible for the application's development, deployment, and maintenance.\n*   **Key Tasks**: Manage containerized development environments, secure API keys, configure CORS, monitor system performance and errors.\n*   **Business Role Mapping**: `Storycatcher-Developer`\n\n## Access Control Matrix\n\n| Persona        | Page Area                  | Read | Write | Execute (Specific Actions)                                                                                                                                                                                                                               | Notes                                                                                                                                                           |\n| :------------- | :------------------------- | :--- | :---- | :--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :------------------------------------------------------------------------------------------------------------------------------------------------------ |\n| **Storyteller** | Public/Auth Pages          | Yes  | Yes   | Register Account, Login, Navigate                                                                                                                                                                                                                      | Access to general app info and authentication.                                                                                                          |\n|                | Private Story Management   | Yes  | Yes   | Start New Story, Select Story, Logout, Edit Story Metadata, Export Story, Share Story, Grant Consent (GDPR), Confirm Export/Share, Delete Story                                                                                                          | Full control over *their own* stories (metadata, content links), requires explicit consent for sharing/export.                                          |\n|                | Story Capture              | Yes  | Yes   | Record Audio, Stop Recording, Continue Recording, Finalize Story, Send Audio for Processing, Receive AI Questions                                                                                                                                      | Interactive loop for story creation. Requires microphone access.                                                                                        |\n|                | Public Story Viewing       | Yes  | -     | Browse Public Stories                                                                                                                                                                                                                                  | Can view stories shared by others.                                                                                                                      |\n| **Public Viewer** | Public/Auth Pages          | Yes  | -     | Navigate                                                                                                                                                                                                                                               | Limited to public information.                                                                                                                          |\n|                | Public Story Viewing       | Yes  | -     | Browse Public Stories                                                                                                                                                                                                                                  | Primary access is to publicly shared stories.                                                                                                           |\n| **Developer**  | Development Environment    | Yes  | Yes   | Configure Containers, Deploy Services, Manage API Keys, Monitor Logs, Troubleshoot                                                                                                                                                                     | Technical access to infrastructure and configurations; no direct end-user UI page access beyond testing.                                              |\n\n## Security & Compliance Integration\n\n*   **Need-to-Know & Least Privilege**: Permissions are strictly limited to necessary functions. Storytellers manage only their own stories. Public Viewers have read-only access to publicly consented content. Developers manage technical infrastructure, not sensitive user data directly.\n*   **Segregation of Duty (SoD)**: For MVP, SoD separates end-user roles (Storyteller, Public Viewer) from the technical Developer role. An individual cannot simultaneously hold an end-user role and the Developer role, preventing unauthorized access to system internals or bypassing user controls. Future Admin/Partner roles (2303) will introduce more granular SoD.\n*   **Audit Trail Requirements**: Critical actions are logged for accountability and compliance (2290). These include:\n    *   User authentication events (login, registration attempts) (2285).\n    *   Story finalization, update, and deletion (2288, 2292).\n    *   Changes to story public status and explicit consent grants (2290, 2293).\n    *   API key management operations (2297).\n*   **GDPR Compliance (2290)**: The access model ensures explicit opt-in consent for any story export or public sharing (2293, 2295). Sensitive content is primarily local-first (2287, 2289), minimizing server-side data exposure and reducing backend access requirements.\n\n## Permission Framework\n\nPermissions are task-based and scoped to ensure granular control.\n\n*   **Application-Wide**:\n    *   `app:multilingualUI`: Access to UI language settings.\n*   **Authentication & User Management**:\n    *   `auth:register`: Create new user accounts.\n    *   `auth:login`: Authenticate and access private features.\n*   **Private Story Management (Own Stories)**:\n    *   `story:createOwn`: Initiate new story capture.\n    *   `story:readOwn`: View own story metadata, transcripts, summaries.\n    *   `story:updateOwn`: Modify own story metadata (e.g., title, tags).\n    *   `story:deleteOwn`: Delete own stories.\n    *   `story:processAudio`: Send audio segments for transcription/AI analysis.\n    *   `story:finalizeOwn`: Mark own story as complete.\n    *   `story:exportOwn`: Export own story in various formats.\n    *   `story:shareOwn`: Set own story as public (requires `data:gdprConsent`).\n*   **Public Story Access**:\n    *   `publicStory:read`: View publicly consented stories.\n*   **Data & Compliance**:\n    *   `data:gdprConsent`: Grant/revoke explicit consent for data operations (e.g., public sharing).\n*   **Developer Operations**:\n    *   `dev:containerManagement`: Manage Docker containers.\n    *   `dev:apiKeyManagement`: Access and manage API keys.\n    *   `dev:corsConfiguration`: Configure Cross-Origin Resource Sharing.\n    *   `dev:systemMonitoring`: Access system logs and performance metrics.\n    *   `dev:codeDeployment`: Deploy application code.\n\n*   **Role Hierarchy**: Not applicable for MVP; roles are distinct.\n*   **Multi-Factor Authentication**: Not required for MVP (2285), but a future consideration for enhanced security.\n\n## Business Role Generation\n\n*   **Role Name**: `Storycatcher-Storyteller`\n    *   **Description**: Authenticated user persona focused on creating, managing, and sharing personal narratives, utilizing AI guidance and offline capabilities.\n    *   **Permission Mappings**: `app:multilingualUI`, `auth:register`, `auth:login`, `story:createOwn`, `story:readOwn`, `story:updateOwn`, `story:deleteOwn`, `story:processAudio`, `story:finalizeOwn`, `story:exportOwn`, `story:shareOwn`, `data:gdprConsent`, `publicStory:read`.\n\n*   **Role Name**: `Storycatcher-PublicViewer`\n    *   **Description**: Unauthenticated persona with read-only access to publicly shared stories within the archive.\n    *   **Permission Mappings**: `app:multilingualUI`, `publicStory:read`.\n\n*   **Role Name**: `Storycatcher-Developer`\n    *   **Description**: Technical persona responsible for the setup, deployment, and operational maintenance of the Storycatcher II application's infrastructure.\n    *   **Permission Mappings**: `dev:containerManagement`, `dev:apiKeyManagement`, `dev:corsConfiguration`, `dev:systemMonitoring`, `dev:codeDeployment`.","id":1850},"old":{"id":null,"content":null},"mode":"ai"},{"artifactType":"DataProtectionImpactAssessment","changeType":"create","status":"success","data":{"id":1851,"content":"## Data Protection Impact Assessment (DPIA) - Storycatcher II\n\n### Preliminary Assessment\n\n**DPIA Requirement Determination:**\nA Data Protection Impact Assessment (DPIA) is required for Storycatcher II under GDPR Article 35. This is due to the processing of personal data on a large scale, particularly voice recordings and their transcriptions, which can reveal sensitive personal information (e.g., health, political opinions, religious beliefs). The use of local-first storage for raw audio and transcripts, while privacy-enhancing, still entails processing under the controller's responsibility if the application is provided by an organization. The system also involves systematic monitoring (e.g., story metadata, user activity) and potential public disclosure of personal data through explicit consent mechanisms.\n\n**High-Risk Processing Activities:**\n1.  **Voice-to-Text Transcription (Local-First):** Processing of raw audio segments into text transcripts. This involves personal data, potentially including special categories of data (e.g., health information, political opinions) if disclosed by the user.\n2.  **Offline-First Story Archiving:** Long-term local storage of personal audio recordings and their full transcripts on the user's device. While local, the data's sensitivity poses a risk if the device is compromised.\n3.  **GDPR-Compliant Data Handling and Consent:** Implementation of explicit opt-in consent for any story export or publication. This signifies the potential for public disclosure of highly personal narratives.\n4.  **Story Metadata Tagging and Structuring:** Application of rich metadata (geo-tagging, temporal structuring) to stories, which can increase the identifiability of individuals and their stories.\n\n**Legal Basis for Processing:**\n*   **Consent (GDPR Article 6(1)(a) and Article 9(2)(a)):** For the processing of voice recordings and their transcription, and for the optional export or public sharing of stories. Explicit consent is obtained for these activities, especially given the potential for special categories of data.\n*   **Contractual Necessity (GDPR Article 6(1)(b)):** For processing personal data necessary to provide the core Storycatcher II service, such as user account management, personal story management (viewing, editing), and metadata synchronization with the backend.\n\n### Project & Data Processing Description\n\n**Application Purpose and Objectives:**\nStorycatcher II is a JavaScript-based application designed to facilitate the secure and private capture, management, and presentation of personal stories. Its primary purpose is to provide a platform for individuals to digitally archive their personal narratives, emphasizing user experience, robust data privacy, and intelligent assistance (AI-guided interviews, local-first STT).\n\n**Data Processing Activities Mapping:**\n*   **Collection:** Audio recordings from user microphones; user input for story metadata, tags, and account registration (e.g., email, password).\n*   **Processing/Usage:**\n    *   Local voice-to-text transcription of audio segments using local STT engines (Whisper/Vosk).\n    *   Application of rich metadata (geo-tagging, temporal structuring, dialect capture, general tags) to stories.\n    *   User authentication and authorization for access to personal stories and management features.\n    *   Display, editing, and management of personal stories and their associated metadata in the 'My Stories' section.\n    *   AI-guided interview process (processing interview questions, not raw story content).\n    *   Optional export or publication of stories with explicit user consent.\n*   **Storage:**\n    *   **Local (User Device):** Raw audio recordings and their full transcriptions are primarily stored locally using IndexedDB or localStorage.\n    *   **Backend Database (Server):** User account data, `StoryMetadata`, `StoryTag`, and `InterviewQuestionLog` are stored. Raw audio and full transcripts are *only* stored on the backend if explicitly consented for export/public sharing.\n*   **Sharing:** Public sharing of stories or story metadata occurs only with explicit opt-in consent from the user.\n*   **Retention:** Local data (raw audio, full transcripts) is retained until the user explicitly deletes it from their device. Backend data (user accounts, metadata) is retained as long as the user account is active or until the associated story metadata is deleted by the user.\n*   **Deletion:** Users can initiate deletion of their stories and associated data, which triggers deletion from both local storage and the backend database (for metadata or consented shared content).\n\n**Data Flows:**\n\n```mermaid\ngraph LR\n    subgraph \"User Device - Frontend\"\n        A[\"User / Microphone\"] --> B(\"Storycatcher App - UI\");\n        B -- \"Records Audio\" --> C(\"Local Storage - IndexedDB\");\n        C -- \"Audio Segments\" --> D(\"Local STT Engine\");\n        D -- \"Raw Transcript\" --> C;\n        B -- \"User Input\" --> E(\"Story Metadata Editor\");\n    end\n\n    subgraph \"Backend System\"\n        F(\"Backend Server - Node.js\");\n        G(\"PostgreSQL Database\");\n    end\n\n    B -- \"Auth / Metadata Sync\" --> F;\n    F -- \"Store User / Metadata\" --> G;\n    B -- \"Explicit Opt-in\" --> F;\n    F -- \"Consented Story / Metadata\" --> G;\n    style A fill:#f9f,stroke:#333,stroke-width:2px\n    style B fill:#ccf,stroke:#333,stroke-width:2px\n    style C fill:#ccf,stroke:#333,stroke-width:2px\n    style D fill:#ccf,stroke:#333,stroke-width:2px\n    style E fill:#ccf,stroke:#333,stroke-width:2px\n    style F fill:#cff,stroke:#333,stroke-width:2px\n    style G fill:#cff,stroke:#333,stroke-width:2px\n```\n\n**Parties Involved:**\n*   **Controller:** The organization operating Storycatcher II.\n*   **Processors:**\n    *   Backend server (Node.js/Express.js) for user authentication, metadata management, and facilitating consented sharing.\n    *   Cloud hosting provider (for backend infrastructure, not explicitly named but implied).\n    *   LLM providers (if used for AI guidance/summaries, but *not* for core transcription which is local-first).\n*   **Data Subjects:** Users of Storycatcher II, and any individuals whose personal stories are recorded and processed.\n\n### Necessity & Proportionality Assessment\n\n**Necessity of Processing Activities:**\n*   **Voice-to-Text Transcription:** Essential for converting spoken narratives into a manageable, searchable, and editable text format, fulfilling the core purpose of story capture.\n*   **Local-First Storage:** Crucial for maintaining privacy-by-design and GDPR compliance, minimizing server-side data exposure for sensitive content.\n*   **Story Metadata Tagging:** Necessary for organizing, discovering, and enhancing the historical and contextual value of archived stories.\n*   **User Management:** Required for providing a personalized, secure 'My Stories' experience and managing user preferences.\n*   **Explicit Consent for Sharing:** Absolutely necessary to comply with GDPR principles, particularly for public sharing of potentially sensitive personal narratives.\n\n**Proportionality of Data Collection Scope:**\nThe data collection is proportionate to the stated purposes. Raw audio and full transcripts, which are the most sensitive data points, are primarily kept local. The backend only stores metadata and full story content if explicitly consented for sharing. User data collected (e.g., email for authentication) is minimal and necessary for service provision.\n\n**Less Intrusive Alternatives:**\n*   **Manual Transcription:** Not a feasible alternative given the project's objective of automated story capture and efficiency.\n*   **Server-Side STT:** Explicitly rejected in favor of local-first processing to minimize data transfer and exposure, demonstrating a commitment to less intrusive methods where feasible.\n*   **No Metadata/Limited Metadata:** Would significantly reduce the utility and discoverability of stories, hindering the core objective of archiving and structuring narratives.\n\n**Data Retention Periods and Justification:**\n*   **Local Raw Audio and Full Transcripts:** Retained on the user's device until the user explicitly deletes the story. Justification: To provide users with a persistent, private archive of their personal narratives, as per the application's core purpose.\n*   **Backend User Account Data and Story Metadata:** Retained as long as the user account is active or until the associated story metadata is explicitly deleted by the user. Justification: Necessary for user authentication, management of 'My Stories', and to enable consented public access/export functionality.\n*   **Consented Public Stories/Exports:** Retained on the backend indefinitely or until the user requests deletion, based on the explicit consent provided for public availability/export. Justification: To fulfill the user's request for public archiving or export.\n\n### Risk Analysis & Mitigation\n\n| Risk                                    | Likelihood | Severity | Mitigation Measures                                                                                                                                                                                                                                                                                                                              | Responsibility         |\n| :-------------------------------------- | :--------- | :------- | :--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :--------------------- |\n| **Unauthorized Access to Local Data**   | Medium     | High     | **Technical:** Primary data (audio/transcripts) is local, reducing server exposure. Rely on OS/browser security for device protection. **Organizational:** User education on device security.                                                                                                                                                    | Development, User      |\n| **Unauthorized Access to Backend Data** | Low        | High     | **Technical:** Secure login (password hashing, token-based authentication - JWT). Robust authorization (access restricted to authenticated users). Least privilege principle applied to backend access. HTTPS/TLS for all data in transit. **Organizational:** Regular security audits, access controls for backend infrastructure.                          | Development, Operations |\n| **Accidental Public Exposure**          | Low        | High     | **Technical:** Explicit opt-in consent flows required for any story export or public publication. Clear UI/UX design for sharing options. Default privacy settings. **Organizational:** Strict policy requiring documented consent before sharing.                                                                                                   | Development, Product   |\n| **Data Interception in Transit**        | Low        | Medium   | **Technical:** All communication between frontend and backend uses HTTPS/TLS encryption.                                                                                                                                                                                                                                                 | Development            |\n| **Misuse of Sensitive API Keys**        | Low        | High     | **Technical:** API keys managed securely via environment variables and `.env` files; never hardcoded or committed to version control. **Organizational:** Secure configuration management practices.                                                                                                                                           | Development, Operations |\n| **Lack of Explicit Consent**            | Low        | High     | **Technical:** Mandatory, clear, and unambiguous opt-in consent prompts for audio recording (browser-managed permissions) and for any data export/publication. Mechanisms to record consent status. **Organizational:** Legal review of consent texts, clear internal policies on consent management.                                          | Development, Legal     |\n| **Inadequate Data Deletion**            | Low        | High     | **Technical:** Implement robust and tested deletion mechanisms for both local (IndexedDB/localStorage) and backend (PostgreSQL) data upon user request, ensuring all associated data is removed. **Organizational:** Defined data retention and deletion policies.                                                                              | Development            |\n\n### Implementation & Review\n\n**Action Plan for Implementing Measures:**\n1.  **Develop & Test Consent Flows:** Implement and rigorously test all explicit opt-in consent flows for microphone access, data processing, and public sharing/export. Ensure consent records are maintained.\n2.  **Secure Backend & APIs:** Implement JWT-based authentication, role-based authorization, and HTTPS/TLS for all API endpoints. Ensure secure API key management using environment variables.\n3.  **Robust Local-First Storage:** Verify the integrity and security of local data persistence (IndexedDB/localStorage) and local STT engine integration.\n4.  **Implement Secure Deletion:** Develop and test functionalities for complete data deletion from both local storage and backend systems upon user request.\n5.  **Security Testing:** Conduct regular security audits, penetration testing, and vulnerability assessments on both frontend and backend components.\n6.  **Developer Training:** Provide ongoing training to development teams on privacy-by-design principles, secure coding practices, and GDPR compliance.\n\n**Monitoring Mechanisms:**\n*   **Access Logs:** Monitor backend API access logs for suspicious activity or unauthorized access attempts.\n*   **Consent Logs:** Maintain an audit trail of user consent actions (granting, withdrawing).\n*   **System Performance Monitoring:** Track system health and performance to detect anomalies that might indicate security incidents.\n*   **Regular Code Reviews:** Incorporate security and privacy checks into the development lifecycle through peer code reviews.\n\n**Review Schedule and Updates:**\n*   **Annual Review:** Conduct a comprehensive DPIA review annually to reassess risks, effectiveness of mitigation measures, and ensure ongoing compliance.\n*   **Event-Driven Review:** The DPIA will be reviewed and updated immediately upon:\n    *   Significant changes to data processing activities (e.g., new data types, new processing purposes).\n    *   Introduction of new features impacting personal data or privacy.\n    *   Changes in regulatory guidance or legal requirements.\n    *   Identification of new risks or security incidents."},"old":{"content":null,"id":null},"mode":"ai"},{"artifactType":"SecurityThreatModel","changeType":"create","status":"success","data":{"content":"## Security Threat Model: Storycatcher II\n\nThis document outlines the security threat model for Storycatcher II, focusing on identifying potential threats, their associated risks, and proposed mitigation strategies using the STRIDE methodology.\n\n### Application Understanding & Assets\n\nStorycatcher II is a JavaScript-based application for secure, private capture and management of personal stories. It employs a \"local-first\" data strategy for sensitive content, complemented by a backend for user management and metadata.\n\n**Components and Data Flows:**\n\n```mermaid\ngraph LR\n    subgraph \"User Device (Client Trust Boundary)\"\n        A[\"Client - React/JavaScript UI\"] --> B(\"Microphone Access / MediaRecorder API\");\n        A --> C(\"Local Storage - IndexedDB / localStorage\");\n    end\n\n    subgraph \"Backend Services (Server Trust Boundary)\"\n        D(\"API Gateway / Authentication - Node.js\") --> E(\"User Management Service\");\n        D --> F(\"Story Processing Service\");\n        F --> G(\"AI-Guided Interview Logic\");\n        F --> I(\"Story Data Management\");\n    end\n\n    subgraph \"External Integration (External Trust Boundary)\"\n        J(\"LLM Provider API\");\n    end\n\n    A -- \"API Calls (HTTPS/TLS)\" --> D;\n    B -- \"Audio Stream\" --> F;\n    F -- \"Text & Analysis\" --> A;\n    G -- \"Question Generation\" --> J;\n    J -- \"AI Responses\" --> G;\n    I -- \"Store Story Metadata\" --> K(\"Backend Database - PostgreSQL / MongoDB\");\n\n    style A fill:#e0f7fa,stroke:#00796b,stroke-width:2px\n    style B fill:#e0f7fa,stroke:#00796b,stroke-width:2px\n    style C fill:#e0f7fa,stroke:#00796b,stroke-width:2px\n    style D fill:#c8e6c9,stroke:#388e3c,stroke-width:2px\n    style E fill:#c8e6c9,stroke:#388e3c,stroke-width:2px\n    style F fill:#c8e6c9,stroke:#388e3c,stroke-width:2px\n    style G fill:#c8e6c9,stroke:#388e3c,stroke-width:2px\n    style I fill:#c8e6c9,stroke:#388e3c,stroke-width:2px\n    style J fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px\n    style K fill:#fff8e1,stroke:#fbc02d,stroke-width:2px\n```\n\n**Sensitive Data Identified:**\n*   **Personally Identifiable Information (PII):** Usernames, emails, passwords (stored in backend database). Raw audio recordings, full transcripts (primarily local storage, transiently on backend for processing/export with consent).\n*   **Intellectual Property:** User-generated story content (audio, transcripts, summaries).\n*   **System Secrets:** LLM Provider API keys (backend environment variables).\n\n**Security Objectives & Compliance:**\n*   **Confidentiality:** Protect user PII and story content from unauthorized access.\n*   **Integrity:** Prevent unauthorized modification of user data and system configurations.\n*   **Availability:** Ensure system and data access for legitimate users.\n*   **Accountability:** Log user actions, especially related to data sharing.\n*   **GDPR Compliance:** Critical for local data storage for MVP, explicit opt-in consent for export/publication, and user data management.\n\n**User Interactions and Authentication Points:**\n*   **User Registration (`POST /auth/register`):** Initial account creation.\n*   **User Login (`POST /auth/login`):** Authentication for existing users.\n*   **Story Creation/Management:** Local-first, metadata sync with backend.\n*   **Story Export/Publication:** Requires explicit user consent, involves backend processing.\n*   **Admin/Partner Portal (Future):** Restricted access for content/user management.\n\n### Threat Identification (STRIDE Framework)\n\n| Category             | Threat Description                                                                   | Attack Vector/Scenario                                                                                                                                                                                                                                                          | Affected Component(s)                                                                     |\n| :------------------- | :----------------------------------------------------------------------------------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :---------------------------------------------------------------------------------------- |\n| **S**poofing         | Impersonation of legitimate users.                                                   | Attacker gains access to user credentials (e.g., via phishing, credential stuffing) and logs in as the user.                                                                                                                                                                    | User Management Service, API Gateway                                                      |\n|                      | Impersonation of backend services/LLM provider.                                      | Attacker intercepts/modifies API calls to impersonate backend services or LLM provider, leading to unauthorized data access or malicious responses.                                                                                                                            | API Gateway, LLM Provider API, Story Processing Service                                   |\n| **T**ampering        | Unauthorized modification of user data (e.g., story metadata, consent status).       | Attacker exploits vulnerabilities in API endpoints or database to alter story metadata, sharing consent, or user account details.                                                                                                                                                | Story Data Management, Backend Database, User Management Service                          |\n|                      | Malicious modification of client-side code/data.                                     | Attacker injects malicious scripts (XSS) to modify client behavior, alter locally stored stories, or manipulate API requests. User-side local storage could be tampered with if device is compromised.                                                                        | Client - React/JavaScript UI, Local Storage                                               |\n| **R**epudiation      | Users deny performing actions (e.g., sharing a story publicly).                      | A user shares a story publicly, then claims they did not provide consent or that the action was unauthorized, without sufficient audit trails.                                                                                                                               | Story Data Management, Backend Database                                                   |\n| **I**nformation Disclosure | Unauthorized access to sensitive user data (PII, story content, API keys).           | Attacker exploits vulnerabilities in API endpoints to retrieve user details, story metadata, or unconsented story content. Backend API keys could be exposed if environment variables are improperly handled or configuration files are leaked. Unencrypted data in transit. | Backend Database, Story Processing Service, LLM Provider API, API Gateway, Local Storage  |\n|                      | Disclosure of internal system errors/stack traces.                                   | Poor error handling reveals sensitive system information to attackers (e.g., database schemas, server paths).                                                                                                                                                                | API Gateway, Story Processing Service                                                     |\n| **D**enial of Service | System unavailability due to resource exhaustion or malicious requests.              | Attacker floods API endpoints with requests (DDoS), exhausts server resources, or exploits vulnerabilities causing crashes. Malicious client-side scripts could degrade user experience.                                                                                    | API Gateway, Story Processing Service, Client - React/JavaScript UI                       |\n|                      | Disruption of microphone access or local storage.                                    | Malicious code prevents microphone access or corrupts/deletes local story data, impacting core functionality.                                                                                                                                                               | Microphone Access / MediaRecorder API, Local Storage                                      |\n| **E**levation of Privilege | Unauthorized access to admin/partner functionalities or other users' data.         | Attacker exploits authentication/authorization flaws to bypass access controls, gaining elevated privileges (e.g., admin access, access to other users' private stories, or modifying system-wide settings).                                                                | API Gateway, User Management Service, Story Data Management, Admin/Partner Portal (future) |\n\n### Risk Assessment & Mitigation\n\n| Threat Category         | Identified Threat                                         | Likelihood | Impact | Risk Score | Mitigation                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     ```mermaid\nerDiagram\n    User {\n        string userId PK\n        string username\n        string email\n        string password_hash\n        string security_token\n        string preferred_llm\n        string preferred_language\n    }\n\n    StoryMetadata {\n        string storyId PK\n        string userId FK\n        string title\n        string description\n        string date_created\n        string last_modified\n        bool is_public\n        string public_url\n    }\n\n    StoryTag {\n        string tagId PK\n        string name\n    }\n\n    InterviewQuestionLog {\n        string logId PK\n        string storyId FK\n        string question_text\n        string ai_response\n        string timestamp\n    }\n\n    User ||--o{ StoryMetadata : \"creates\"\n    StoryMetadata ||--o{ StoryTag : \"categorized by\"\n    StoryMetadata ||--o{ InterviewQuestionLog : \"logs questions for\"\n```\n\n### Threat Identification (STRIDE Framework)\n\nThis section details potential threats to Storycatcher II, categorized using the STRIDE framework.\n\n#### Spoofing\n\n*   **User Impersonation:** An attacker could gain unauthorized access to a user's account by compromising their credentials (e.g., via weak passwords, phishing, or credential stuffing attacks). This allows them to log in as the legitimate user, access their story metadata, and potentially initiate public sharing without explicit consent if security controls are bypassed.\n*   **API Impersonation:** A malicious actor could attempt to spoof the backend API or external LLM provider. This might involve redirecting API calls to a rogue server or injecting malicious data, leading to unauthorized actions or data exfiltration.\n\n#### Tampering\n\n*   **Story Metadata Tampering:** An attacker could modify `StoryMetadata` records in the backend database, changing story titles, descriptions, or critically, the `is_public` status without the user's consent. This could lead to unauthorized public exposure of a story intended to be private.\n*   **Local Data Tampering:** If the user's local device is compromised (e.g., via malware or insecure browser extensions), the attacker could tamper with local story content (audio, transcripts in IndexedDB), potentially corrupting or altering the narrative.\n*   **API Request Tampering:** An attacker could intercept and modify API requests (e.g., changing parameters, altering story content during export/sharing) between the client and backend.\n\n#### Repudiation\n\n*   **Unaccounted Story Sharing:** A user could publicly share a story and later deny having done so, claiming their account was compromised or consent was not explicitly given. Without robust logging and audit trails of consent actions, it would be difficult to prove otherwise, impacting GDPR compliance.\n*   **Admin/Partner Action Repudiation:** In the future Admin/Partner Portal, administrators or partners could perform actions (e.g., content moderation, user management) and later deny their involvement if actions are not adequately logged and linked to specific authenticated users.\n\n#### Information Disclosure\n\n*   **Sensitive Data Exposure (Backend):** User PII (username, email, password hashes), story metadata, and potentially transient raw audio/transcripts (during consent-driven processing) could be exposed if the backend database or storage is breached. API keys for LLM providers could be disclosed if not securely managed (e.g., hardcoded, committed to version control).\n*   **Sensitive Data Exposure (In Transit):** If HTTPS/TLS is misconfigured or bypassed, data (user credentials, story metadata, AI analysis results) could be intercepted and read by unauthorized parties during client-backend communication.\n*   **Error Message Disclosure:** Poorly implemented error handling could expose sensitive system details (e.g., database errors, stack traces, internal paths) to attackers, aiding further exploitation.\n*   **Local Data Exposure:** While local-first prioritizes privacy, if the user's device is compromised, locally stored raw audio and transcripts could be directly accessed and exfiltrated.\n\n#### Denial of Service\n\n*   **API Endpoint Flooding:** An attacker could launch a Distributed Denial of Service (DDoS) attack against the backend API endpoints (`/auth/register`, `/auth/login`, etc.), making the service unavailable for legitimate users.\n*   **Resource Exhaustion:** Exploiting vulnerabilities that cause excessive resource consumption (CPU, memory, disk I/O) on the backend could lead to service degradation or crashes.\n*   **Local Storage/Microphone Access Disruption:** Malicious client-side code could attempt to prevent microphone access via the MediaRecorder API or corrupt/delete data in IndexedDB, rendering the core story capture and archiving functionality unusable for the end-user.\n\n#### Elevation of Privilege\n\n*   **Unauthorized Admin/Partner Access:** In the future, an attacker could exploit authentication or authorization flaws to gain access to the restricted Admin/Partner Portal, allowing them to manage content, users, or specific collections with elevated privileges.\n*   **Horizontal Privilege Escalation:** An attacker could exploit flaws to access or modify `StoryMetadata` belonging to other users, bypassing authorization checks intended to restrict access to personal stories.\n\n### Risk Assessment & Mitigation\n\nRisk scores are evaluated based on the likelihood of a threat occurring and its potential impact (High/Medium/Low). Mitigations are directly derived from the provided architecture, security principles, and requirements.\n\n| Threat Category         | Identified Threat                                         | Likelihood | Impact | Risk Score | Mitigation                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ```\nerDiagram\n    User ||--o{ StoryMetadata : \"has\"\n    StoryMetadata ||--o{ InterviewQuestionLog : \"logs\"\n    StoryMetadata ||--o{ PublicStoryArchive : \"publishes\"\n    StoryMetadata ||--o{ Tag : \"tagged with\"\n\n    User {\n        string userId PK\n        string username\n        string email\n        string password_hash\n        string security_token\n        string preferred_llm\n        string preferred_language\n    }\n\n    StoryMetadata {\n        string storyId PK\n        string userId FK\n        string title\n        string description\n        string date_created\n        string last_modified\n        bool is_public\n        string public_url\n    }\n\n    InterviewQuestionLog {\n        string logId PK\n        string storyId FK\n        string question_text\n        string ai_response\n        string timestamp\n    }\n\n    PublicStoryArchive {\n        string archiveId PK\n        string storyId FK\n        string content_summary\n        string publication_date\n    }\n\n    Tag {\n        string tagId PK\n        string name\n    }\n```\n\n### Validation & Integration\n\n*   **Completeness Verification:** The identified threats cover core functionalities like user authentication, data handling (local and backend), API key management, and data sharing, aligning with critical security requirements and GDPR compliance. Future considerations for admin/partner portals have been included.\n*   **Actionable Tasks Translation:** Each mitigation strategy translates directly into actionable development tasks (e.g., implement password hashing, enforce HTTPS, use environment variables, develop explicit consent UI/logic, implement access controls).\n*   **Security Acceptance Criteria:**\n    *   All user authentication flows must use strong hashing (e.g., bcrypt) and token-based mechanisms.\n    *   All API communication must enforce HTTPS/TLS 1.2 or higher.\n    *   Sensitive API keys must be loaded from environment variables and never hardcoded or committed to version control.\n    *   Explicit opt-in consent must be technically enforced and auditable for any story export or public sharing.\n    *   Access to `StoryMetadata` must be strictly limited to the owning `userId` via server-side authorization checks.\n    *   Error messages must be generic and not expose sensitive system information.\n    *   Admin/Partner Portal (future) must implement role-based access control (RBAC) and least privilege principles.\n*   **Review and Update Procedures:** This threat model should be reviewed and updated at key project milestones, especially before major releases, when new features are added (e.g., Admin/Partner Portal), or when significant architectural changes occur. Security code reviews and penetration testing should validate the implemented controls against these identified threats.\n\n### Conclusion\n\nThis threat model provides a foundational understanding of potential security vulnerabilities and outlines proactive mitigation strategies for the `NarrativeEngine` application. By systematically identifying threats across critical components  from user authentication and data storage to API interactions and external integrations  we have established a robust security baseline. The identified threats, coupled with their corresponding mitigations, form the basis for actionable development tasks and define clear security acceptance criteria for the project.\n\nSecurity is an ongoing process, not a one-time activity. The principles and findings within this document will guide secure development practices, influence architectural decisions, and inform testing strategies throughout the application's lifecycle. Regular reviews and updates of this threat model, especially in response to new features, architectural changes, or evolving threat landscapes, will ensure the continued resilience and integrity of `NarrativeEngine`. Adherence to these security measures is paramount to protecting user data, maintaining trust, and ensuring compliance with relevant data protection regulations like GDPR.","id":1852},"old":{"content":null,"id":null},"mode":"ai"},{"artifactType":"SecurityReview","changeType":"create","status":"success","data":{"id":1853,"content":"# Security and Compliance Analysis: Storycatcher II on Everest Platform\n\n## Management Summary\nThe Storycatcher II would significantly benefit from the Everest Platform's robust security infrastructure. The platform automatically addresses many fundamental security requirements such as data encryption, secure networking, infrastructure security, and compliance with standards like SOC2 Type 2 and GDPR.\n\nKey benefits of hosting on the Everest Platform include:\n- Strong data protection through built-in encryption (at rest and in transit)\n- Secure infrastructure with monitoring, logging, and alerting capabilities\n- Compliance foundation with SOC2 Type 2 and GDPR coverage\n- Secure deployment, operations, and incident response procedures\n\nHowever, several application-specific security requirements need more detailed specification:\n\nMajor gaps:\n- Detailed client-side data protection for local storage\n- Comprehensive application-level audit logging\n- Granular Role-Based Access Control (RBAC) definitions\n- Explicit Segregation of Duty (SoD) analysis for administrative functions\n- Refined consent management flows and data retention policies\n\nThe application specification provides a solid foundation for privacy-by-design and local-first data handling and demonstrates awareness of security's importance for personal data applications. With enhancements to address the identified gaps, the application would leverage the Everest Platform's security capabilities while properly implementing application-specific security requirements.\n\n## Requirements Covered by the Everest Platform\nThe following security and compliance requirements from the specification are fully covered by the Everest Platform:\n\n### Data Encryption\n- Data-at-rest encryption using AES-256 with customer-specific keys for all server-side data (e.g., StoryMetadata, User data).\n- Data-in-transit encryption using TLS 1.2 or higher for all communication between frontend and backend via HTTPS/TLS.\n\n### Infrastructure Security\n- Secure network architecture with strong tenant isolation.\n- Secure infrastructure logging, monitoring, and alerting.\n- Secure configuration management.\n- Secure deployment and operations.\n- Secure incident response and disaster recovery.\n- Penetration testing and vulnerability scanning.\n- Secure software updates and patch management.\n\n### Backup & Recovery\n- Secure backup procedures including encrypted and immutable backups for all server-side data.\n- Comprehensive disaster recovery capabilities.\n\n### Compliance Foundations\n- SOC2 Type 2 compliance.\n- GDPR compliance framework (platform-level).\n- Secure software development lifecycle.\n- Secure AI and machine learning security (for LLM integration infrastructure).\n\n### Secure Session Management\n- Platform-provided secure session handling to prevent session hijacking, supporting the token-based authentication mentioned.\n\n## Requirements Supported by Everest Frameworks (Requiring Specification Details)\nThe following requirements are supported by Everest Platform frameworks but need more detailed specifications:\n\n### Role-Based Access Control (RBAC)\n- **Current specification:** \"Authorization: Access to personal stories and management features is restricted to authenticated users (2292). Public archive viewing (2295) is open to all.\"\n- **Assessment:** The specification outlines two broad access levels: authenticated users and public viewers. This is a basic form of access control but lacks the granularity required for complex applications or future administrative roles. It does not define specific permissions associated with different types of user actions (e.g., creating, editing, deleting stories, managing tags, publishing).\n- **Recommendation:** Define a detailed RBAC matrix. Specify distinct roles (e.g., `StoryOwner`, `PublicViewer`, `SystemAdmin`) and their corresponding permissions for each API endpoint and resource (e.g., `POST /stories` requires `story-create` permission; `GET /stories/{id}` for private stories requires `story-read-own` permission; `GET /public-stories/{id}` requires `public-story-read` permission).\n\n### Audit Logging\n- **Current specification:** The DPIA mentions \"systematic monitoring (e.g., story metadata, user activity).\" No explicit requirements for application-level audit logging are detailed.\n- **Assessment:** While Everest provides infrastructure logging, application-specific audit trails of user actions are crucial for security monitoring, compliance, and incident investigation. The current specification lacks details on what specific user actions should be logged (e.g., login/logout, story creation/modification/deletion, consent changes, story publication), what data points should be included in logs (user ID, action, timestamp, success/failure, affected resource), log retention periods, and log review procedures.\n- **Recommendation:** Implement comprehensive application-level audit logging for all critical user and administrative actions. Define log content, format, retention policy, and establish procedures for regular review and secure storage of these logs, leveraging Everest's logging infrastructure.\n\n### Segregation of Duty (SoD)\n- **Current specification:** No explicit mention of Segregation of Duty requirements.\n- **Assessment:** SoD is not addressed in the provided artifacts. While the initial MVP might not have complex administrative roles, as the application scales or if administrative functions become more critical (e.g., content moderation for public archives, user account management), SoD becomes vital to prevent fraud, errors, or misuse of privileges.\n- **Recommendation:** Conduct an SoD analysis for all critical administrative functions. Define roles and permissions such that no single individual can perform conflicting tasks or complete a critical process end-to-end without oversight. For instance, the ability to publish a story to the public archive might require a separate approval step if content moderation becomes a feature.\n\n### PII Data Handling\n- **Current specification:** \"GDPR-Compliant Data Handling and Consent,\" \"local storage of data for MVP,\" \"explicit opt-in consent flows for any story export or publication.\" DPIA identifies voice-to-text transcription and local archiving as high-risk. Data Model emphasizes \"local-first\" for sensitive content.\n- **Assessment:** Strong awareness of GDPR and PII, with \"local-first\" being a key privacy-by-design principle. Explicit consent for export/publication is a good foundation. However, the specifics of consent management (how consent is captured, stored, and revoked, granularity of consent), detailed data retention policies for both local and server-side data, and data minimization strategies for transient server-side processing are not fully elaborated.\n- **Recommendation:** Detail the consent management system, including an audit trail of consent, mechanisms for users to easily review and revoke consent, and clear communication regarding data sharing with third-party LLM providers. Specify precise data retention and deletion policies for all data types (raw audio, transcripts, metadata, public stories) on both client and server. Implement strict data minimization for server-side transient processing of sensitive data (e.g., immediate deletion of audio/transcripts post-AI analysis).\n\n### Authentication Integration\n- **Current specification:** \"User Authentication (2285): Secure login mechanisms (e.g., password hashing, token-based authentication) protect user accounts.\" API endpoints `/auth/register` and `/auth/login` are defined.\n- **Assessment:** Basic user authentication is outlined. The specification does not include requirements for multi-factor authentication (MFA), single sign-on (SSO), or integration with external identity providers (e.g., OAuth2/OIDC, SAML). While token-based authentication is mentioned, the specifics of token management (e.g., refresh tokens, token revocation) are not detailed.\n- **Recommendation:** Leverage Everest Platform's secure session management capabilities. Implement strong password policies and consider enabling or requiring MFA for all user accounts. Explore integration with standard identity providers (e.g., OAuth2/OIDC) to offer SSO capabilities for improved user experience and security, particularly if targeting enterprise users.\n\n## Identified Gaps and Recommendations\nThe following gaps require additional specification:\n\n### Client-Side Local Storage Security\n- **Gap:** The \"local-first\" strategy for sensitive data (audio, raw transcripts) relies heavily on client-side storage (IndexedDB/localStorage). The specification does not detail how this local data is protected from unauthorized access or tampering if the user's device is compromised.\n- **Recommendation:** Implement client-side encryption for sensitive data stored in IndexedDB using Web Crypto API or similar mechanisms. Consider data integrity checks for locally stored content. Educate users on device security best practices.\n\n### Secure API Key Usage for External Services\n- **Gap:** \"Secure API Key Management\" focuses on backend environment variables. The TechStack diagram shows \"LLM Provider API\" connected to \"AI-Guided Interview Logic\" (backend). However, if any client-side component were to directly interact with external LLM providers, exposing API keys on the client is a significant risk. The current documentation implies backend proxying, but it should be explicitly stated.\n- **Recommendation:** Explicitly confirm and enforce that all interactions with sensitive external APIs (e.g., LLM providers) are proxied through the secure backend. No API keys or sensitive credentials for external services should ever be directly embedded in or accessible from client-side code.\n\n### Input Validation and Output Encoding\n- **Gap:** The provided artifacts do not explicitly mention requirements for input validation on all user-supplied data or output encoding/sanitization for data displayed in the UI. This is critical for preventing common web vulnerabilities like Cross-Site Scripting (XSS), SQL Injection (or NoSQL equivalent), and other injection attacks.\n- **Recommendation:** Implement robust server-side input validation for all API endpoints to ensure data conforms to expected formats and ranges. Apply appropriate output encoding (e.g., HTML entity encoding) for all user-generated content displayed in the React UI to prevent XSS.\n\n### Server-Side Transient Data Enforcement\n- **Gap:** The DPIA mentions \"backend processing these only transiently for AI analysis or or for export/public sharing with explicit user consent.\" The mechanism to ensure this transience (e.g., immediate deletion after use, strict short-term retention policies) is not defined.\n- **Recommendation:** Define and implement clear technical controls and policies to ensure that raw audio recordings and full transcriptions processed on the backend for AI analysis are only stored for the minimum necessary duration (e.g., immediately deleted after transcription and analysis completion). Document secure deletion procedures.\n\n### Granular Consent Management and Transparency\n- **Gap:** While \"explicit opt-in consent\" is stated, the specification lacks details on the granularity of consent (e.g., consent for transcription vs. AI analysis vs. public sharing), the auditability of consent records, and how users are informed about data flows, especially involving LLM providers.\n- **Recommendation:** Implement a granular consent management system that allows users to opt-in/out of specific data processing activities. Maintain an immutable audit log of all consent decisions. Provide clear, user-friendly privacy notices explaining what data is collected, how it's used, who it's shared with (e.g., LLM providers), and how to exercise data subject rights.\n\n## Compliance Frameworks Analysis\n\n### Compliance Frameworks Requested in the Specification\nThe specification suggests the following compliance frameworks as relevant:\n- GDPR\n\n### Compliance Frameworks Covered by the Everest Platform\nThe Everest Platform provides coverage for:\n- SOC2 Type 2 - Fully covered\n- GDPR - Fully covered (platform-level framework)\n- ISO 27001 - Planned (not yet covered)\n\n### Compliance Gap Analysis\n- **GDPR** - The Everest Platform provides a strong foundational framework for GDPR compliance. However, application-specific responsibilities, such as detailed consent management, explicit data retention policies for application data, secure local data handling, and comprehensive audit logging for user actions, require further specification and implementation within Storycatcher II to achieve full end-to-end compliance.\n- **SOC2 Type 2** - Fully covered by the Everest Platform at the infrastructure and platform level. Storycatcher II benefits directly from this.\n- **ISO 27001** - Planned for the Everest Platform. If ISO 27001 certification becomes a requirement for Storycatcher II, the application will need to define and implement specific controls that align with ISO 27001 requirements, beyond what the platform automatically covers, once the platform achieves this certification.\n\n**Recommendation:** Focus on fully implementing the application-specific aspects of GDPR (detailed consent, data minimization, local storage security, data subject rights) to leverage Everest's foundational compliance. Monitor Everest's ISO 27001 roadmap for future alignment if needed.\n\n---\n### Security Architecture Overview\n```mermaid\ngraph LR\n    subgraph \"Everest Platform Trust Boundary\"\n        E[\"Everest Platform Services\"]\n        DB[\"Everest Managed Database\"]\n        AuthSvc[\"Everest Auth Service\"]\n        LogSvc[\"Everest Logging/Monitoring\"]\n    end\n\n    subgraph \"Storycatcher II Backend (Application Responsibility)\"\n        B[\"API Gateway / Authentication\"]\n        UM[\"User Management Service\"]\n        SP[\"Story Processing Service\"]\n        AI[\"AI-Guided Interview Logic\"]\n        SD[\"Story Data Management\"]\n    end\n\n    subgraph \"User Device (Client Trust Boundary)\"\n        C[\"Client - React/JavaScript UI\"]\n        Mic[\"Microphone Access\"]\n        LS[\"Local Storage - IndexedDB / localStorage\"]\n    end\n\n    subgraph \"External Integration (External Trust Boundary)\"\n        LLM[\"LLM Provider API\"]\n    end\n\n    C -- \"HTTPS/TLS\" --> B;\n    Mic -- \"Audio Stream\" --> SP;\n    SP -- \"Text & Analysis\" --> C;\n    AI -- \"Question Generation\" --> LLM;\n    LLM -- \"AI Responses\" --> AI;\n\n    B --> UM;\n    B --> SP;\n    B --> SD;\n    SP --> AI;\n\n    B -- \"Auth Integration\" --> AuthSvc;\n    UM --> DB;\n    SP --> DB;\n    SD --> DB;\n\n    style E fill:#e0e0e0,stroke:#333,stroke-width:2px\n    style DB fill:#e0e0e0,stroke:#333,stroke-width:2px\n    style AuthSvc fill:#e0e0e0,stroke:#333,stroke-width:2px\n    style LogSvc fill:#e0e0e0,stroke:#333,stroke-width:2px\n\n    style B fill:#ccf,stroke:#333,stroke-width:2px\n    style UM fill:#ccf,stroke:#333,stroke-width:2px\n    style SP fill:#ccf,stroke:#333,stroke-width:2px\n    style AI fill:#ccf,stroke:#333,stroke-width:2px\n    style SD fill:#ccf,stroke:#333,stroke-width:2px\n\n    style C fill:#f9f,stroke:#333,stroke-width:2px\n    style Mic fill:#f9f,stroke:#333,stroke-width:2px\n    style LS fill:#f9f,stroke:#333,stroke-width:2px\n\n    style LLM fill:#c0c0c0,stroke:#333,stroke-width:2px\n```\n\n---\n### Compliance Framework Alignment\n```mermaid\ngraph TD\n    A[\"Storycatcher II Requirements\"] --> B(\"GDPR - Data Handling / Consent\");\n    A --> C(\"Secure API Key Management\");\n    A --> D(\"User Authentication / Authorization\");\n    A --> E(\"Voice-to-Text Transcription Local-First\");\n\n    F[\"Everest Platform Coverage\"] --> G(\"SOC2 Type 2 - Fully Covered\");\n    F --> H(\"GDPR - Foundational Coverage\");\n    F --> I(\"ISO 27001 - Planned Coverage\");\n    F --> J(\"Data Encryption - At Rest / In Transit\");\n    F --> K(\"Infrastructure Security / Operations\");\n    F --> L(\"Secure Session Management\");\n\n    B -- \"Requires App-Specific Implementation\" --> B1(\"Detailed Consent Flows\");\n    B -- \"Requires App-Specific Implementation\" --> B2(\"Local Storage Security\");\n    B -- \"Requires App-Specific Implementation\" --> B3(\"Transient Data Policies\");\n    C -- \"Requires App-Specific Policy\" --> C1(\"Backend Proxying of API Calls\");\n    D -- \"Requires App-Specific Definition\" --> D1(\"Granular RBAC\");\n    D -- \"Requires App-Specific Definition\" --> D2(\"Application Audit Logging\");\n    E -- \"App-Specific Control\" --> E1(\"Client-Side Data Protection\");\n\n    H -- \"Supports\" --> B;\n    J -- \"Supports\" --> D;\n    K -- \"Supports\" --> A;\n    L -- \"Supports\" --> D;\n\n    subgraph \"Compliance Gaps & Recommendations\"\n        G1(\"GDPR - App-Specific Details\") --> R1(\"Refine Consent, Retention, Local Security\");\n        G2(\"ISO 27001 - App-Specific Controls\") --> R2(\"Monitor Everest Roadmap, Define App Controls if Needed\");\n    end\n\n    style A fill:#ccf,stroke:#333,stroke-width:2px\n    style B fill:#f9f,stroke:#333,stroke-width:2px\n    style C fill:#f9f,stroke:#333,stroke-width:2px\n    style D fill:#f9f,stroke:#333,stroke-width:2px\n    style E fill:#f9f,stroke:#333,stroke-width:2px\n\n    style F fill:#e0e0e0,stroke:#333,stroke-width:2px\n    style G fill:#e0e0e0,stroke:#333,stroke-width:2px\n    style H fill:#e0e0e0,stroke:#333,stroke-width:2px\n    style I fill:#e0e0e0,stroke:#333,stroke-width:2px\n    style J fill:#e0e0e0,stroke:#333,stroke-width:2px\n    style K fill:#e0e0e0,stroke:#333,stroke-width:2px\n    style L fill:#e0e0e0,stroke:#333,stroke-width:2px\n\n    style B1 fill:#ffc,stroke:#333,stroke-width:2px\n    style B2 fill:#ffc,stroke:#333,stroke-width:2px\n    style B3 fill:#ffc,stroke:#333,stroke-width:2px\n    style C1 fill:#ffc,stroke:#333,stroke-width:2px\n    style D1 fill:#ffc,stroke:#333,stroke-width:2px\n    style D2 fill:#ffc,stroke:#333,stroke-width:2px\n    style E1 fill:#ffc,stroke:#333,stroke-width:2px\n\n    linkStyle 0 stroke:#00a,stroke-width:2px,fill:none;\n    linkStyle 1 stroke:#00a,stroke-width:2px,fill:none;\n    linkStyle 2 stroke:#00a,stroke-width:2px,fill:none;\n    linkStyle 3 stroke:#00a,stroke-width:2px,fill:none;\n    linkStyle 4 stroke:#00a,stroke-width:2px,fill:none;\n    linkStyle 5 stroke:#00a,stroke-width:2px,fill:none;\n    linkStyle 6 stroke:#00a,stroke-width:2px,fill:none;\n    linkStyle 7 stroke:#00a,stroke-width:2px,fill:none;\n    linkStyle 8 stroke:#00a,stroke-width:2px,fill:none;\n    linkStyle 9 stroke:#00a,stroke-width:2px,fill:none;\n    linkStyle 10 stroke:#00a,stroke-width:2px,fill:none;\n    linkStyle 11 stroke:#00a,stroke-width:2px,fill:none;\n    linkStyle 12 stroke:#00a,stroke-width:2px,fill:none;\n    linkStyle 13 stroke:#00a,stroke-width:2px,fill:none;\n    linkStyle 14 stroke:#00a,stroke-width:2px,fill:none;\n    linkStyle 15 stroke:#00a,stroke-width:2px,fill:none;\n    linkStyle 16 stroke:#00a,stroke-width:2px,fill:none;\n```"},"old":{"content":null,"id":null},"mode":"ai"},{"artifactType":"Automation","changeType":"create","status":"success","data":{"content":"## Automation Strategy: Storycatcher II\n\n### Automation Overview\n\nStorycatcher II prioritizes a seamless, private, and intelligent user experience. This automation strategy focuses on transforming repetitive manual tasks and reactive system responses into proactive, intelligent workflows. By leveraging existing AI capabilities and enhancing system feedback mechanisms, we aim to minimize user effort, improve data quality, and ensure strict compliance.\n\n**Summary of Automation Opportunities:**\n1.  **AI-Assisted Metadata Tagging:** Automate the suggestion/generation of story metadata.\n2.  **Automated Contextual UI Feedback:** Provide real-time, intelligent UI state updates and error handling.\n3.  **Automated GDPR Consent Flow:** Streamline and enforce explicit user consent for data sharing.\n4.  **Proactive Offline Data Synchronization:** Ensure seamless background sync of offline content.\n\n**Automation Principles and Approach:**\n*   **User-Centric:** Automate to reduce friction and enhance the user journey, particularly in story capture and management.\n*   **Privacy-First:** Ensure all automation adheres to GDPR principles, especially regarding local data handling and consent.\n*   **Intelligent Augmentation:** Leverage AI to assist users, not replace their control, by suggesting rather than imposing.\n*   **Transparency:** Keep users informed of automated processes and system states.\n*   **Efficiency:** Streamline internal processes (e.g., development environment) to improve productivity.\n\n**Expected Benefits and Impact:**\n*   **Enhanced User Experience:** Smoother interactive loops, clearer feedback, reduced manual data entry.\n*   **Improved Data Quality:** More consistent and comprehensive metadata for stories.\n*   **Guaranteed Compliance:** Automated enforcement of GDPR consent flows.\n*   **Increased Productivity:** For both users (less manual work) and developers (streamlined setup).\n*   **Reduced Errors:** Proactive error handling and validation.\n\n### Automation Opportunities\n\n**1. Opportunity ID: AUTO-001 - AI-Assisted Metadata Tagging**\n*   **Related Requirements:** 2291 (Story Metadata Tagging), 2286 (AI-Guided Interview), 2287 (Voice-to-Text Transcription).\n*   **Type:** UX Optimization / Process Automation\n*   **Current State:** Users manually apply rich metadata (geo-tagging, temporal, dialect, general tags) to stories (2291). This is a post-capture manual step.\n*   **Proposed Automation:** After voice-to-text transcription (2287) and AI analysis (2286) of an audio segment, the AI will automatically suggest relevant metadata tags (e.g., keywords, topics, inferred locations or dates mentioned, potential dialect indicators) based on the transcript. These suggestions will be presented to the user for acceptance, modification, or rejection before final story archiving.\n*   **Impact:** Reduces manual effort for users, improves metadata quality and consistency, enhances future discoverability (2291), and leverages existing AI capabilities more fully.\n\n**2. Opportunity ID: AUTO-002 - Automated Contextual UI Feedback**\n*   **Related Requirements:** 2298 (Robust Error Handling and UI Feedback), 2288 (Interactive Story Capture Loop), 2300 (Microphone Access).\n*   **Type:** UX Optimization\n*   **Current State:** UI states (idle, recording, processing, showing_analysis) must be managed (2288), and error handling (2298) is separate. This implies reactive, potentially generic feedback.\n*   **Proposed Automation:** The frontend will proactively manage and display granular UI states and contextual feedback. During processing (STT, AI analysis), a specific \"Processing audio...\" indicator with progress will be shown. For errors (e.g., microphone access denied, API call failure), the UI will automatically display specific, actionable error messages (e.g., \"Microphone access denied. Please check browser settings.\") and guide the user on next steps (2298).\n*   **Impact:** Significantly improves user experience by providing real-time status and guidance, reduces user frustration, enhances system perceived responsiveness and reliability.\n\n**3. Opportunity ID: AUTO-003 - Automated GDPR Consent Flow**\n*   **Related Requirements:** 2290 (GDPR-Compliant Data Handling and Consent), 2293 (Story Export and Sharing), 2295 (Public Story Archive).\n*   **Type:** Compliance Automation / Process Automation\n*   **Current State:** Explicit opt-in consent is required for any story export or publication (2290, 2293, 2295). This implies a manual step that could be overlooked or implemented inconsistently.\n*   **Proposed Automation:** When a user attempts to export or publicly share a story, the system will automatically present a dedicated, unskippable GDPR consent form. This form will clearly state what data is being shared and for what purpose, requiring explicit user confirmation before proceeding. Backend validation will strictly enforce this consent before processing any sharing/export requests.\n*   **Impact:** Ensures strict legal and GDPR compliance (2290), builds user trust, and standardizes the consent process, reducing potential for human error.\n\n### Implementation Analysis\n\n**1. AUTO-001 - AI-Assisted Metadata Tagging**\n*   **UI/UX Changes:** A dedicated section on the 'Story Detail / Edit Page' (2292) to display suggested tags (e.g., as interactive chips). Users can click to accept, edit, or delete. A \"Generate Tags\" button could be present for manual re-triggering.\n*   **Data Model Updates:** The `Story` entity will need new fields or a structured JSONB field to store suggested tags, potentially with a flag indicating if they are AI-generated or user-confirmed.\n*   **Technical Considerations:** Enhance the `AI-Guided Interview Logic` (2286) to include a Natural Language Processing (NLP) module for keyword extraction, entity recognition (places, dates), and sentiment analysis from the `Transcript Text` (2287). This module would output a set of proposed tags.\n*   **Integration Requirements:** The `Story Processing Service` (F) would route the `Transcript Text` to the enhanced `AI-Guided Interview Logic` (G) for tagging. The generated tags would then be passed to `Story Data Management` (I) for storage and sent to the `Client - React/JavaScript UI` (A) for display.\n\n**2. AUTO-002 - Automated Contextual UI Feedback**\n*   **UI/UX Changes:** Implementation of global loading indicators, progress bars, toast notifications for transient messages (success/warning), and modal dialogs for critical errors requiring user action. Consistent visual language for different states.\n*   **Data Model Updates:** No direct data model changes. This is primarily frontend logic.\n*   **Technical Considerations:** Frontend application (2288, 2298) will utilize a centralized state management library (e.g., Redux, Zustand) to manage application-wide UI states (e.g., `isProcessing`, `hasError`). Interceptors for API calls and event listeners for browser APIs (e.g., MediaRecorder, microphone permissions) will trigger state updates.\n*   **Integration Requirements:** Frontend `Client - React/JavaScript UI` (A) listens to responses from `Backend Services` (D, F) and `Microphone Access` (B).\n\n**3. AUTO-003 - Automated GDPR Consent Flow**\n*   **UI/UX Changes:** A new, distinct UI component (modal or dedicated page) for GDPR consent, triggered automatically upon initiation of export/public sharing. Clear headings, bullet points for data usage, and explicit \"Accept\" / \"Decline\" buttons.\n*   **Data Model Updates:** The `Story` entity (I) will require a boolean field, e.g., `is_publicly_consented: boolean`, defaulting to `false`. User profile might need a timestamp for consent agreement.\n*   **Technical Considerations:** Backend `Story Export and Sharing Capabilities` (2293) and `Public Story Archive and Viewing` (2295) logic must include a mandatory check for the `is_publicly_consented` flag. If `false`, the request is denied, and the frontend is instructed to display the consent form.\n*   **Integration Requirements:** Frontend `Client - React/JavaScript UI` (A) sends requests to `Backend` (F) for export/share. The backend responds with a specific status if consent is missing, prompting the frontend to display the consent UI.\n\n**4. AUTO-004 - Proactive Offline Data Synchronization**\n*   **UI/UX Changes:** A subtle status indicator (e.g., a small icon or text in the header/footer) showing \"Offline changes pending,\" \"Syncing data...\", or \"All changes synced.\" Potentially a brief notification upon successful sync.\n*   **Data Model Updates:** Local storage (IndexedDB 2289) needs to track \"dirty\" records (changes made offline). The backend database (K) needs robust versioning or conflict resolution mechanisms for story segments and metadata.\n*   **Technical Considerations:** Frontend `Offline-First Story Archiving` (2289) will implement a background synchronization service worker that periodically checks for network connectivity and pending local changes. Upon reconnection, it will send incremental updates to the backend. The backend `Story Data Management` (I) must expose endpoints for partial updates and handle potential conflicts.\n*   **Integration Requirements:** Frontend `Local Storage - IndexedDB` (C) communicates with `Backend Story Data Management` (I) via new API endpoints when connectivity is restored.\n\n### Prioritization & Roadmap\n\n```mermaid\ngraph TD\n    subgraph \"Impact vs Effort Matrix\"\n        P1[\"AUTO-002: Automated Contextual UI Feedback\"]:::high-impact-medium-effort;\n        P2[\"AUTO-003: Automated GDPR Consent Flow\"]:::high-impact-medium-effort;\n        P3[\"AUTO-004: Proactive Offline Data Synchronization\"]:::high-impact-high-effort;\n        P4[\"AUTO-001: AI-Assisted Metadata Tagging\"]:::high-impact-high-effort;\n    end\n\n    classDef high-impact-medium-effort fill:#fff8e1,stroke:#fbc02d,stroke-width:2px;\n    classDef high-impact-high-effort fill:#ffcdd2,stroke:#d32f2f,stroke-width:2px;\n```\n\n**Implementation Phases:**\n\n*   **Phase 1: Quick Wins & Foundational (MVP Integration)**\n    *   **Focus:** Core user experience, critical compliance, and immediate usability improvements.\n    *   **Opportunities:**\n        *   **AUTO-002: Automated Contextual UI Feedback:** Essential for a usable and reliable MVP. (High Impact, Medium Effort)\n        *   **AUTO-003: Automated GDPR Consent Flow:** Non-negotiable for GDPR compliance (2290) when implementing export/sharing (2293, 2295). (High Impact, Medium Effort)\n    *   **Dependencies:** Requires core frontend (2288, 2298) and backend API (2293, 2295) functionality in place.\n    *   **Timeline:** Concurrent with initial MVP development, integrated into relevant feature sprints.\n\n*   **Phase 2: Core Enhancements (Post-MVP)**\n    *   **Focus:** Enhancing data integrity and seamless offline experience.\n    *   **Opportunity:**\n        *   **AUTO-004: Proactive Offline Data Synchronization:** Vital for robust offline-first functionality (2289) and ensuring data consistency. (High Impact, High Effort)\n    *   **Dependencies:** Depends on stable offline archiving (2289) and personal story management (2292). Requires careful design of sync logic.\n    *   **Timeline:** Post-MVP, potentially a dedicated sprint or mini-project.\n\n*   **Phase 3: Strategic & Advanced (Future Iterations)**\n    *   **Focus:** Leveraging AI for deeper user assistance and reducing cognitive load.\n    *   **Opportunity:**\n        *   **AUTO-001: AI-Assisted Metadata Tagging:** Significantly enhances story organization and discoverability (2291). (High Impact, High Effort)\n    *   **Dependencies:** Relies on mature Voice-to-Text (2287) and AI-Guided Interview (2286) components. May require further investment in NLP capabilities.\n    *   **Timeline:** After core features are stable and user feedback on metadata entry is gathered.\n\n**Dependencies and Logical Build Order:**\n*   AUTO-002 (UI Feedback) is a cross-cutting concern and should be integrated from the start across all UI components.\n*   AUTO-003 (GDPR Consent) is triggered by export/sharing, so its implementation should align with those features.\n*   AUTO-004 (Offline Sync) builds upon the offline-first archiving foundation (2289).\n*   AUTO-001 (AI Metadata) is an enhancement that can be layered on top of existing STT and AI processing.\n\n**Timeline and Resource Considerations:**\n*   **Phase 1:** Integrated into existing development sprints. Requires strong frontend-backend collaboration.\n*   **Phase 2:** May require dedicated frontend (service worker, IndexedDB management) and backend (sync API, conflict resolution) resources.\n*   **Phase 3:** Will require specialized AI/NLP expertise for model training/tuning and integration into the existing AI pipeline. Potential for iterative improvements over time.","id":1854},"old":{"content":null,"id":null},"mode":"ai"}],"aiProjectOverview":{"projectOverview":{"projectOverview":{"overview":"Storycatcher II is a pioneering digital platform designed to revolutionize the capture, preservation, and sharing of personal narratives and oral histories. Building upon its predecessor, this iteration focuses on empowering individuals and organizations to securely document life stories, cultural heritage, and critical events through an intuitive, AI-guided experience. The projects core mission is to democratize storytelling, ensuring that diverse voices and experiences are accessible for future generations while prioritizing user privacy and data sovereignty.\n\nThe strategic importance of Storycatcher II lies in its unique blend of advanced technology and user-centric design, addressing a critical need for accessible and secure narrative archiving. At its heart, the system provides an **AI-Guided Interview Assistant** that employs the structured 5W (Who, What, When, Where, Why) questioning method, facilitating comprehensive and coherent story capture. This intelligent prompting, combined with **Local-First Voice-to-Text Transcription** using privacy-preserving engines like Whisper or Vosk, ensures that sensitive audio data is processed on the user's device, upholding **GDPR-Compliant Data Handling** as a paramount principle. This local-first approach builds immense user trust and mitigates typical cloud-based data privacy concerns, a significant differentiator.\n\nThe **Interactive Story Capture Loop** forms the frontend's cornerstone, guiding users through recording, processing, analysis display (transcript, summary), and subsequent AI-driven questions, creating a seamless and engaging experience. Users can manage their narratives offline through **Offline-First Story Archiving**, leveraging local storage for data persistence, guaranteeing uninterrupted access and capture regardless of internet connectivity. Secure **User Registration and Authentication** provides the foundation for personalized story archiving and management.\n\nBeyond capture, Storycatcher II enriches archived stories with **Story Metadata Tagging and Structuring**, enabling geo-tagging, temporal details, and custom tags for enhanced discoverability and historical context. Users retain full control over their content via the **Personal Story Management** interface, allowing them to view, edit, and review their digital legacies. The platform also features robust **Story Export and Sharing Capabilities**, enabling narratives to be disseminated in various formats like PDF, Podcast, or Timeline, catering to both private preservation and public engagement. To broaden its reach, Storycatcher II incorporates a **Multilingual User Interface (i18n)**, initially supporting German and English, making it accessible to a diverse global audience. A **Public Story Archive and Viewing** feature allows users to share consented stories, fostering cultural exchange and historical research.\n\nStorycatcher II is strategically positioned to become the go-to platform for secure and comprehensive narrative preservation. Its emphasis on user privacy, driven by local-first processing and explicit consent mechanisms, establishes a strong foundation of trust crucial for capturing sensitive personal histories. While the initial MVP focuses on local data handling, the system's architecture is designed for **Scalability for Future Cloud Deployment**, anticipating growth in user base and data volume. Future enhancements include an **Admin and Partner Portal** for institutional collaborations and content moderation, alongside **Pricing and Subscription Management** to support a sustainable business model for private archives and corporate storytelling initiatives. By empowering individuals and organizations to preserve invaluable human experiences, Storycatcher II contributes significantly to cultural heritage documentation and fosters a deeper understanding of shared histories.","summaryType":"executive","version":{"minor":0,"major":1,"patch":0},"wordCount":500,"generatedAt":"2025-07-09T07:48:04.655Z"}}},"aiModalConfig":{"primaryModelCode":"gemini-2.5-flash-preview-05-20","primaryProvider":"google","fallbackModelCode":"gpt-4o","fallbackProvider":"openai"},"aiUIPreview":[{"htmlContent":"<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n <meta charset=\"UTF-8\">\n <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n <title>Storycatcher II - Capture Your Legacy</title>\n <script src=\"https://cdn.tailwindcss.com\"></script>\n</head>\n<body class=\"min-h-screen bg-[#f0f8ff] text-[#2C3E50] font-sans flex flex-col\">\n\n <!-- Header/Navigation -->\n <header class=\"w-full py-4 px-6 md:px-12 flex justify-between items-center bg-white/50 backdrop-blur-sm shadow-md z-10\">\n <div class=\"flex items-center space-x-2\">\n <!-- Storycatcher II Logo/Icon -->\n <svg class=\"w-8 h-8 text-[#3178c6]\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5s3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18s-3.332.477-4.5 1.253\"></path>\n </svg>\n <span class=\"text-2xl font-bold text-[#2C3E50]\">Storycatcher II</span>\n </div>\n <nav class=\"space-x-4\">\n <a href=\"#\" class=\"text-[#607B8B] hover:text-[#3178c6] transition-colors duration-300\">Features</a>\n <a href=\"#\" class=\"text-[#607B8B] hover:text-[#3178c6] transition-colors duration-300\">About</a>\n <a href=\"#\" class=\"text-[#607B8B] hover:text-[#3178c6] transition-colors duration-300\">Contact</a>\n </nav>\n </header>\n\n <!-- Main Content - Hero Section -->\n <main class=\"flex-grow flex items-center justify-center py-12 px-6 md:px-12 lg:px-24\">\n <div class=\"w-full max-w-6xl bg-white/30 backdrop-blur-lg rounded-xl shadow-xl border border-white/50 p-8 md:p-12 lg:p-16 text-center\">\n <h1 class=\"text-4xl md:text-5xl lg:text-6xl font-bold text-[#2C3E50] leading-tight mb-6\">\n Capture Your Legacy.<br>Your Story, Your Privacy.\n </h1>\n <p class=\"text-lg md:text-xl text-[#607B8B] max-w-3xl mx-auto mb-10\">\n Storycatcher II empowers you to effortlessly record, transcribe, and archive your personal narratives with cutting-edge AI guidance and uncompromising privacy.\n Your memories, preserved locally, on your terms.\n </p>\n \n <div class=\"flex flex-col sm:flex-row justify-center items-center gap-6\">\n <!-- Call to Action: Register -->\n <a href=\"registration.html\" class=\"bg-gradient-to-r from-[#3178c6] to-[#2A65A4] text-white font-semibold py-3 px-8 rounded-full shadow-lg hover:from-[#2A65A4] hover:to-[#3178c6] hover:scale-105 transition-all duration-300 flex items-center justify-center group\">\n <svg class=\"w-6 h-6 mr-2 text-white group-hover:rotate-6 transition-transform\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z\"></path>\n </svg>\n Start Your Story\n </a>\n\n <!-- Call to Action: Login -->\n <a href=\"login.html\" class=\"bg-white text-[#3178c6] border border-[#3178c6] font-semibold py-3 px-8 rounded-full shadow-lg hover:bg-[#3178c6] hover:text-white hover:scale-105 transition-all duration-300 flex items-center justify-center group\">\n <svg class=\"w-6 h-6 mr-2 text-[#3178c6] group-hover:text-white\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1\"></path>\n </svg>\n Login\n </a>\n\n <!-- Call to Action: Public Archive -->\n <a href=\"public-archive.html\" class=\"bg-transparent text-[#3178c6] border border-[#3178c6] font-semibold py-3 px-8 rounded-full hover:bg-[#3178c6]/10 hover:scale-105 transition-all duration-300 flex items-center justify-center group\">\n <svg class=\"w-6 h-6 mr-2 text-[#3178c6]\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M21 12a9 9 0 11-18 0 9 9 0 0118 0z\"></path>\n <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M10 12H5M14 12h5M10 16H5M14 16h5M10 8H5M14 8h5M12 2.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5s3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18s-3.332.477-4.5 1.253\"></path>\n </svg>\n Explore Public Stories\n </a>\n </div>\n </div>\n </main>\n\n <!-- Feature Highlights Section -->\n <section class=\"w-full py-16 px-6 md:px-12 lg:px-24 bg-[#f0f8ff]\">\n <div class=\"max-w-6xl mx-auto grid grid-cols-1 md:grid-cols-3 gap-8\">\n <!-- Feature 1: Privacy First -->\n <div class=\"bg-white/50 backdrop-blur-sm rounded-xl shadow-lg p-6 flex flex-col items-center text-center hover:shadow-xl transition-all duration-300\">\n <div class=\"p-4 rounded-full bg-[#3178c6]/10 mb-4\">\n <svg class=\"w-10 h-10 text-[#3178c6]\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v3h8z\"></path>\n </svg>\n </div>\n <h3 class=\"text-xl font-semibold text-[#2C3E50] mb-3\">Privacy-First Approach</h3>\n <p class=\"text-[#607B8B]\">Your stories are stored locally on your device, ensuring complete data privacy and GDPR compliance. You control your narrative.</p>\n </div>\n\n <!-- Feature 2: AI-Guided Storytelling -->\n <div class=\"bg-white/50 backdrop-blur-sm rounded-xl shadow-lg p-6 flex flex-col items-center text-center hover:shadow-xl transition-all duration-300\">\n <div class=\"p-4 rounded-full bg-[#3178c6]/10 mb-4\">\n <svg class=\"w-10 h-10 text-[#3178c6]\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10\"></path>\n </svg>\n </div>\n <h3 class=\"text-xl font-semibold text-[#2C3E50] mb-3\">AI-Guided Storytelling</h3>\n <p class=\"text-[#607B8B]\">Our intelligent assistant uses the 5W method to prompt you with relevant questions, ensuring a rich and comprehensive narrative.</p>\n </div>\n\n <!-- Feature 3: Offline Capture & Management -->\n <div class=\"bg-white/50 backdrop-blur-sm rounded-xl shadow-lg p-6 flex flex-col items-center text-center hover:shadow-xl transition-all duration-300\">\n <div class=\"p-4 rounded-full bg-[#3178c6]/10 mb-4\">\n <svg class=\"w-10 h-10 text-[#3178c6]\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M8 9l3 3-3 3m5 0h3M5 20h14a2 2 0 002-2V6a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z\"></path>\n </svg>\n </div>\n <h3 class=\"text-xl font-semibold text-[#2C3E50] mb-3\">Seamless Offline Access</h3>\n <p class=\"text-[#607B8B]\">Capture and manage your stories anytime, anywhere, even without an internet connection. Data syncs when you're back online.</p>\n </div>\n </div>\n </section>\n\n <!-- Footer -->\n <footer class=\"w-full py-8 px-6 md:px-12 bg-[#2C3E50] text-white text-center\">\n <div class=\"max-w-6xl mx-auto flex flex-col md:flex-row justify-between items-center space-y-4 md:space-y-0\">\n <p class=\"text-sm text-[#607B8B]\">&copy; 2023 Storycatcher II. All rights reserved.</p>\n <div class=\"flex space-x-6\">\n <a href=\"#\" class=\"text-[#607B8B] hover:text-[#3178c6] transition-colors duration-300 text-sm\">Privacy Policy</a>\n <a href=\"#\" class=\"text-[#607B8B] hover:text-[#3178c6] transition-colors duration-300 text-sm\">Terms of Service</a>\n <a href=\"#\" class=\"text-[#607B8B] hover:text-[#3178c6] transition-colors duration-300 text-sm\">Support</a>\n </div>\n </div>\n </footer>\n\n</body>\n</html>","htmlVersion":"v1.0.0","pageName":"Landing Page","quality":"balanced","genTimer":"54691"},{"htmlContent":"<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n <meta charset=\"UTF-8\">\n <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n <title>My Stories - Storycatcher II</title>\n <script src=\"https://cdn.tailwindcss.com\"></script>\n <style>\n /* Custom scrollbar for better aesthetics */\n ::-webkit-scrollbar {\n width: 8px;\n height: 8px;\n }\n ::-webkit-scrollbar-track {\n background: #f1f1f1;\n border-radius: 10px;\n }\n ::-webkit-scrollbar-thumb {\n background: #888;\n border-radius: 10px;\n }\n ::-webkit-scrollbar-thumb:hover {\n background: #555;\n }\n </style>\n</head>\n<body class=\"font-sans bg-[#f8fcf8] text-gray-800 antialiased min-h-screen flex flex-col\">\n\n <!-- Top Navigation Bar -->\n <header class=\"bg-white bg-opacity-70 backdrop-blur-lg shadow-lg py-4 px-6 md:px-8 flex flex-col md:flex-row items-center justify-between sticky top-0 z-50 border-b border-gray-200\">\n <div class=\"flex items-center justify-between w-full md:w-auto mb-4 md:mb-0\">\n <a href=\"#\" class=\"flex items-center space-x-2 text-[#388e3c] font-bold text-2xl transition-all duration-300 hover:text-[#2a6d2f]\">\n <!-- Storycatcher II Logo SVG - Geometric, simple -->\n <svg class=\"w-8 h-8\" fill=\"currentColor\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n <path d=\"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-1-13h2v6h-2zm0 8h2v2h-2z\"/>\n </svg>\n <span>Storycatcher II</span>\n </a>\n <!-- Mobile Menu Toggle -->\n <button class=\"md:hidden text-gray-700 hover:text-[#388e3c] focus:outline-none focus:ring-2 focus:ring-[#388e3c]\" id=\"mobile-menu-button\">\n <svg class=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M4 6h16M4 12h16M4 18h16\"></path>\n </svg>\n </button>\n </div>\n\n <!-- Navigation Links (Hidden on mobile by default) -->\n <nav class=\"w-full md:w-auto flex-col md:flex-row md:flex items-center space-y-4 md:space-y-0 md:space-x-8 text-lg hidden\" id=\"mobile-menu\">\n <a href=\"#\" class=\"text-gray-700 hover:text-[#388e3c] font-semibold transition-colors duration-200\">My Stories</a>\n <a href=\"#\" class=\"text-gray-700 hover:text-[#388e3c] transition-colors duration-200\">Public Archive</a>\n <a href=\"#\" class=\"text-gray-700 hover:text-[#388e3c] transition-colors duration-200\">New Story</a>\n <div class=\"relative group\">\n <button class=\"flex items-center text-gray-700 hover:text-[#388e3c] transition-colors duration-200 focus:outline-none\">\n <svg class=\"w-5 h-5 mr-1\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M3 5h12M9 3v2m1.048 9.5A18.022 18.022 0 018.672 16.5c-2.192 0-4.202.946-5.832 2.5a.5.5 0 01-.176.126.5.5 0 01-.362.007L2 19.5c.012 0 .012 0 .012 0A18.022 18.022 0 005.328 16.5c2.192 0 4.202-.946 5.832-2.5a.5.5 0 01.176-.126.5.5 0 01.362-.007L12 14.5c-.012 0-.012 0-.012 0A18.022 18.022 0 018.672 11.5c-2.192 0-4.202.946-5.832-2.5\"></path>\n </svg>\n Language\n <svg class=\"w-4 h-4 ml-1\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M19 9l-7 7-7-7\"></path>\n </svg>\n </button>\n <div class=\"absolute right-0 mt-2 w-32 bg-white rounded-lg shadow-xl py-2 opacity-0 group-hover:opacity-100 group-hover:translate-y-0 translate-y-2 transition-all duration-300 pointer-events-none group-hover:pointer-events-auto\">\n <a href=\"#\" class=\"block px-4 py-2 text-gray-800 hover:bg-gray-100\">English</a>\n <a href=\"#\" class=\"block px-4 py-2 text-gray-800 hover:bg-gray-100\">Deutsch</a>\n </div>\n </div>\n <a href=\"#\" class=\"bg-gradient-to-r from-[#388e3c] to-[#2a6d2f] text-white py-2 px-6 rounded-full font-semibold shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105\">Logout</a>\n </nav>\n </header>\n\n <main class=\"flex-grow container mx-auto px-4 py-8 md:py-12\">\n <div class=\"bg-white bg-opacity-70 backdrop-blur-lg rounded-2xl shadow-xl p-6 md:p-8 border border-[#c8e6c9]\">\n <div class=\"flex flex-col md:flex-row justify-between items-center mb-8 space-y-4 md:space-y-0\">\n <h1 class=\"text-4xl font-extrabold text-gray-900 leading-tight\">My Stories</h1>\n <a href=\"#\" class=\"bg-gradient-to-r from-[#388e3c] to-[#2a6d2f] text-white py-3 px-8 rounded-full font-semibold shadow-md hover:shadow-lg transition-all duration-300 hover:scale-105 flex items-center space-x-2\">\n <svg class=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M12 6v6m0 0v6m0-6h6m-6 0H6\"></path>\n </svg>\n <span>Start New Story</span>\n </a>\n </div>\n\n <!-- Filter and Sort Options -->\n <div class=\"flex flex-col sm:flex-row justify-between items-center mb-8 gap-4\">\n <div class=\"relative w-full sm:w-auto\">\n <select class=\"block appearance-none w-full bg-white border border-gray-300 text-gray-700 py-3 px-4 pr-8 rounded-lg leading-tight focus:outline-none focus:bg-white focus:border-[#388e3c] transition-all duration-200 shadow-sm hover:shadow-md\" id=\"sort-by\">\n <option>Sort by: Most Recent</option>\n <option>Sort by: Oldest</option>\n <option>Sort by: Title (A-Z)</option>\n </select>\n <div class=\"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700\">\n <svg class=\"fill-current h-4 w-4\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\"><path d=\"M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z\"/></svg>\n </div>\n </div>\n <div class=\"relative w-full sm:w-auto\">\n <select class=\"block appearance-none w-full bg-white border border-gray-300 text-gray-700 py-3 px-4 pr-8 rounded-lg leading-tight focus:outline-none focus:bg-white focus:border-[#388e3c] transition-all duration-200 shadow-sm hover:shadow-md\" id=\"filter-by\">\n <option>Filter by: All Stories</option>\n <option>Filter by: Drafts</option>\n <option>Filter by: Published</option>\n <option>Filter by: Tags</option>\n </select>\n <div class=\"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700\">\n <svg class=\"fill-current h-4 w-4\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\"><path d=\"M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z\"/></svg>\n </div>\n </div>\n </div>\n\n <!-- Story List/Grid -->\n <div class=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n\n <!-- Story Card 1 -->\n <div class=\"story-card bg-[#c8e6c9] bg-opacity-70 backdrop-blur-md rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-[1.02] border border-[#388e3c]/30 p-6 flex flex-col justify-between\">\n <div>\n <h3 class=\"text-xl font-bold text-gray-900 mb-2\">My Childhood Memories in Berlin</h3>\n <p class=\"text-gray-700 text-sm mb-4 line-clamp-3\">A vivid recollection of growing up in post-war Berlin, exploring the vibrant neighborhoods and the resilience of its people. Captured with AI guidance on historical context.</p>\n <div class=\"flex flex-wrap gap-2 mb-4\">\n <span class=\"text-xs bg-[#388e3c]/10 text-[#388e3c] px-3 py-1 rounded-full font-semibold\">#Childhood</span>\n <span class=\"text-xs bg-[#388e3c]/10 text-[#388e3c] px-3 py-1 rounded-full font-semibold\">#Berlin</span>\n <span class=\"text-xs bg-[#388e3c]/10 text-[#388e3c] px-3 py-1 rounded-full font-semibold\">#History</span>\n </div>\n </div>\n <div class=\"flex items-center justify-between text-sm text-gray-500 mt-4\">\n <span>Archived: 2023-10-26</span>\n <div class=\"flex space-x-2\">\n <a href=\"#\" class=\"text-[#388e3c] hover:text-[#2a6d2f] transition-colors duration-200\" title=\"Edit Story\">\n <svg class=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z\"></path>\n </svg>\n </a>\n <a href=\"#\" class=\"text-[#388e3c] hover:text-[#2a6d2f] transition-colors duration-200\" title=\"Share/Export\">\n <svg class=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"1.5\" d=\"M13.5 6H5.25A2.25 2.25 0 003 8.25v10.5A2.25 2.25 0 005.25 21h10.5A2.25 2.25 0 0018 18.75V10.5m-10.5 6L21 3m0 0l-7.5 7.5M21 3v7.5\"></path>\n </svg>\n </a>\n </div>\n </div>\n </div>\n\n <!-- Story Card 2 -->\n <div class=\"story-card bg-[#c8e6c9] bg-opacity-70 backdrop-blur-md rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-[1.02] border border-[#388e3c]/30 p-6 flex flex-col justify-between\">\n <div>\n <h3 class=\"text-xl font-bold text-gray-900 mb-2\">The Old Oak Tree by the River</h3>\n <p class=\"text-gray-700 text-sm mb-4 line-clamp-3\">A heartwarming tale of a beloved oak tree, witnessing generations of family picnics and whispered secrets. A metaphor for enduring legacy and quiet strength.</p>\n <div class=\"flex flex-wrap gap-2 mb-4\">\n <span class=\"text-xs bg-[#388e3c]/10 text-[#388e3c] px-3 py-1 rounded-full font-semibold\">#Nature</span>\n <span class=\"text-xs bg-[#388e3c]/10 text-[#388e3c] px-3 py-1 rounded-full font-semibold\">#Family</span>\n <span class=\"text-xs bg-[#388e3c]/10 text-[#388e3c] px-3 py-1 rounded-full font-semibold\">#Legacy</span>\n </div>\n </div>\n <div class=\"flex items-center justify-between text-sm text-gray-500 mt-4\">\n <span>Archived: 2023-09-15</span>\n <div class=\"flex space-x-2\">\n <a href=\"#\" class=\"text-[#388e3c] hover:text-[#2a6d2f] transition-colors duration-200\" title=\"Edit Story\">\n <svg class=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z\"></path>\n </svg>\n </a>\n <a href=\"#\" class=\"text-[#388e3c] hover:text-[#2a6d2f] transition-colors duration-200\" title=\"Share/Export\">\n <svg class=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"1.5\" d=\"M13.5 6H5.25A2.25 2.25 0 003 8.25v10.5A2.25 2.25 0 005.25 21h10.5A2.25 2.25 0 0018 18.75V10.5m-10.5 6L21 3m0 0l-7.5 7.5M21 3v7.5\"></path>\n </svg>\n </a>\n </div>\n </div>\n </div>\n\n <!-- Story Card 3 -->\n <div class=\"story-card bg-[#c8e6c9] bg-opacity-70 backdrop-blur-md rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-[1.02] border border-[#388e3c]/30 p-6 flex flex-col justify-between\">\n <div>\n <h3 class=\"text-xl font-bold text-gray-900 mb-2\">Grandma's Secret Recipe</h3>\n <p class=\"text-gray-700 text-sm mb-4 line-clamp-3\">A cherished family recipe, passed down through generations, along with the stories and traditions associated with its preparation. A true taste of heritage.</p>\n <div class=\"flex flex-wrap gap-2 mb-4\">\n <span class=\"text-xs bg-[#388e3c]/10 text-[#388e3c] px-3 py-1 rounded-full font-semibold\">#FamilyRecipe</span>\n <span class=\"text-xs bg-[#388e3c]/10 text-[#388e3c] px-3 py-1 rounded-full font-semibold\">#Tradition</span>\n <span class=\"text-xs bg-[#388e3c]/10 text-[#388e3c] px-3 py-1 rounded-full font-semibold\">#Food</span>\n </div>\n </div>\n <div class=\"flex items-center justify-between text-sm text-gray-500 mt-4\">\n <span>Archived: 2023-08-01</span>\n <div class=\"flex space-x-2\">\n <a href=\"#\" class=\"text-[#388e3c] hover:text-[#2a6d2f] transition-colors duration-200\" title=\"Edit Story\">\n <svg class=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z\"></path>\n </svg>\n </a>\n <a href=\"#\" class=\"text-[#388e3c] hover:text-[#2a6d2f] transition-colors duration-200\" title=\"Share/Export\">\n <svg class=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"1.5\" d=\"M13.5 6H5.25A2.25 2.25 0 003 8.25v10.5A2.25 2.25 0 005.25 21h10.5A2.25 2.25 0 0018 18.75V10.5m-10.5 6L21 3m0 0l-7.5 7.5M21 3v7.5\"></path>\n </svg>\n </a>\n </div>\n </div>\n </div>\n\n <!-- Story Card 4 -->\n <div class=\"story-card bg-[#c8e6c9] bg-opacity-70 backdrop-blur-md rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-[1.02] border border-[#388e3c]/30 p-6 flex flex-col justify-between\">\n <div>\n <h3 class=\"text-xl font-bold text-gray-900 mb-2\">First Solo Trip: Discovering Myself</h3>\n <p class=\"text-gray-700 text-sm mb-4 line-clamp-3\">The transformative journey of a solo backpacking trip through Southeast Asia, filled with unexpected challenges, personal growth, and breathtaking landscapes.</p>\n <div class=\"flex flex-wrap gap-2 mb-4\">\n <span class=\"text-xs bg-[#388e3c]/10 text-[#388e3c] px-3 py-1 rounded-full font-semibold\">#Travel</span>\n <span class=\"text-xs bg-[#388e3c]/10 text-[#388e3c] px-3 py-1 rounded-full font-semibold\">#Adventure</span>\n <span class=\"text-xs bg-[#388e3c]/10 text-[#388e3c] px-3 py-1 rounded-full font-semibold\">#SelfDiscovery</span>\n </div>\n </div>\n <div class=\"flex items-center justify-between text-sm text-gray-500 mt-4\">\n <span>Archived: 2023-07-05</span>\n <div class=\"flex space-x-2\">\n <a href=\"#\" class=\"text-[#388e3c] hover:text-[#2a6d2f] transition-colors duration-200\" title=\"Edit Story\">\n <svg class=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z\"></path>\n </svg>\n </a>\n <a href=\"#\" class=\"text-[#388e3c] hover:text-[#2a6d2f] transition-colors duration-200\" title=\"Share/Export\">\n <svg class=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"1.5\" d=\"M13.5 6H5.25A2.25 2.25 0 003 8.25v10.5A2.25 2.25 0 005.25 21h10.5A2.25 2.25 0 0018 18.75V10.5m-10.5 6L21 3m0 0l-7.5 7.5M21 3v7.5\"></path>\n </svg>\n </a>\n </div>\n </div>\n </div>\n\n <!-- Placeholder for no stories -->\n <div class=\"md:col-span-2 lg:col-span-3 text-center py-12 text-gray-500\" id=\"no-stories-placeholder\" style=\"display: none;\">\n <svg class=\"mx-auto w-16 h-16 text-gray-400 mb-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"1.5\" d=\"M9 13h6m-3-3v6m-9 1V7a2 2 0 012-2h6l2 2h6a2 2 0 012 2v8a2 2 0 01-2 2H5a2 2 0 01-2-2z\"></path>\n </svg>\n <p class=\"text-xl font-semibold mb-2\">No stories yet!</p>\n <p class=\"text-md\">Start capturing your memories by clicking the \"Start New Story\" button above.</p>\n </div>\n\n </div>\n </div>\n </main>\n\n <footer class=\"bg-gray-100 bg-opacity-70 backdrop-blur-lg mt-8 py-6 text-center text-gray-600 border-t border-gray-200\">\n <p>&copy; 2023 Storycatcher II. All rights reserved. <span class=\"ml-2\">Privacy Policy</span></p>\n </footer>\n\n <script>\n // Mobile menu toggle logic\n document.getElementById('mobile-menu-button').addEventListener('click', function() {\n const mobileMenu = document.getElementById('mobile-menu');\n mobileMenu.classList.toggle('hidden');\n mobileMenu.classList.toggle('flex');\n });\n\n // Example: Show/hide no stories placeholder if no story cards are present\n const storyCardsContainer = document.querySelector('.grid.gap-6');\n const storyCards = storyCardsContainer ? storyCardsContainer.querySelectorAll('.story-card') : [];\n const noStoriesPlaceholder = document.getElementById('no-stories-placeholder');\n\n if (storyCards.length === 0) {\n noStoriesPlaceholder.style.display = 'block';\n } else {\n noStoriesPlaceholder.style.display = 'none';\n }\n </script>\n</body>\n</html>","htmlVersion":"v1.0.0","pageName":"My Stories Page","quality":"balanced","genTimer":"106157"},{"htmlContent":"<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n <meta charset=\"UTF-8\">\n <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n <title>Story Capture - Storycatcher II</title>\n <script src=\"https://cdn.tailwindcss.com\"></script>\n <style>\n /* Custom scrollbar for better aesthetics */\n .custom-scrollbar::-webkit-scrollbar {\n width: 8px;\n }\n .custom-scrollbar::-webkit-scrollbar-track {\n background: #f8e8d8; /* Slightly darker than main bg for track */\n border-radius: 10px;\n }\n .custom-scrollbar::-webkit-scrollbar-thumb {\n background: #e65100; /* Accent color for thumb */\n border-radius: 10px;\n }\n .custom-scrollbar::-webkit-scrollbar-thumb:hover {\n background: #d84300; /* Darker accent on hover */\n }\n </style>\n</head>\n<body class=\"font-sans antialiased text-gray-800 bg-[#fff3e0] min-h-screen flex flex-col\">\n\n <!-- Navigation Header -->\n <header class=\"w-full bg-[#f8e8d8] shadow-md py-4 px-6 md:px-8 flex items-center justify-between\">\n <a href=\"#\" class=\"flex items-center text-gray-800 hover:text-[#e65100] transition-all duration-300\">\n <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" class=\"w-6 h-6 mr-2\">\n <path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18\" />\n </svg>\n <span class=\"font-semibold text-lg\">My Stories</span>\n </a>\n <h1 class=\"text-2xl md:text-3xl font-bold text-[#e65100]\">Storycatcher II</h1>\n <div class=\"w-12\"></div> <!-- Spacer to balance flex -->\n </header>\n\n <!-- Main Content Area -->\n <main class=\"flex-1 container mx-auto p-4 md:p-8 lg:p-10 flex flex-col items-center justify-center\">\n\n <div class=\"w-full max-w-5xl grid grid-cols-1 md:grid-cols-2 gap-6 mb-8\">\n\n <!-- Recording Controls Card -->\n <div class=\"bg-white/30 backdrop-blur-lg rounded-xl p-6 shadow-xl border border-white border-opacity-40 flex flex-col items-center justify-between text-center transition-all duration-300 hover:shadow-2xl\">\n <h2 class=\"text-xl md:text-2xl font-semibold mb-4 text-[#e65100]\">Story Capture</h2>\n \n <!-- Microphone Status -->\n <div class=\"flex items-center space-x-3 mb-6\">\n <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"currentColor\" class=\"w-8 h-8 text-green-500 animate-pulse\">\n <path d=\"M12 2A4 4 0 008 6v4a4 4 0 008 0V6a4 4 0 00-4-4z\" />\n <path fill-rule=\"evenodd\" d=\"M7 11.5a.5.5 0 01.5-.5h9a.5.5 0 01.5.5v.5a.5.5 0 01-.5.5h-9a.5.5 0 01-.5-.5v-.5zM12 18a6 6 0 006-6v-1a.5.5 0 011 0v1a7 7 0 01-14 0v-1a.5.5 0 011 0v1a6 6 0 006 6z\" clip-rule=\"evenodd\" />\n <path d=\"M12 18.5a.5.5 0 01.5.5v.5a.5.5 0 01-.5.5h-1a.5.5 0 01-.5-.5v-.5a.5.5 0 01.5-.5h1z\" />\n </svg>\n <span class=\"text-lg font-medium text-gray-700\">Recording...</span>\n </div>\n\n <!-- Recording Duration -->\n <p class=\"text-4xl md:text-5xl font-bold text-gray-900 mb-8\">00:01:45</p>\n\n <!-- Recording Controls -->\n <div class=\"flex space-x-6\">\n <button class=\"p-4 rounded-full bg-gray-200 text-gray-700 hover:bg-gray-300 transition-all duration-300 shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-[#e65100]\">\n <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"currentColor\" viewBox=\"0 0 24 24\" stroke-width=\"1.5\" stroke=\"currentColor\" class=\"w-8 h-8\">\n <path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M15.75 5.25v13.5m-7.5-13.5v13.5\" />\n </svg>\n </button>\n <button class=\"p-4 rounded-full bg-[#e65100] text-white hover:bg-[#d84300] transition-all duration-300 shadow-xl hover:shadow-2xl focus:outline-none focus:ring-2 focus:ring-[#e65100]\">\n <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"currentColor\" viewBox=\"0 0 24 24\" stroke-width=\"1.5\" stroke=\"currentColor\" class=\"w-8 h-8\">\n <path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M5.25 7.5A2.25 2.25 0 017.5 5.25h9A2.25 2.25 0 0118.75 7.5v9a2.25 2.25 0 01-2.25 2.25h-9A2.25 2.25 0 015.25 16.5v-9z\" />\n </svg>\n </button>\n </div>\n </div>\n\n <!-- AI-Guided Question Card -->\n <div class=\"bg-white/30 backdrop-blur-lg rounded-xl p-6 shadow-xl border border-white border-opacity-40 flex flex-col justify-between transition-all duration-300 hover:shadow-2xl\">\n <h2 class=\"text-xl md:text-2xl font-semibold mb-4 text-[#e65100]\">AI Assistant</h2>\n <div class=\"flex-1 flex flex-col justify-center items-center text-center\">\n <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" stroke-width=\"1.5\" stroke=\"currentColor\" class=\"w-16 h-16 text-gray-500 mb-4\">\n <path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M12 18v-5.25m0 0a6.01 6.01 0 001.5-1.052c1.331-.269 2.671-.53 4-1.248m-4 1.248a6.01 6.01 0 01-1.5-1.052c-1.331-.269-2.671-.53-4-1.248m0 0hd2.25m2.25 0h-2.25M6 12.75V12A6 6 0 0112 6V4m-.75 2.25L7.5 10.5m0 0l3.625-1.353M12 18.75V19a2.25 2.25 0 002.25 2.25h.25A2.25 2.25 0 0017 19v-.25m-4.5-5.625h2.25H12Z\" />\n </svg>\n <p class=\"text-lg md:text-xl font-medium text-gray-700 leading-relaxed\">\n \"Can you tell me more about the people involved in this memory? Who was there, and what roles did they play?\"\n </p>\n </div>\n <div class=\"mt-6 text-sm text-gray-500\">\n Next question in 5 seconds...\n </div>\n </div>\n\n </div>\n\n <div class=\"w-full max-w-5xl grid grid-cols-1 lg:grid-cols-3 gap-6\">\n\n <!-- Real-time Transcript Card -->\n <div class=\"lg:col-span-2 bg-white/30 backdrop-blur-lg rounded-xl p-6 shadow-xl border border-white border-opacity-40 flex flex-col transition-all duration-300 hover:shadow-2xl\">\n <h2 class=\"text-xl md:text-2xl font-semibold mb-4 text-[#e65100]\">Real-time Transcript</h2>\n <div class=\"flex-1 overflow-y-auto h-64 md:h-80 lg:h-96 custom-scrollbar pr-2\">\n <p class=\"text-gray-700 text-base leading-relaxed\">\n <span class=\"font-semibold text-gray-900\">User:</span> It was a warm summer evening, just like this one, back in '98. The air was thick with the smell of jasmine and freshly cut grass. My grandmother was sitting on the porch swing, humming an old folk song. My grandfather was tending to his rose bushes, meticulously trimming each stem. I remember feeling so peaceful, just watching them. It felt like time stood still, a perfect moment captured forever.\n <br><br>\n <span class=\"font-semibold text-gray-900\">AI:</span> Can you tell me more about the people involved in this memory? Who was there, and what roles did they play?\n <br><br>\n <span class=\"font-semibold text-gray-900\">User:</span> Yes, my grandmother, Elara, was the heart of our home. She always had a story to tell, a song to sing, and a warm hug ready. My grandfather, Arthur, was more reserved, but his love was evident in the way he cared for his garden, which was truly his pride and joy. He taught me the importance of patience and nurturing. And then there was my dog, Buster, a scruffy terrier mix who would always nap at my feet, a silent guardian of our family moments.\n <br><br>\n <span class=\"font-semibold text-gray-900\">AI:</span> What was the significance of the rose bushes to your grandfather? Did they hold any special meaning or stories?\n <br><br>\n <span class=\"font-semibold text-gray-900\">User:</span> The rose bushes were more than just plants to him. Each one had a name, a story. The deep red one, he called 'Memory Lane,' because it reminded him of his courtship with my grandmother. The vibrant yellow one was 'Sunshine,' named after my mother's bright disposition. He believed that tending to them was like tending to our family's history, always growing, always beautiful, but requiring constant care. He'd tell us stories of where he got each rose, the special occasions they marked, and the lessons he learned from their cycles of bloom and dormancy.\n <br><br>\n <span class=\"font-semibold text-gray-900\">AI:</span> How did these moments on the porch shape your understanding of family and tradition?\n </p>\n </div>\n </div>\n\n <!-- Segment Summary Card -->\n <div class=\"bg-white/30 backdrop-blur-lg rounded-xl p-6 shadow-xl border border-white border-opacity-40 flex flex-col transition-all duration-300 hover:shadow-2xl\">\n <h2 class=\"text-xl md:text-2xl font-semibold mb-4 text-[#e65100]\">Current Segment Summary</h2>\n <div class=\"flex-1 overflow-y-auto custom-scrollbar pr-2\">\n <p class=\"text-gray-700 text-base leading-relaxed\">\n The user describes the significance of their grandfather's rose bushes, each named after a family memory or person. 'Memory Lane' (red) symbolizes his courtship, and 'Sunshine' (yellow) represents his daughter. He viewed tending the roses as nurturing family history, sharing stories of their origins and the life lessons derived from their growth cycles.\n </p>\n </div>\n </div>\n\n </div>\n\n </main>\n\n <!-- Footer with Finalize Button -->\n <footer class=\"w-full bg-[#f8e8d8] shadow-md py-4 px-6 md:px-8 flex justify-center\">\n <button class=\"px-8 py-3 bg-[#e65100] text-white font-semibold rounded-full shadow-lg hover:bg-[#d84300] transition-all duration-300 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-[#e65100] focus:ring-offset-2\">\n <div class=\"flex items-center space-x-2\">\n <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" class=\"w-6 h-6\">\n <path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M9 12.75L11.25 15L15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" />\n </svg>\n <span>Finalize Story & Archive</span>\n </div>\n </button>\n </footer>\n\n</body>\n</html>","htmlVersion":"v1.0.0","pageName":"Story Capture Page","quality":"balanced","genTimer":"30406"}]}